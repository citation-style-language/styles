<?xml version="1.0" encoding="utf-8"?>
<style xmlns="http://purl.org/net/xbiblio/csl" and="text" class="note" demote-non-dropping-particle="display-and-sort" names-delimiter=", " page-range-format="chicago" version="1.0">
  <info>
    <title>Chicago Manual of Style 18th edition (shortened author-title notes and bibliography, with classic variants, without URLs)</title>
    <title-short>CMOS</title-short>
    <id>http://www.zotero.org/styles/chicago-short-notes-bibliography-classic-no-url</id>
    <link href="http://www.zotero.org/styles/chicago-short-notes-bibliography-classic-no-url" rel="self"/>
    <link href="http://www.zotero.org/styles/chicago-notes-bibliography" rel="template"/>
    <link href="http://www.chicagomanualofstyle.org/tools_citationguide.html" rel="documentation"/>
    <author>
      <name>Andrew Dunning</name>
      <uri>https://orcid.org/0000-0003-0464-5036</uri>
    </author>
    <category citation-format="note"/>
    <category field="generic-base"/>
    <category field="history"/>
    <category field="humanities"/>
    <category field="law"/>
    <category field="literature"/>
    <category field="philosophy"/>
    <category field="theology"/>
    <summary>Chicago-style source citations, shortened author-title notes and bibliography system, with classic variants: chapter page numbers (CMOS 14.8), place of publication (CMOS 14.30), and 3-em dash (CMOS 13.113), without URLs (CMOS 13.6)</summary>
    <updated>2025-05-19T00:00:00+00:00</updated>
    <rights license="http://creativecommons.org/licenses/by-sa/3.0/">This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 License</rights>
  </info>
  <locale xml:lang="en">
    <terms>
      <term name="anonymous">unsigned</term>
      <term form="verb-short" name="collection-editor">ed.</term>
      <term form="short" name="collection-number">vol.</term>
      <term form="verb-short" name="compiler">comp.</term>
      <term form="verb-short" name="contributor">with</term>
      <term form="verb-short" name="director">dir.</term>
      <term form="verb-short" name="editor">ed.</term>
      <term form="short" name="editor-translator">ed. and trans.</term>
      <term form="verb" name="editor-translator">edited and translated by</term>
      <term form="verb-short" name="editor-translator">ed. and trans.</term>
      <term form="verb" name="editortranslator">edited and translated by</term>
      <term form="verb-short" name="editortranslator">ed. and trans.</term>
      <term form="verb" name="editorial-director">editorial direction by</term>
      <term form="verb-short" name="editorial-director">ed. dir.</term>
      <term form="verb-short" name="illustrator">ill.</term>
      <term form="short" name="legislation">Pub. L.</term>
      <term name="original-work-published">originally published</term>
      <term form="short" name="paper-conference">paper</term>
      <term form="short" name="personal-communication">pers. comm.</term>
      <term name="podcast-episode">episode</term>
      <term name="sub-verbo">under</term>
      <term form="short" name="sub-verbo">under</term>
      <term form="short" name="translator">trans.</term>
      <term form="verb-short" name="translator">trans.</term>
    </terms>
  </locale>
  <!-- Contents:
    
       This file interprets Chicago using APA's four basic reference elements
       (cf. CMOS 14.2, 14.64, 14.161):

        1. Author (CMOS 13.74–86)
        2. Date (author-date system only, CMOS 13.102)
        3. Title and descriptions (CMOS 13.87–101)
            3.1. Title
            3.2. Description
            3.3. Identifiers (edition, contributors, volume)
        4. Source
            4.1. Serial sources
            4.2. Monographic sources
            4.3. Series
            4.4. Event
            4.5. Publisher
            4.6. Date
            4.7. Locators (including page references)
            4.8. Medium
            4.9. Archival location
            4.10. URL or persistent identifier
      
       Freeform annotations to bibliography entries: 
        
        5. Notes
       
       Chicago also provides parallel rules for legal references following
       The Bluebook: A Uniform System of Citation (code shared with APA):

        6. Legal references
            6.1. Legal author
            6.2. Legal date
            6.3. Legal title
            6.4. Legal source
  -->
  <!-- In this file, macros suffixed `-bib` and `-note` are parallel versions
       of the same features for the bibliography and notes, and all changes
       must be applied to both. They should only contain differences of
       punctuation (periods in bibliography, commas in notes) and capitalization,
       except where the comments indicate structural changes. -->
  <!-- Categories of CSL item types:

       Serial
       : article-journal article-magazine article-newspaper periodical post-weblog review review-book

       Serial or Monographic
       : interview paper-conference

         Monographic with any of `collection-editor compiler editor editorial-director`.
         A serial `paper-conference` is unpublished if it lacks any of `issue page volume`.

       Monographic
       : article book broadcast chapter classic collection dataset document
         entry entry-dictionary entry-encyclopedia event figure
         graphic manuscript map motion_picture musical_score
         pamphlet patent performance personal_communication post report
         software song speech standard thesis webpage

       Legal
       : bill hearing legal_case legislation regulation treaty
  -->
  <!-- Variable labels -->
  <macro name="label-chapter-number-capitalized">
    <group delimiter=" ">
      <choose>
        <if is-numeric="chapter-number">
          <choose>
            <if type="song">
              <text text-case="capitalize-first" value="track"/>
            </if>
            <else>
              <label form="short" text-case="capitalize-first" variable="chapter-number"/>
            </else>
          </choose>
        </if>
      </choose>
      <text text-case="capitalize-first" variable="chapter-number"/>
    </group>
  </macro>
  <macro name="label-collection-number">
    <group delimiter=" ">
      <choose>
        <if is-numeric="collection-number">
          <label form="short" variable="collection-number"/>
        </if>
      </choose>
      <text variable="collection-number"/>
    </group>
  </macro>
  <macro name="label-edition">
    <choose>
      <if is-numeric="edition">
        <group delimiter=" ">
          <number form="ordinal" variable="edition"/>
          <label form="short" variable="edition"/>
        </group>
      </if>
      <else>
        <group delimiter=" ">
          <text variable="edition"/>
          <choose>
            <if match="any" type="article-journal article-magazine article-newspaper periodical post-weblog review review-book">
              <!-- full label for serial edition (CMOS 14.89) -->
              <label variable="edition"/>
            </if>
          </choose>
        </group>
      </else>
    </choose>
  </macro>
  <macro name="label-edition-capitalized">
    <choose>
      <if is-numeric="edition">
        <group delimiter=" ">
          <number form="ordinal" variable="edition"/>
          <label form="short" variable="edition"/>
        </group>
      </if>
      <else>
        <group delimiter=" ">
          <text text-case="title" variable="edition"/>
          <choose>
            <if match="any" type="article-journal article-magazine article-newspaper periodical post-weblog review review-book">
              <!-- full label for serial edition (CMOS 14.89) -->
              <label text-case="capitalize-first" variable="edition"/>
            </if>
          </choose>
        </group>
      </else>
    </choose>
  </macro>
  <macro name="label-issue">
    <group delimiter=" ">
      <label form="short" variable="issue"/>
      <text variable="issue"/>
    </group>
  </macro>
  <macro name="label-locator">
    <group delimiter=" ">
      <choose>
        <if locator="page" match="none">
          <label form="short" variable="locator"/>
        </if>
      </choose>
      <text variable="locator"/>
    </group>
  </macro>
  <macro name="label-number">
    <group delimiter=" ">
      <choose>
        <if is-numeric="number" match="any" type="legislation regulation">
          <label form="short" variable="number"/>
        </if>
      </choose>
      <text variable="number"/>
    </group>
  </macro>
  <macro name="label-number-capitalized">
    <group delimiter=" ">
      <choose>
        <if is-numeric="number" match="any" type="legislation regulation">
          <label form="short" text-case="capitalize-first" variable="number"/>
        </if>
      </choose>
      <text text-case="capitalize-first" variable="number"/>
    </group>
  </macro>
  <macro name="label-number-of-volumes">
    <group delimiter=" ">
      <text variable="number-of-volumes"/>
      <choose>
        <if is-numeric="number-of-volumes">
          <label form="short" variable="number-of-volumes"/>
        </if>
      </choose>
    </group>
  </macro>
  <macro name="label-part-number">
    <group delimiter=" ">
      <choose>
        <if is-numeric="part-number">
          <!-- TODO: Replace with `part-number` label when CSL provides one -->
          <text form="short" term="part"/>
        </if>
      </choose>
      <text variable="part-number"/>
    </group>
  </macro>
  <macro name="label-part-number-capitalized">
    <group delimiter=" ">
      <choose>
        <if is-numeric="part-number">
          <!-- TODO: Replace with `part-number` label when CSL provides one -->
          <text form="short" term="part" text-case="capitalize-first"/>
        </if>
      </choose>
      <text text-case="capitalize-first" variable="part-number"/>
    </group>
  </macro>
  <macro name="label-section">
    <group delimiter=" ">
      <choose>
        <if is-numeric="section">
          <label variable="section"/>
        </if>
      </choose>
      <text text-case="title" variable="section"/>
    </group>
  </macro>
  <macro name="label-section-capitalized">
    <group delimiter=" ">
      <choose>
        <if is-numeric="section">
          <label text-case="capitalize-first" variable="section"/>
        </if>
      </choose>
      <text text-case="title" variable="section"/>
    </group>
  </macro>
  <macro name="label-section-symbol">
    <group delimiter=" ">
      <label form="symbol" variable="section"/>
      <text variable="section"/>
    </group>
  </macro>
  <macro name="label-supplement-number">
    <group delimiter=" ">
      <choose>
        <if is-numeric="supplement-number">
          <!-- TODO: Replace with `supplement-number` label when CSL provides one -->
          <text form="short" term="supplement"/>
        </if>
      </choose>
      <text variable="supplement-number"/>
    </group>
  </macro>
  <macro name="label-version">
    <group delimiter=" ">
      <choose>
        <if type="software">
          <!-- short version label software (CMOS 14.169) -->
          <label form="short" text-case="capitalize-first" variable="version"/>
        </if>
        <else>
          <label text-case="capitalize-first" variable="version"/>
        </else>
      </choose>
      <text variable="version"/>
    </group>
  </macro>
  <macro name="label-version-capitalized">
    <group delimiter=" ">
      <choose>
        <if type="software">
          <!-- short version label software (CMOS 14.169) -->
          <label form="short" text-case="capitalize-first" variable="version"/>
        </if>
        <else>
          <label text-case="capitalize-first" variable="version"/>
        </else>
      </choose>
      <text variable="version"/>
    </group>
  </macro>
  <macro name="label-volume">
    <group delimiter=" ">
      <choose>
        <if is-numeric="volume">
          <label form="short" variable="volume"/>
        </if>
      </choose>
      <text variable="volume"/>
    </group>
  </macro>
  <macro name="label-volume-capitalized">
    <group delimiter=" ">
      <choose>
        <if is-numeric="volume">
          <label form="short" text-case="capitalize-first" variable="volume"/>
        </if>
      </choose>
      <text text-case="capitalize-first" variable="volume"/>
    </group>
  </macro>
  <!-- 1. Author (CMOS 13.74–86) -->
  <macro name="author-bib">
    <names variable="composer">
      <name delimiter-precedes-last="always" name-as-sort-order="first"/>
      <label form="short" prefix=", "/>
      <substitute>
        <names variable="author"/>
        <choose>
          <if type="classic">
            <!-- contributors fall after the title of `classic` (CMOS 14.147) -->
            <text macro="author-title-substitute-bib"/>
          </if>
          <else-if match="any" type="entry entry-dictionary entry-encyclopedia">
            <!-- contributors fall after the title of reference entries (CMOS 14.130) -->
            <text macro="author-title-substitute-container"/>
          </else-if>
        </choose>
        <names variable="illustrator"/>
        <!-- cf. `interview` model (CMOS 14.110); use `contributor` if `host` should be prioritized -->
        <names variable="guest"/>
        <names variable="host"/>
        <names variable="director"/>
        <choose>
          <!-- serial `broadcast` prioritizes title (CMOS 14.165, 14.168) -->
          <if type="broadcast" variable="container-title number title"/>
          <else>
            <names variable="producer"/>
            <names variable="executive-producer"/>
            <names variable="series-creator"/>
            <choose>
              <if type="broadcast">
                <names variable="contributor"/>
              </if>
            </choose>
          </else>
        </choose>
        <names variable="editor-translator"/>
        <names variable="editor"/>
        <names variable="translator"/>
        <names variable="editorial-director"/>
        <names variable="compiler"/>
        <choose>
          <if match="any" type="event performance speech">
            <names variable="chair"/>
            <names variable="organizer"/>
          </if>
        </choose>
        <names variable="curator"/>
        <names variable="collection-editor"/>
        <choose>
          <if type="software">
            <!-- `software` listed under the name of the publisher or developer (CMOS 14.169) -->
            <text variable="publisher"/>
          </if>
        </choose>
        <text macro="author-title-substitute-container"/>
        <text macro="author-title-substitute-bib"/>
      </substitute>
    </names>
  </macro>
  <macro name="author-short">
    <choose>
      <if match="any" type="bill hearing legal_case legislation regulation treaty">
        <text macro="title-and-descriptions-short"/>
      </if>
      <else-if match="any" type="interview personal_communication">
        <text macro="author-short-and-recipient"/>
      </else-if>
      <else>
        <text macro="author-substitute-short"/>
      </else>
    </choose>
  </macro>
  <macro name="author-sort">
    <choose>
      <if match="any" type="bill hearing legal_case legislation regulation treaty">
        <text macro="legal-title"/>
      </if>
      <else>
        <text macro="author-bib"/>
      </else>
    </choose>
  </macro>
  <!-- Author elements -->
  <macro name="author-short-and-recipient">
    <group delimiter=" ">
      <choose>
        <!-- Inaccessible personal commmunication is cited in-text (CMOS 14.111) -->
        <if match="none" variable="archive archive-place container-title DOI number publisher references URL">
          <!-- These variables indicate whether the letter is retrievable by the reader -->
          <group delimiter=", ">
            <names variable="author">
              <substitute>
                <text macro="title-and-descriptions-short"/>
              </substitute>
            </names>
            <text macro="description-format-short"/>
          </group>
          <names variable="recipient">
            <label form="verb-short" suffix=" "/>
            <name/>
          </names>
        </if>
        <else-if variable="author recipient">
          <names variable="author">
            <label/>
            <name form="short"/>
          </names>
          <names variable="recipient">
            <label form="verb" suffix=" "/>
            <name form="short"/>
          </names>
        </else-if>
        <else>
          <names variable="author">
            <name form="short"/>
            <substitute>
              <text macro="title-and-descriptions-short"/>
            </substitute>
          </names>
        </else>
      </choose>
    </group>
  </macro>
  <macro name="author-substitute-short">
    <names variable="composer">
      <name form="short"/>
      <!-- for author-date:
      <name form="short" initialize-with=". "/> -->
      <substitute>
        <names variable="author"/>
        <choose>
          <if type="classic">
            <!-- contributors fall after the title of `classic` (CMOS 14.147) -->
            <text macro="author-title-substitute-note"/>
          </if>
          <else-if match="any" type="entry entry-dictionary entry-encyclopedia">
            <!-- contributors fall after the title of reference entries (CMOS 14.130) -->
            <text macro="author-title-substitute-container"/>
          </else-if>
        </choose>
        <names variable="illustrator"/>
        <names variable="guest host"/>
        <choose>
          <if type="broadcast" variable="container-title number title"/>
          <else>
            <names variable="director"/>
            <names variable="producer"/>
            <names variable="executive-producer"/>
            <names variable="series-creator"/>
            <choose>
              <if type="broadcast">
                <names variable="contributor"/>
              </if>
            </choose>
          </else>
        </choose>
        <names variable="editor-translator"/>
        <names variable="editor"/>
        <names variable="translator"/>
        <names variable="editorial-director"/>
        <names variable="compiler"/>
        <choose>
          <if match="any" type="event performance speech">
            <names variable="chair"/>
            <names variable="organizer"/>
          </if>
        </choose>
        <names variable="curator"/>
        <names variable="collection-editor"/>
        <choose>
          <if type="software">
            <!-- `software` listed under the name of the publisher or developer (CMOS 14.169) -->
            <text variable="publisher"/>
          </if>
        </choose>
        <text macro="author-title-substitute-container-short"/>
        <text macro="title-and-descriptions-short"/>
      </substitute>
    </names>
  </macro>
  <macro name="author-title-substitute-bib">
    <choose>
      <if match="any" type="review review-book" variable="reviewed-author reviewed-genre reviewed-title">
        <!-- If a review has no `reviewed-genre` or `reviewed-title`, assume that `title` contains the title of the reviewed work; the description provides it. -->
        <choose>
          <if variable="reviewed-genre title">
            <text macro="title-bib"/>
          </if>
          <else-if variable="reviewed-title title">
            <text macro="title-bib"/>
          </else-if>
          <else>
            <text macro="title-and-descriptions-bib"/>
          </else>
        </choose>
      </if>
      <else-if variable="title">
        <text macro="title-bib"/>
      </else-if>
      <else>
        <!-- If an item has no `title`, substitute with descriptions. -->
        <text macro="title-and-descriptions-bib"/>
      </else>
    </choose>
  </macro>
  <macro name="author-title-substitute-note">
    <choose>
      <if match="any" type="review review-book" variable="reviewed-author reviewed-genre reviewed-title">
        <!-- If a review has no `reviewed-genre` or `reviewed-title`, assume that `title` contains the title of the reviewed work; the description provides it. -->
        <choose>
          <if variable="reviewed-genre title">
            <text macro="title-note"/>
          </if>
          <else-if variable="reviewed-title title">
            <text macro="title-note"/>
          </else-if>
          <else>
            <text macro="title-and-descriptions-note"/>
          </else>
        </choose>
      </if>
      <else-if variable="title">
        <text macro="title-note"/>
      </else-if>
      <else>
        <!-- If an item has no `title`, substitute with descriptions and capitalize -->
        <text macro="title-and-descriptions-bib"/>
      </else>
    </choose>
  </macro>
  <macro name="author-title-substitute-container">
    <choose>
      <if variable="container-title">
        <choose>
          <if match="any" type="article-journal article-magazine article-newspaper periodical post-weblog review review-book">
            <!-- Anonymous serials substitute name of publication (CMOS 14.87, 14.97, 14.102) -->
            <text macro="source-serial-name"/>
          </if>
          <else-if match="any" type="entry entry-dictionary entry-encyclopedia">
            <!-- Anonymous entries in reference works (CMOS 14.130) -->
            <text font-style="italic" text-case="title" variable="container-title"/>
          </else-if>
          <else-if type="broadcast">
            <!-- TV broadcasts and podcasts (CMOS 14.165, 14.168) -->
            <text font-style="italic" text-case="title" variable="container-title"/>
          </else-if>
          <else-if type="webpage">
            <!-- Website title substituted in bibliography only (CMOS 14.104) -->
            <text text-case="title" variable="container-title"/>
          </else-if>
        </choose>
      </if>
    </choose>
  </macro>
  <macro name="author-title-substitute-container-short">
    <choose>
      <if variable="container-title">
        <choose>
          <if match="any" type="article-journal article-magazine article-newspaper periodical post-weblog review review-book">
            <!-- Anonymous works in serials substitute name of publication (CMOS 14.87, 14.97, 14.102) -->
            <text font-style="italic" form="short" text-case="title" variable="container-title"/>
          </if>
          <else-if match="any" type="entry entry-dictionary entry-encyclopedia">
            <!-- Anonymous entries in reference works (CMOS 14.130) -->
            <text font-style="italic" form="short" text-case="title" variable="container-title"/>
          </else-if>
          <else-if type="broadcast">
            <!-- TV broadcasts and podcasts (CMOS 14.165, 14.168) -->
            <text font-style="italic" form="short" text-case="title" variable="container-title"/>
          </else-if>
          <else-if type="webpage">
            <!-- Website title substituted in bibliography only (CMOS 14.104) -->
            <text form="short" text-case="title" variable="container-title"/>
          </else-if>
        </choose>
      </if>
    </choose>
  </macro>
  <!-- 2. Date (CMOS 13.102) -->
  <macro name="date-sort">
    <!-- Sort items by issue date as printed by `source-date` macro -->
    <choose>
      <if type="interview personal_communication" variable="event-date issued">
        <date date-parts="year" form="numeric" variable="event-date"/>
      </if>
      <else-if match="any" type="article-journal article-magazine article-newspaper periodical post-weblog review review-book">
        <choose>
          <if match="any" variable="issue volume">
            <text macro="date-issued-leading-zeros-year-month"/>
          </if>
          <else>
            <text macro="date-issued-leading-zeros-full"/>
          </else>
        </choose>
      </else-if>
      <else-if match="any" type="interview paper-conference">
        <choose>
          <if match="none" variable="collection-editor compiler editor editorial-director issue page volume">
            <!-- `paper-conference` in proceedings -->
            <text macro="date-issued-leading-zeros-full"/>
          </if>
          <else>
            <date date-parts="year" form="numeric" variable="issued"/>
          </else>
        </choose>
      </else-if>
      <else-if match="any" type="entry entry-dictionary entry-encyclopedia">
        <choose>
          <if match="any" variable="DOI URL">
            <text macro="date-issued-leading-zeros-full"/>
          </if>
          <else>
            <date date-parts="year" form="numeric" variable="issued"/>
          </else>
        </choose>
      </else-if>
      <else-if match="any" type="article broadcast collection dataset document event graphic interview manuscript map patent performance personal_communication post software song speech standard webpage">
        <text macro="date-issued-leading-zeros-full"/>
      </else-if>
      <else>
        <date date-parts="year" form="numeric" variable="issued"/>
      </else>
    </choose>
  </macro>
  <macro name="date-sort-group">
    <!-- Sort items with and without dates (CMOS 14.44):

          1. items with dates (= 0)
          2. `no date` items (= 1)
          3. items with `status` (forthcoming, in press, etc.) (= 2) -->
    <choose>
      <if variable="issued">
        <text value="0"/>
      </if>
      <else-if variable="status">
        <text value="2"/>
      </else-if>
      <else>
        <!-- n.d. -->
        <text value="1"/>
      </else>
    </choose>
  </macro>
  <!-- Date elements -->
  <macro name="date-issued-full">
    <choose>
      <if is-uncertain-date="issued">
        <!-- guessed-at date (CMOS 14.44) -->
        <date form="text" prefix="[" suffix="?]" variable="issued"/>
      </if>
      <else>
        <date form="text" variable="issued"/>
      </else>
    </choose>
  </macro>
  <macro name="date-issued-leading-zeros-full">
    <date delimiter="-" variable="issued">
      <date-part name="year"/>
      <date-part form="numeric-leading-zeros" name="month"/>
      <date-part form="numeric-leading-zeros" name="day"/>
    </date>
  </macro>
  <macro name="date-issued-leading-zeros-year-month">
    <date delimiter="-" variable="issued">
      <date-part name="year"/>
      <date-part form="numeric-leading-zeros" name="month"/>
    </date>
  </macro>
  <macro name="date-issued-year">
    <choose>
      <if is-uncertain-date="issued">
        <!-- guessed-at date (CMOS 14.44) -->
        <date date-parts="year" form="text" prefix="[" suffix="?]" variable="issued"/>
      </if>
      <else>
        <date date-parts="year" form="text" variable="issued"/>
      </else>
    </choose>
  </macro>
  <macro name="date-original-year">
    <choose>
      <if is-uncertain-date="original-date">
        <date date-parts="year" form="numeric" prefix="[" suffix="?]" variable="original-date"/>
      </if>
      <else>
        <date date-parts="year" form="numeric" variable="original-date"/>
      </else>
    </choose>
  </macro>
  <!-- 3. Title and descriptions (CMOS 13.87–101) -->
  <macro name="title-and-descriptions-bib">
    <group delimiter=". ">
      <choose>
        <if variable="title">
          <text macro="title-bib"/>
          <text macro="description-bib"/>
          <text macro="identifier-bib"/>
        </if>
        <else>
          <choose>
            <if match="any" type="bill report">
              <!-- Bills, resolutions, and congressional reports substitute bill number if no title -->
              <!-- Congressional reports are indistinguishable from other reports -->
              <text macro="identifier-number-bib"/>
              <text macro="identifier-bib"/>
              <text macro="description-bib"/>
            </if>
            <else>
              <text macro="description-bib"/>
              <text macro="identifier-bib"/>
            </else>
          </choose>
        </else>
      </choose>
    </group>
  </macro>
  <macro name="title-and-descriptions-note">
    <group delimiter=", ">
      <choose>
        <if variable="title">
          <text macro="title-note"/>
          <text macro="description-note"/>
          <text macro="identifier-note"/>
        </if>
        <else>
          <choose>
            <if match="any" type="bill report">
              <!-- Bills, resolutions, and congressional reports substitute bill number if no title -->
              <!-- Congressional reports are indistinguishable from other reports -->
              <text macro="identifier-number-note"/>
              <text macro="identifier-note"/>
              <text macro="description-note"/>
            </if>
            <else>
              <text macro="description-note"/>
              <text macro="identifier-note"/>
            </else>
          </choose>
        </else>
      </choose>
    </group>
  </macro>
  <macro name="title-and-descriptions-short">
    <choose>
      <if variable="title">
        <text macro="title-short"/>
      </if>
      <else-if match="any" type="bill report">
        <!-- Bills, resolutions, and congressional reports substitute bill number if no title -->
        <text macro="legal-identifier-bill-report"/>
      </else-if>
      <else>
        <text macro="description-short"/>
      </else>
    </choose>
  </macro>
  <macro name="title-and-source-bib">
    <group delimiter=". ">
      <choose>
        <if type="broadcast" variable="container-title number title">
          <!-- Bespoke `broadcast` format (CMOS 14.165, 14.168) -->
          <text macro="source-monographic-title"/>
          <group delimiter=", ">
            <text macro="identifier-number-bib"/>
            <text macro="title-bib"/>
            <text macro="description-bib"/>
            <text macro="source-monographic-identifier-contributors-bib"/>
          </group>
          <text macro="source-series"/>
          <text macro="source-event-bib"/>
        </if>
        <else-if match="none" variable="title">
          <choose>
            <if type="chapter" variable="container-title genre">
              <!-- 'Introduction to' etc. (CMOS 14.12) -->
              <group delimiter=" ">
                <text macro="title-and-descriptions-bib"/>
                <text macro="source-bib"/>
              </group>
            </if>
            <else>
              <text macro="title-and-descriptions-bib"/>
              <text macro="source-bib"/>
            </else>
          </choose>
        </else-if>
        <else>
          <text macro="title-and-descriptions-bib"/>
          <text macro="source-bib"/>
        </else>
      </choose>
      <text macro="source-monographic-publication-bib"/>
      <text macro="source-locator"/>
      <choose>
        <if match="none" type="map">
          <text macro="source-medium-bib"/>
        </if>
      </choose>
      <text macro="source-archive-bib"/>
      <!-- <text macro="source-DOI-URL-bib"/> -->
    </group>
  </macro>
  <!-- 3.1. Title -->
  <macro name="title-bib">
    <choose>
      <if match="any" type="post webpage">
        <!-- Handle `container-title` on `post` or `webpage` in manner of `publisher` -->
        <text macro="title-and-part-filter-review-bib"/>
      </if>
      <else-if match="any" type="article-journal article-magazine article-newspaper periodical post-weblog review review-book">
        <text macro="title-serial-bib"/>
      </else-if>
      <else-if match="any" type="interview paper-conference">
        <!-- Treat as monographic with an editor, otherwise as serial -->
        <choose>
          <if match="any" variable="collection-editor compiler editor editorial-director">
            <text macro="title-monographic"/>
          </if>
          <else>
            <text macro="title-serial-bib"/>
          </else>
        </choose>
      </else-if>
      <else>
        <text macro="title-monographic"/>
      </else>
    </choose>
  </macro>
  <macro name="title-note">
    <choose>
      <if match="any" type="post webpage">
        <!-- Handle `container-title` on `post` or `webpage` in manner of `publisher` -->
        <text macro="title-and-part-filter-review-note"/>
      </if>
      <else-if match="any" type="article-journal article-magazine article-newspaper periodical post-weblog review review-book">
        <text macro="title-serial-note"/>
      </else-if>
      <else-if match="any" type="interview paper-conference">
        <!-- Treat as monographic with an editor, otherwise as serial -->
        <choose>
          <if match="any" variable="collection-editor compiler editor editorial-director">
            <text macro="title-monographic"/>
          </if>
          <else>
            <text macro="title-serial-note"/>
          </else>
        </choose>
      </else-if>
      <else>
        <text macro="title-monographic"/>
      </else>
    </choose>
  </macro>
  <macro name="title-short">
    <choose>
      <if match="any" type="review review-book" variable="reviewed-author reviewed-genre reviewed-title">
        <!-- If a review has no `reviewed-title`, assume that `title` contains the title of the reviewed work; the description provides it. -->
        <choose>
          <if variable="reviewed-genre title">
            <!-- Quotes, title case -->
            <text form="short" quotes="true" text-case="title" variable="title"/>
          </if>
          <else-if variable="reviewed-title title">
            <!-- Quotes, title case -->
            <text form="short" quotes="true" text-case="title" variable="title"/>
          </else-if>
          <else>
            <text macro="description-short"/>
          </else>
        </choose>
      </if>
      <else>
        <text macro="title-primary-short"/>
      </else>
    </choose>
  </macro>
  <!-- Title elements -->
  <macro name="title-and-part-filter-review-bib">
    <choose>
      <if match="any" type="review review-book" variable="reviewed-author reviewed-genre reviewed-title">
        <!-- If a review has no `reviewed-genre` or `reviewed-title`, assume that `title` contains the title of the reviewed work; the description provides it. -->
        <choose>
          <if match="none" variable="reviewed-genre reviewed-title"/>
          <else>
            <text macro="title-and-part-title-bib"/>
          </else>
        </choose>
      </if>
      <else>
        <text macro="title-and-part-title-bib"/>
      </else>
    </choose>
  </macro>
  <macro name="title-and-part-filter-review-note">
    <choose>
      <if match="any" type="review review-book" variable="reviewed-author reviewed-genre reviewed-title">
        <!-- If a review has no `reviewed-genre` or `reviewed-title`, assume that `title` contains the title of the reviewed work; the description provides it. -->
        <choose>
          <if match="none" variable="reviewed-genre reviewed-title"/>
          <else>
            <text macro="title-and-part-title-note"/>
          </else>
        </choose>
      </if>
      <else>
        <text macro="title-and-part-title-note"/>
      </else>
    </choose>
  </macro>
  <macro name="title-and-part-title-bib">
    <group delimiter=". ">
      <text macro="title-primary"/>
      <text macro="title-part-bib"/>
    </group>
  </macro>
  <macro name="title-and-part-title-note">
    <group delimiter=", ">
      <text macro="title-primary"/>
      <text macro="title-part-note"/>
    </group>
  </macro>
  <macro name="title-monographic">
    <!-- For monographic items, assume `part-number` and `part-title` refer to the book/volume. -->
    <choose>
      <if variable="container-title">
        <text macro="title-primary"/>
      </if>
      <!-- For monographic items without `container-title`, bibliography entries list `part-title` or `volume-title` first if available -->
      <else-if variable="part-title">
        <text font-style="italic" text-case="title" variable="part-title"/>
      </else-if>
      <else-if variable="volume-title">
        <text font-style="italic" text-case="title" variable="volume-title"/>
      </else-if>
      <else>
        <text macro="title-primary"/>
      </else>
    </choose>
  </macro>
  <macro name="title-part-bib">
    <group delimiter=", ">
      <text macro="label-part-number-capitalized"/>
      <choose>
        <if match="any" type="article-journal article-magazine article-newspaper periodical post-weblog review review-book">
          <text quotes="true" text-case="title" variable="part-title"/>
        </if>
        <else>
          <text font-style="italic" text-case="title" variable="part-title"/>
        </else>
      </choose>
    </group>
  </macro>
  <macro name="title-part-note">
    <group delimiter=", ">
      <text macro="label-part-number"/>
      <choose>
        <if match="any" type="article-journal article-magazine article-newspaper periodical post-weblog review review-book">
          <text quotes="true" text-case="title" variable="part-title"/>
        </if>
        <else>
          <text font-style="italic" text-case="title" variable="part-title"/>
        </else>
      </choose>
    </group>
  </macro>
  <macro name="title-serial-bib">
    <!-- For serials, assume that `part-number` and `part-title` refer to the article and append to `title` -->
    <choose>
      <if variable="container-title">
        <text macro="title-and-part-filter-review-bib"/>
      </if>
      <else>
        <!-- for serial items without `container-title`, don't append `volume-title` to `title` -->
        <text macro="title-and-part-filter-review-bib"/>
      </else>
    </choose>
  </macro>
  <macro name="title-serial-note">
    <!-- For serials, assume that `part-number` and `part-title` refer to the article and append to `title` -->
    <choose>
      <if variable="container-title">
        <text macro="title-and-part-filter-review-note"/>
      </if>
      <else>
        <!-- for serial items without `container-title`, don't append `volume-title` to `title` -->
        <text macro="title-and-part-filter-review-note"/>
      </else>
    </choose>
  </macro>
  <macro name="title-primary">
    <choose>
      <if type="document patent">
        <!-- No italics or quotes, sentence case -->
        <text text-case="capitalize-first" variable="title"/>
      </if>
      <else-if match="any" type="bill collection legislation regulation treaty">
        <!-- No italics or quotes, title case -->
        <text text-case="title" variable="title"/>
      </else-if>
      <else-if type="legal_case">
        <!-- Italicized, sentence case -->
        <text font-style="italic" variable="title"/>
      </else-if>
      <else-if match="any" type="book classic graphic hearing map">
        <!-- Italicized, title case (regardless of `container-title`) -->
        <text font-style="italic" text-case="title" variable="title"/>
      </else-if>
      <else-if type="entry-dictionary post">
        <!-- Quotes, sentence case -->
        <text quotes="true" variable="title"/>
      </else-if>
      <!-- Other types are formatted based on presence of `container-title` -->
      <else-if variable="container-title">
        <!-- Quotes, title case -->
        <text quotes="true" text-case="title" variable="title"/>
      </else-if>
      <else-if match="any" type="article dataset interview manuscript paper-conference speech thesis webpage">
        <!-- Container-like but not necessarily with `container-title` -->
        <!-- Quotes, title case -->
        <text quotes="true" text-case="title" variable="title"/>
      </else-if>
      <else>
        <!-- Italicized, title case (default) -->
        <text font-style="italic" text-case="title" variable="title"/>
      </else>
    </choose>
  </macro>
  <macro name="title-primary-short">
    <choose>
      <if type="dataset document patent">
        <!-- No italics or quotes, sentence case -->
        <text form="short" variable="title"/>
      </if>
      <else-if match="any" type="bill collection legislation regulation treaty">
        <!-- No italics or quotes, title case -->
        <text form="short" text-case="title" variable="title"/>
      </else-if>
      <else-if type="legal_case">
        <!-- Italicized, sentence case -->
        <text font-style="italic" form="short" variable="title"/>
      </else-if>
      <else-if match="any" type="book classic graphic hearing map">
        <!-- Italicized, title case (regardless of `container-title`) -->
        <text font-style="italic" form="short" text-case="title" variable="title"/>
      </else-if>
      <else-if type="entry-dictionary post">
        <!-- Quotes, sentence case -->
        <text form="short" quotes="true" variable="title"/>
      </else-if>
      <!-- Other types are formatted based on presence of `container-title` -->
      <else-if variable="container-title">
        <!-- Quotes, title case -->
        <text form="short" quotes="true" text-case="title" variable="title"/>
      </else-if>
      <else-if match="any" type="article dataset interview manuscript paper-conference speech thesis webpage">
        <!-- Container-like but not necessarily with `container-title` -->
        <!-- Quotes, title case -->
        <text form="short" quotes="true" text-case="title" variable="title"/>
      </else-if>
      <else>
        <!-- Italicized, title case (default) -->
        <text font-style="italic" form="short" text-case="title" variable="title"/>
      </else>
    </choose>
  </macro>
  <!-- 3.2. Description -->
  <macro name="description-bib">
    <choose>
      <if match="any" type="interview" variable="interviewer">
        <text macro="description-interview-bib"/>
      </if>
      <else-if match="any" type="review review-book" variable="reviewed-author reviewed-genre reviewed-title">
        <text macro="description-review-bib"/>
      </else-if>
      <else-if type="personal_communication">
        <text macro="description-letter-bib"/>
      </else-if>
      <else-if match="any" type="article-journal article-magazine article-newspaper periodical post-weblog review review-book">
        <text macro="description-serial-bib"/>
      </else-if>
      <else-if type="map">
        <text macro="description-map-bib"/>
      </else-if>
      <else-if type="song" variable="composer">
        <text macro="description-song-bib"/>
      </else-if>
      <else-if type="thesis"/>
      <else-if match="none" variable="container-title">
        <!-- Other description -->
        <text macro="description-format-bib"/>
      </else-if>
      <else-if match="none" type="article-journal article-magazine article-newspaper periodical post-weblog review review-book">
        <text macro="description-generic-bib"/>
      </else-if>
    </choose>
  </macro>
  <macro name="description-note">
    <choose>
      <if match="any" type="interview" variable="interviewer">
        <text macro="description-interview-note"/>
      </if>
      <else-if match="any" type="review review-book" variable="reviewed-author reviewed-genre reviewed-title">
        <text macro="description-review-note"/>
      </else-if>
      <else-if type="personal_communication">
        <text macro="description-letter-note"/>
      </else-if>
      <else-if match="any" type="article-journal article-magazine article-newspaper periodical post-weblog review review-book">
        <text macro="description-serial-note"/>
      </else-if>
      <else-if type="map">
        <text macro="description-map-note"/>
      </else-if>
      <else-if type="song" variable="composer">
        <text macro="description-song-note"/>
      </else-if>
      <else-if type="thesis"/>
      <else-if match="none" variable="container-title">
        <!-- Other description -->
        <text macro="description-format-note"/>
      </else-if>
      <else-if match="none" type="article-journal article-magazine article-newspaper periodical post-weblog review review-book">
        <text macro="description-generic-note"/>
      </else-if>
    </choose>
  </macro>
  <macro name="description-short">
    <choose>
      <if match="any" type="interview" variable="interviewer">
        <text macro="description-interview-short"/>
      </if>
      <else-if match="any" type="review review-book" variable="reviewed-author reviewed-genre reviewed-title">
        <text macro="description-review-short"/>
      </else-if>
      <else-if type="personal_communication">
        <text macro="description-letter-short"/>
      </else-if>
      <else-if match="any" type="article-journal article-magazine article-newspaper periodical post-weblog review review-book">
        <text macro="description-serial-short"/>
      </else-if>
      <else>
        <text macro="description-format-short"/>
      </else>
    </choose>
  </macro>
  <!-- Description elements -->
  <macro name="description-format-bib">
    <choose>
      <if match="none" variable="number">
        <text text-case="capitalize-first" variable="genre"/>
      </if>
    </choose>
  </macro>
  <macro name="description-format-note">
    <choose>
      <if match="none" variable="number">
        <text variable="genre"/>
      </if>
    </choose>
  </macro>
  <macro name="description-format-short">
    <choose>
      <if variable="genre">
        <text variable="genre"/>
      </if>
      <else-if variable="medium">
        <text variable="medium"/>
      </else-if>
    </choose>
  </macro>
  <macro name="description-generic-bib">
    <!-- For conference presentations/performances/events, chapters in reports/standards/generic documents, software, place description within the source element -->
    <choose>
      <if match="any" type="event paper-conference performance speech">
        <choose>
          <if match="any" variable="collection-editor compiler editor editorial-director issue page volume">
            <text macro="description-format-bib"/>
          </if>
        </choose>
      </if>
      <else-if match="none" type="document report software standard">
        <text macro="description-format-bib"/>
      </else-if>
    </choose>
  </macro>
  <macro name="description-generic-note">
    <!-- For conference presentations/performances/events, chapters in reports/standards/generic documents, software, place description within the source element -->
    <choose>
      <if match="any" type="event paper-conference performance speech">
        <choose>
          <if match="any" variable="collection-editor compiler editor editorial-director issue page volume">
            <text macro="description-format-note"/>
          </if>
        </choose>
      </if>
      <else-if match="none" type="document report software standard">
        <text macro="description-format-note"/>
      </else-if>
    </choose>
  </macro>
  <macro name="description-map-bib">
    <group delimiter=", ">
      <choose>
        <if variable="genre">
          <text macro="description-format-bib"/>
          <text variable="medium"/>
        </if>
        <else>
          <text text-case="capitalize-first" variable="medium"/>
        </else>
      </choose>
      <text variable="scale"/>
      <text variable="dimensions"/>
    </group>
  </macro>
  <macro name="description-map-note">
    <group delimiter=", ">
      <choose>
        <if variable="genre">
          <text macro="description-format-note"/>
          <text variable="medium"/>
        </if>
        <else>
          <text variable="medium"/>
        </else>
      </choose>
      <text variable="scale"/>
      <text variable="dimensions"/>
    </group>
  </macro>
  <macro name="description-interview-bib">
    <group delimiter=", ">
      <choose>
        <if variable="title">
          <text macro="description-format-bib"/>
        </if>
        <else-if variable="genre">
          <group delimiter=" ">
            <text text-case="capitalize-first" variable="genre"/>
            <group delimiter=" ">
              <text form="verb" term="container-author"/>
              <names variable="interviewer"/>
            </group>
          </group>
        </else-if>
        <else-if variable="interviewer">
          <names variable="interviewer">
            <label form="verb" suffix=" " text-case="capitalize-first"/>
            <name/>
          </names>
        </else-if>
        <else>
          <text macro="description-format-bib"/>
        </else>
      </choose>
      <choose>
        <if match="none" variable="event event-title">
          <date form="text" variable="event-date"/>
          <text variable="event-place"/>
        </if>
      </choose>
    </group>
  </macro>
  <macro name="description-interview-note">
    <group delimiter=", ">
      <choose>
        <if variable="title">
          <text macro="description-format-note"/>
        </if>
        <else-if variable="genre">
          <group delimiter=" ">
            <text variable="genre"/>
            <group delimiter=" ">
              <text form="verb" term="container-author"/>
              <names variable="interviewer"/>
            </group>
          </group>
        </else-if>
        <else-if variable="interviewer">
          <names variable="interviewer">
            <label form="verb" suffix=" "/>
            <name/>
          </names>
        </else-if>
        <else>
          <text macro="description-format-note"/>
        </else>
      </choose>
      <choose>
        <if match="none" variable="event event-title">
          <date form="text" variable="event-date"/>
          <text variable="event-place"/>
        </if>
      </choose>
    </group>
  </macro>
  <macro name="description-interview-short">
    <names variable="interviewer">
      <label form="verb" suffix=" " text-case="capitalize-first"/>
      <name/>
      <substitute>
        <text macro="description-format-short"/>
      </substitute>
    </names>
  </macro>
  <macro name="description-letter-bib">
    <choose>
      <if variable="recipient">
        <group delimiter=", ">
          <group delimiter=" ">
            <choose>
              <if variable="genre">
                <text macro="description-format-bib"/>
                <names variable="recipient">
                  <label form="verb" suffix=" "/>
                  <name/>
                </names>
              </if>
              <else>
                <names variable="recipient">
                  <label form="verb" suffix=" " text-case="capitalize-first"/>
                  <name/>
                </names>
              </else>
            </choose>
          </group>
          <text variable="event-place"/>
          <date form="text" variable="event-date"/>
        </group>
      </if>
      <else>
        <choose>
          <if variable="genre">
            <text macro="description-format-bib"/>
          </if>
          <else>
            <choose>
              <if match="none" variable="archive archive-place container-title DOI number publisher references URL">
                <text term="personal-communication" text-case="capitalize-first"/>
              </if>
            </choose>
          </else>
        </choose>
      </else>
    </choose>
  </macro>
  <macro name="description-letter-note">
    <choose>
      <if variable="recipient">
        <group delimiter=", ">
          <group delimiter=" ">
            <choose>
              <if variable="genre">
                <text macro="description-format-note"/>
                <names variable="recipient">
                  <label form="verb" suffix=" "/>
                  <name/>
                </names>
              </if>
              <else>
                <names variable="recipient">
                  <label form="verb-short" suffix=" "/>
                  <name/>
                </names>
              </else>
            </choose>
          </group>
          <text variable="event-place"/>
          <date form="text" variable="event-date"/>
        </group>
      </if>
      <else>
        <choose>
          <if variable="genre">
            <text macro="description-format-note"/>
          </if>
          <else>
            <choose>
              <if match="none" variable="archive archive-place container-title DOI number publisher references URL">
                <text term="personal-communication"/>
              </if>
            </choose>
          </else>
        </choose>
      </else>
    </choose>
  </macro>
  <macro name="description-letter-short">
    <choose>
      <if variable="recipient">
        <group delimiter=" ">
          <text macro="description-format-short"/>
          <names variable="recipient">
            <label form="verb" suffix=" "/>
            <name/>
          </names>
        </group>
      </if>
      <else>
        <choose>
          <if match="any" variable="genre medium">
            <text macro="description-format-short"/>
          </if>
          <else>
            <choose>
              <if match="none" variable="archive archive-place container-title DOI number publisher references URL">
                <text form="short" term="personal-communication"/>
              </if>
            </choose>
          </else>
        </choose>
      </else>
    </choose>
  </macro>
  <macro name="description-serial-bib">
    <group delimiter=". ">
      <!-- `section` provides magazine departments (CMOS 14.88) and newspaper column names (CMOS 14.93) -->
      <text macro="label-section-capitalized"/>
      <choose>
        <if match="none" type="periodical" variable="volume-title">
          <text macro="description-format-bib"/>
        </if>
      </choose>
    </group>
  </macro>
  <macro name="description-serial-note">
    <group delimiter=", ">
      <!-- `section` provides magazine departments (CMOS 14.88) and newspaper column names (CMOS 14.93) -->
      <text macro="label-section"/>
      <choose>
        <if match="none" type="periodical" variable="volume-title">
          <text macro="description-format-note"/>
        </if>
      </choose>
    </group>
  </macro>
  <macro name="description-serial-short">
    <choose>
      <if match="none" variable="title">
        <text variable="section"/>
      </if>
    </choose>
  </macro>
  <macro name="description-review-bib">
    <!-- Reviewed item -->
    <group delimiter=". ">
      <group delimiter=", ">
        <group delimiter=" ">
          <text macro="description-review-genre-bib"/>
          <text macro="description-review-title"/>
        </group>
        <choose>
          <if variable="reviewed-title title">
            <names variable="reviewed-author">
              <label form="verb" suffix=" "/>
              <name/>
            </names>
          </if>
          <else-if match="none" variable="reviewed-genre">
            <names variable="reviewed-author">
              <label form="verb" suffix=" "/>
              <name/>
            </names>
          </else-if>
        </choose>
        <choose>
          <!-- TODO: simplify this when Zotero stops double-mapping `event-place` -->
          <if match="none" variable="event event-title">
            <text variable="event-place"/>
            <date form="text" variable="event-date"/>
          </if>
          <else>
            <text macro="source-event-bib"/>
          </else>
        </choose>
      </group>
      <text macro="label-section-capitalized"/>
    </group>
  </macro>
  <macro name="description-review-note">
    <!-- Reviewed item -->
    <group delimiter=". ">
      <group delimiter=", ">
        <group delimiter=" ">
          <text macro="description-review-genre-note"/>
          <text macro="description-review-title"/>
        </group>
        <choose>
          <if variable="reviewed-title title">
            <names variable="reviewed-author">
              <label form="verb-short" suffix=" "/>
              <name/>
            </names>
          </if>
          <else-if match="none" variable="reviewed-genre">
            <names variable="reviewed-author">
              <label form="verb-short" suffix=" "/>
              <name/>
            </names>
          </else-if>
        </choose>
        <choose>
          <!-- TODO: simplify this when Zotero stops double-mapping `event-place` -->
          <if match="none" variable="event event-title">
            <text variable="event-place"/>
            <date form="text" variable="event-date"/>
          </if>
          <else>
            <text macro="source-event-note"/>
          </else>
        </choose>
      </group>
      <text macro="label-section"/>
    </group>
  </macro>
  <macro name="description-review-genre-bib">
    <choose>
      <if variable="reviewed-genre">
        <group delimiter=" ">
          <text macro="description-review-term-unsigned-bib"/>
          <text variable="reviewed-genre"/>
          <choose>
            <if match="none" variable="reviewed-title">
              <names variable="reviewed-author">
                <label form="verb" suffix=" "/>
                <name/>
              </names>
            </if>
          </choose>
        </group>
      </if>
      <else-if match="none" variable="number">
        <!-- If no `reviewed-genre`, assume that `genre` is entered as 'Review of the book' or similar -->
        <choose>
          <if variable="genre">
            <text text-case="capitalize-first" variable="genre"/>
          </if>
          <else>
            <text macro="description-review-term-unsigned-bib"/>
          </else>
        </choose>
      </else-if>
      <else>
        <text macro="description-review-term-unsigned-bib"/>
      </else>
    </choose>
  </macro>
  <macro name="description-review-genre-note">
    <choose>
      <if variable="reviewed-genre">
        <group delimiter=" ">
          <text macro="description-review-term-unsigned-note"/>
          <text variable="reviewed-genre"/>
          <choose>
            <if match="none" variable="reviewed-title">
              <names variable="reviewed-author">
                <label form="verb-short" suffix=" "/>
                <name/>
              </names>
            </if>
          </choose>
        </group>
      </if>
      <else-if match="none" variable="number">
        <!-- If no `reviewed-genre`, assume that `genre` is entered as 'Review of the book' or similar -->
        <choose>
          <if variable="genre">
            <text variable="genre"/>
          </if>
          <else>
            <text macro="description-review-term-unsigned-note"/>
          </else>
        </choose>
      </else-if>
      <else>
        <text macro="description-review-term-unsigned-note"/>
      </else>
    </choose>
  </macro>
  <macro name="description-review-short">
    <group delimiter=" ">
      <text term="review-of" text-case="capitalize-first"/>
      <text macro="description-review-title-short"/>
    </group>
  </macro>
  <macro name="description-review-term-unsigned-bib">
    <!-- Anonymous reviews appear as 'unsigned' (CMOS 14.102) -->
    <choose>
      <if match="none" variable="author chair collection-editor compiler composer curator director editor editor-translator editorial-director executive-producer guest host illustrator organizer producer series-creator translator">
        <group delimiter=" ">
          <text term="anonymous" text-case="capitalize-first"/>
          <text term="review-of"/>
        </group>
      </if>
      <else>
        <text term="review-of" text-case="capitalize-first"/>
      </else>
    </choose>
  </macro>
  <macro name="description-review-term-unsigned-note">
    <!-- Anonymous reviews appear as 'unsigned' (CMOS 14.102) -->
    <choose>
      <if match="none" variable="author chair collection-editor compiler composer curator director editor editor-translator editorial-director executive-producer guest host illustrator organizer producer series-creator translator">
        <group delimiter=" ">
          <text term="anonymous"/>
          <text term="review-of"/>
        </group>
      </if>
      <else>
        <text term="review-of"/>
      </else>
    </choose>
  </macro>
  <macro name="description-review-title">
    <choose>
      <if match="any" variable="reviewed-genre reviewed-title">
        <!-- Not possible to distinguish TV series episode from other reviewed works without a reviewed source title -->
        <!-- Adapt for `reviewed-container-title` or similar if it becomes available -->
        <text font-style="italic" text-case="title" variable="reviewed-title"/>
      </if>
      <else>
        <!-- Assume title is title of reviewed work -->
        <text font-style="italic" text-case="title" variable="title"/>
      </else>
    </choose>
  </macro>
  <macro name="description-review-title-short">
    <choose>
      <if match="any" variable="reviewed-genre reviewed-title">
        <!-- Not possible to distinguish TV series episode from other reviewed works without a reviewed source title -->
        <!-- Adapt for `reviewed-container-title` or similar if it becomes available -->
        <text font-style="italic" form="short" text-case="title" variable="reviewed-title"/>
      </if>
      <else>
        <!-- Assume title is title of reviewed work -->
        <text font-style="italic" form="short" text-case="title" variable="title"/>
      </else>
    </choose>
  </macro>
  <macro name="description-song-bib">
    <!-- Performer of classical music works -->
    <group delimiter=" ">
      <!-- Based on `description-format` macro -->
      <choose>
        <if variable="genre">
          <text text-case="capitalize-first" variable="genre"/>
          <text form="verb" term="performer"/>
        </if>
        <else>
          <text form="verb" term="performer" text-case="capitalize-first"/>
        </else>
      </choose>
      <names variable="author">
        <substitute>
          <names variable="performer"/>
        </substitute>
      </names>
    </group>
  </macro>
  <macro name="description-song-note">
    <!-- Performer of classical music works -->
    <group delimiter=" ">
      <!-- Based on `description-format` macro -->
      <choose>
        <if variable="genre">
          <text variable="genre"/>
          <text form="verb" term="performer"/>
        </if>
        <else>
          <text form="verb" term="performer"/>
        </else>
      </choose>
      <names variable="author">
        <substitute>
          <names variable="performer"/>
        </substitute>
      </names>
    </group>
  </macro>
  <!-- 3.3. Identifier (edition, contributors, volume) -->
  <macro name="identifier-bib">
    <group delimiter=". ">
      <choose>
        <if type="patent">
          <text macro="identifier-patent"/>
        </if>
        <else-if type="report">
          <text macro="identifier-report-bib"/>
        </else-if>
        <else-if match="any" type="post webpage">
          <!-- Handle `container-title` on `post` or `webpage` as `publisher` -->
          <text macro="identifier-number-bib"/>
          <text macro="label-version-capitalized"/>
          <choose>
            <if match="none" variable="original-date">
              <text macro="label-edition-capitalized"/>
            </if>
          </choose>
          <text macro="identifier-contributors-bib"/>
          <text macro="identifier-volume-monographic-bib"/>
        </else-if>
        <else-if variable="container-title">
          <choose>
            <if match="any" type="broadcast graphic map motion_picture">
              <!-- For audiovisual media, number information comes after `title`, not `container-title`; `song` places album catalogue `number` with `publisher` (CMOS 14.163-164) -->
              <text macro="identifier-number-bib"/>
            </if>
          </choose>
          <text macro="identifier-contributors-bib"/>
        </else-if>
        <else>
          <choose>
            <if match="none" type="song">
              <text macro="identifier-number-bib"/>
            </if>
          </choose>
          <text macro="label-version-capitalized"/>
          <choose>
            <if match="none" variable="original-date">
              <text macro="label-edition-capitalized"/>
            </if>
          </choose>
          <choose>
            <if variable="collection-editor">
              <choose>
                <if match="none" variable="collection-title container-title part-title volume-title">
                  <names variable="collection-editor">
                    <label form="verb" suffix=" " text-case="capitalize-first"/>
                    <name/>
                  </names>
                </if>
                <else>
                  <text macro="identifier-contributors-bib"/>
                </else>
              </choose>
            </if>
            <else>
              <text macro="identifier-contributors-bib"/>
            </else>
          </choose>
          <text macro="identifier-volume-monographic-bib"/>
          <choose>
            <if variable="collection-editor">
              <choose>
                <if match="none" variable="collection-title container-title part-title volume-title">
                  <text macro="identifier-contributors-bib"/>
                </if>
              </choose>
            </if>
          </choose>
        </else>
      </choose>
    </group>
  </macro>
  <macro name="identifier-note">
    <group delimiter=", ">
      <choose>
        <if type="patent">
          <text macro="identifier-patent"/>
        </if>
        <else-if type="report">
          <text macro="identifier-report-note"/>
        </else-if>
        <else-if match="any" type="post webpage">
          <!-- Handle `container-title` on `post` or `webpage` as `publisher` -->
          <text macro="identifier-number-note"/>
          <text macro="label-version"/>
          <choose>
            <if match="none" variable="original-date">
              <text macro="label-edition"/>
            </if>
          </choose>
          <text macro="identifier-contributors-note"/>
          <text macro="identifier-volume-monographic-note"/>
        </else-if>
        <else-if variable="container-title">
          <choose>
            <if match="any" type="broadcast graphic map motion_picture">
              <!-- For audiovisual media, number information comes after `title`, not `container-title`; `song` places album catalogue `number` with `publisher` (CMOS 14.163-164) -->
              <text macro="identifier-number-note"/>
            </if>
          </choose>
          <text macro="identifier-contributors-note"/>
        </else-if>
        <else>
          <choose>
            <if match="none" type="song">
              <text macro="identifier-number-note"/>
            </if>
          </choose>
          <text macro="label-version"/>
          <choose>
            <if match="none" variable="original-date">
              <text macro="label-edition"/>
            </if>
          </choose>
          <choose>
            <if variable="collection-editor">
              <choose>
                <if match="none" variable="collection-title container-title part-title volume-title">
                  <names variable="collection-editor">
                    <label form="verb-short" suffix=" "/>
                    <name/>
                  </names>
                </if>
                <else>
                  <text macro="identifier-contributors-note"/>
                </else>
              </choose>
            </if>
            <else>
              <text macro="identifier-contributors-note"/>
            </else>
          </choose>
          <text macro="identifier-volume-monographic-note"/>
          <choose>
            <if variable="collection-editor">
              <choose>
                <if match="none" variable="collection-title container-title part-title volume-title">
                  <text macro="identifier-contributors-note"/>
                </if>
              </choose>
            </if>
          </choose>
        </else>
      </choose>
    </group>
  </macro>
  <!-- Identifier elements -->
  <macro name="identifier-contributors-bib">
    <choose>
      <if match="any" type="article-journal article-magazine article-newspaper periodical post-weblog review review-book">
        <text macro="identifier-contributors-serial-bib"/>
      </if>
      <else-if match="any" type="interview paper-conference">
        <choose>
          <if match="any" variable="collection-editor compiler editor editorial-director">
            <text macro="identifier-contributors-monographic-bib"/>
          </if>
          <else>
            <text macro="identifier-contributors-serial-bib"/>
          </else>
        </choose>
      </else-if>
      <else>
        <text macro="identifier-contributors-monographic-bib"/>
      </else>
    </choose>
  </macro>
  <macro name="identifier-contributors-note">
    <choose>
      <if match="any" type="article-journal article-magazine article-newspaper periodical post-weblog review review-book">
        <text macro="identifier-contributors-serial-note"/>
      </if>
      <else-if match="any" type="interview paper-conference">
        <choose>
          <if match="any" variable="collection-editor compiler editor editorial-director">
            <text macro="identifier-contributors-monographic-note"/>
          </if>
          <else>
            <text macro="identifier-contributors-serial-note"/>
          </else>
        </choose>
      </else-if>
      <else>
        <text macro="identifier-contributors-monographic-note"/>
      </else>
    </choose>
  </macro>
  <macro name="identifier-contributors-monographic-bib">
    <group delimiter=". ">
      <choose>
        <if variable="title">
          <names variable="interviewer">
            <label form="verb" suffix=" " text-case="capitalize-first"/>
            <name/>
          </names>
        </if>
      </choose>
      <choose>
        <if match="none" type="post webpage">
          <!-- Handle `container-title` on `post` or `webpage` as `publisher` -->
          <group delimiter=". ">
            <choose>
              <if match="none" variable="container-title">
                <names variable="container-author">
                  <label form="verb" suffix=" " text-case="capitalize-first"/>
                  <name/>
                </names>
                <names variable="editor-translator">
                  <label form="verb" suffix=" " text-case="capitalize-first"/>
                  <name/>
                </names>
                <names delimiter=". " variable="editor translator">
                  <label form="verb" suffix=" " text-case="capitalize-first"/>
                  <name/>
                </names>
                <names variable="editorial-director">
                  <label form="verb" suffix=" " text-case="capitalize-first"/>
                  <name/>
                </names>
                <names variable="guest">
                  <label form="verb" suffix=" " text-case="capitalize-first"/>
                  <name/>
                </names>
                <names variable="host">
                  <label form="verb" suffix=" " text-case="capitalize-first"/>
                  <name/>
                </names>
              </if>
            </choose>
            <names delimiter=". " variable="illustrator narrator">
              <label form="verb" suffix=" " text-case="capitalize-first"/>
              <name/>
            </names>
            <choose>
              <if match="none" variable="container-title">
                <names delimiter=". " variable="compiler chair organizer curator">
                  <label form="verb" suffix=" " text-case="capitalize-first"/>
                  <name/>
                </names>
                <names delimiter=". " variable="series-creator executive-producer director">
                  <label form="verb" suffix=" " text-case="capitalize-first"/>
                  <name/>
                </names>
                <choose>
                  <if type="broadcast">
                    <names variable="script-writer">
                      <label form="verb" suffix=" " text-case="capitalize-first"/>
                      <name/>
                    </names>
                  </if>
                </choose>
                <names variable="performer">
                  <label form="verb" suffix=" " text-case="capitalize-first"/>
                  <name/>
                </names>
                <choose>
                  <if match="none" type="song">
                    <names variable="contributor">
                      <label form="verb" suffix=" " text-case="capitalize-first"/>
                      <name/>
                    </names>
                  </if>
                </choose>
              </if>
            </choose>
            <choose>
              <if type="song">
                <!-- Song contributors attached to album (CMOS 14.163) -->
                <names variable="contributor">
                  <label form="verb" suffix=" " text-case="capitalize-first"/>
                  <name/>
                </names>
              </if>
            </choose>
          </group>
        </if>
        <else>
          <group delimiter=". ">
            <names variable="container-author">
              <label form="verb" suffix=" " text-case="capitalize-first"/>
              <name/>
            </names>
            <names variable="editor-translator">
              <label form="verb" suffix=" " text-case="capitalize-first"/>
              <name/>
            </names>
            <names delimiter=". " variable="editor translator">
              <label form="verb" suffix=" " text-case="capitalize-first"/>
              <name/>
            </names>
            <names variable="editorial-director">
              <label form="verb" suffix=" " text-case="capitalize-first"/>
              <name/>
            </names>
            <names variable="guest">
              <label form="verb" suffix=" " text-case="capitalize-first"/>
              <name/>
            </names>
            <names variable="host">
              <label form="verb" suffix=" " text-case="capitalize-first"/>
              <name/>
            </names>
            <names delimiter=". " variable="illustrator narrator">
              <label form="verb" suffix=" " text-case="capitalize-first"/>
              <name/>
            </names>
            <names delimiter=". " variable="compiler chair organizer curator">
              <label form="verb" suffix=" " text-case="capitalize-first"/>
              <name/>
            </names>
            <names delimiter=". " variable="series-creator executive-producer director">
              <label form="verb" suffix=" " text-case="capitalize-first"/>
              <name/>
            </names>
            <choose>
              <if type="broadcast">
                <names variable="script-writer">
                  <label form="verb" suffix=" " text-case="capitalize-first"/>
                  <name/>
                </names>
              </if>
            </choose>
            <names variable="performer">
              <label form="verb" suffix=" " text-case="capitalize-first"/>
              <name/>
            </names>
            <names variable="contributor">
              <label form="verb" suffix=" " text-case="capitalize-first"/>
              <name/>
            </names>
          </group>
        </else>
      </choose>
    </group>
  </macro>
  <macro name="identifier-contributors-monographic-note">
    <group delimiter=". ">
      <choose>
        <if variable="title">
          <names variable="interviewer">
            <label form="verb-short" suffix=" "/>
            <name/>
          </names>
        </if>
      </choose>
      <choose>
        <if match="none" type="post webpage">
          <!-- Handle `container-title` on `post` or `webpage` as `publisher` -->
          <group delimiter=". ">
            <choose>
              <if match="none" variable="container-title">
                <names variable="container-author">
                  <label form="verb-short" suffix=" "/>
                  <name/>
                </names>
                <names variable="editor-translator">
                  <label form="verb-short" suffix=" "/>
                  <name/>
                </names>
                <names variable="editor translator">
                  <label form="verb-short" suffix=" "/>
                  <name/>
                </names>
                <names variable="editorial-director">
                  <label form="verb-short" suffix=" "/>
                  <name/>
                </names>
                <names variable="guest">
                  <label form="verb-short" suffix=" "/>
                  <name/>
                </names>
                <names variable="host">
                  <label form="verb-short" suffix=" "/>
                  <name/>
                </names>
              </if>
            </choose>
            <names variable="illustrator narrator">
              <label form="verb-short" suffix=" "/>
              <name/>
            </names>
            <choose>
              <if match="none" variable="container-title">
                <names variable="compiler chair organizer curator">
                  <label form="verb-short" suffix=" "/>
                  <name/>
                </names>
                <names variable="series-creator executive-producer director">
                  <label form="verb-short" suffix=" "/>
                  <name/>
                </names>
                <choose>
                  <if type="broadcast">
                    <names variable="script-writer">
                      <label form="verb-short" suffix=" "/>
                      <name/>
                    </names>
                  </if>
                </choose>
                <names variable="performer">
                  <label form="verb-short" suffix=" "/>
                  <name/>
                </names>
                <choose>
                  <if match="none" type="song">
                    <names variable="contributor">
                      <label form="verb-short" suffix=" "/>
                      <name/>
                    </names>
                  </if>
                </choose>
              </if>
            </choose>
            <choose>
              <if type="song">
                <!-- Song contributors attached to album (CMOS 14.163) -->
                <names variable="contributor">
                  <label form="verb-short" suffix=" "/>
                  <name/>
                </names>
              </if>
            </choose>
          </group>
        </if>
        <else>
          <group delimiter=". ">
            <names variable="container-author">
              <label form="verb-short" suffix=" "/>
              <name/>
            </names>
            <names variable="editor-translator">
              <label form="verb-short" suffix=" "/>
              <name/>
            </names>
            <names variable="editor translator">
              <label form="verb-short" suffix=" "/>
              <name/>
            </names>
            <names variable="editorial-director">
              <label form="verb-short" suffix=" "/>
              <name/>
            </names>
            <names variable="guest">
              <label form="verb-short" suffix=" "/>
              <name/>
            </names>
            <names variable="host">
              <label form="verb-short" suffix=" "/>
              <name/>
            </names>
            <names variable="illustrator narrator">
              <label form="verb-short" suffix=" "/>
              <name/>
            </names>
            <names variable="compiler chair organizer curator">
              <label form="verb-short" suffix=" "/>
              <name/>
            </names>
            <names variable="series-creator executive-producer director">
              <label form="verb-short" suffix=" "/>
              <name/>
            </names>
            <choose>
              <if type="broadcast">
                <names variable="script-writer">
                  <label form="verb-short" suffix=" "/>
                  <name/>
                </names>
              </if>
            </choose>
            <names variable="performer">
              <label form="verb-short" suffix=" "/>
              <name/>
            </names>
            <names variable="contributor">
              <label form="verb-short" suffix=" "/>
              <name/>
            </names>
          </group>
        </else>
      </choose>
    </group>
  </macro>
  <macro name="identifier-contributors-serial-bib">
    <group delimiter=". ">
      <choose>
        <if variable="title">
          <names variable="interviewer">
            <label form="verb" suffix=" " text-case="capitalize-first"/>
            <name/>
          </names>
        </if>
      </choose>
      <names variable="translator">
        <label form="verb" suffix=" " text-case="capitalize-first"/>
        <name/>
      </names>
      <names variable="narrator">
        <label form="verb" suffix=" " text-case="capitalize-first"/>
        <name/>
      </names>
    </group>
  </macro>
  <macro name="identifier-contributors-serial-note">
    <group delimiter=", ">
      <choose>
        <if variable="title">
          <names variable="interviewer">
            <label form="verb-short" suffix=" "/>
            <name/>
          </names>
        </if>
      </choose>
      <names variable="translator">
        <label form="verb-short" suffix=" "/>
        <name/>
      </names>
      <names variable="narrator">
        <label form="verb-short" suffix=" "/>
        <name/>
      </names>
    </group>
  </macro>
  <macro name="identifier-number-bib">
    <group delimiter=" ">
      <choose>
        <if is-numeric="number" type="broadcast">
          <choose>
            <if variable="genre">
              <text text-case="capitalize-first" variable="genre"/>
            </if>
            <else>
              <text term="podcast-episode" text-case="capitalize-first"/>
            </else>
          </choose>
          <text variable="number"/>
        </if>
        <else-if variable="number">
          <text text-case="capitalize-first" variable="genre"/>
          <text macro="label-number-capitalized"/>
        </else-if>
      </choose>
    </group>
  </macro>
  <macro name="identifier-number-note">
    <group delimiter=" ">
      <choose>
        <if is-numeric="number" type="broadcast">
          <choose>
            <if variable="genre">
              <text variable="genre"/>
            </if>
            <else>
              <text term="podcast-episode"/>
            </else>
          </choose>
          <text variable="number"/>
        </if>
        <else-if variable="number">
          <text variable="genre"/>
          <text macro="label-number"/>
        </else-if>
      </choose>
    </group>
  </macro>
  <macro name="identifier-patent">
    <group delimiter=", ">
      <group delimiter=" ">
        <!-- `authority`: US ; `genre`: patent ; `number`: 123,445 -->
        <text form="short" variable="authority"/>
        <!-- 'US Patent' capitalized in both bibliography and note forms -->
        <choose>
          <if variable="genre">
            <text text-case="capitalize-first" variable="genre"/>
          </if>
          <else>
            <text term="patent" text-case="capitalize-first"/>
          </else>
        </choose>
        <text variable="number"/>
      </group>
      <group delimiter=" ">
        <text value="filed"/>
        <date form="text" variable="submitted"/>
      </group>
      <group delimiter=" ">
        <choose>
          <if variable="issued submitted">
            <text term="and"/>
          </if>
        </choose>
        <text value="issued"/>
        <!-- Always give full issue date, even in author-date (CMOS 14.158) -->
        <text macro="date-issued-full"/>
      </group>
    </group>
  </macro>
  <macro name="identifier-report-bib">
    <group delimiter=". ">
      <choose>
        <if match="none" variable="title">
          <!-- If there is no `title`, then `genre` and `number` are already printed as the title. -->
          <text macro="label-version-capitalized"/>
          <choose>
            <if match="none" variable="original-date">
              <text macro="label-edition-capitalized"/>
            </if>
          </choose>
          <text macro="identifier-contributors-bib"/>
          <text macro="identifier-volume-monographic-bib"/>
        </if>
        <!-- If the report is a chapter in a larger report, then most identifying information is printed in the source. -->
        <else-if variable="container-title">
          <text macro="identifier-contributors-bib"/>
        </else-if>
        <else>
          <text macro="identifier-number-bib"/>
          <text macro="label-version-capitalized"/>
          <choose>
            <if match="none" variable="original-date">
              <text macro="label-edition-capitalized"/>
            </if>
          </choose>
          <text macro="identifier-contributors-bib"/>
          <text macro="identifier-volume-monographic-bib"/>
        </else>
      </choose>
    </group>
  </macro>
  <macro name="identifier-report-note">
    <group delimiter=", ">
      <choose>
        <if match="none" variable="title">
          <!-- If there is no `title`, then `genre` and `number` are already printed as the title. -->
          <text macro="label-version"/>
          <choose>
            <if match="none" variable="original-date">
              <text macro="label-edition"/>
            </if>
          </choose>
          <text macro="identifier-contributors-note"/>
          <text macro="identifier-volume-monographic-note"/>
        </if>
        <!-- If the report is a chapter in a larger report, then most identifying information is printed in the source. -->
        <else-if variable="container-title">
          <text macro="identifier-contributors-note"/>
        </else-if>
        <else>
          <text macro="identifier-number-note"/>
          <text macro="label-version"/>
          <choose>
            <if match="none" variable="original-date">
              <text macro="label-edition"/>
            </if>
          </choose>
          <text macro="identifier-contributors-note"/>
          <text macro="identifier-volume-monographic-note"/>
        </else>
      </choose>
    </group>
  </macro>
  <macro name="identifier-volume-bib">
    <!-- List the individual volume first in the bibliography (CMOS 14.21) -->
    <group delimiter=", ">
      <choose>
        <if variable="part-number part-title volume volume-title">
          <!-- part and title with individual titles -->
          <group delimiter=" ">
            <text macro="label-part-number-capitalized"/>
            <text value="of"/>
            <text font-style="italic" text-case="title" variable="volume-title"/>
          </group>
          <group delimiter=" ">
            <text macro="label-volume"/>
            <text value="of"/>
            <group delimiter=", ">
              <text macro="title-primary"/>
              <names variable="collection-editor">
                <label form="verb" suffix=" "/>
                <name/>
              </names>
            </group>
          </group>
        </if>
        <else-if match="any" variable="part-title volume-title">
          <group delimiter=" ">
            <choose>
              <if variable="part-number volume">
                <group delimiter=", ">
                  <text macro="label-volume-capitalized"/>
                  <text macro="label-part-number"/>
                  <text value="of"/>
                </group>
              </if>
              <else-if variable="part-number">
                <text macro="label-part-number-capitalized"/>
                <text value="of"/>
              </else-if>
              <else-if variable="volume">
                <text macro="label-volume-capitalized"/>
                <text value="of"/>
              </else-if>
            </choose>
            <group delimiter=", ">
              <text macro="title-primary"/>
              <names variable="collection-editor">
                <label form="verb" suffix=" "/>
                <name/>
              </names>
            </group>
          </group>
        </else-if>
        <else-if match="any" variable="part-number volume">
          <choose>
            <if variable="part-number volume">
              <text macro="label-volume-capitalized"/>
              <text macro="label-part-number"/>
            </if>
            <else-if variable="part-number">
              <text macro="label-part-number-capitalized"/>
            </else-if>
            <else-if variable="volume">
              <text macro="label-volume-capitalized"/>
            </else-if>
          </choose>
        </else-if>
        <else>
          <text macro="label-number-of-volumes"/>
        </else>
      </choose>
    </group>
  </macro>
  <macro name="identifier-volume-note">
    <!-- List the general title first in the notes (CMOS 14.20) -->
    <group delimiter=", ">
      <choose>
        <if variable="part-number part-title volume volume-title">
          <!-- part and title with individual titles -->
          <group delimiter=" ">
            <text macro="label-part-number"/>
            <text value="of"/>
            <text font-style="italic" text-case="title" variable="volume-title"/>
          </group>
          <group delimiter=" ">
            <text macro="label-volume"/>
            <text value="of"/>
            <group delimiter=", ">
              <text macro="title-primary"/>
              <names variable="collection-editor">
                <label form="verb" suffix=" "/>
                <name/>
              </names>
            </group>
          </group>
        </if>
        <else-if match="any" variable="part-title volume-title">
          <group delimiter=" ">
            <choose>
              <if variable="part-number volume">
                <group delimiter=", ">
                  <text macro="label-volume"/>
                  <text macro="label-part-number"/>
                  <text value="of"/>
                </group>
              </if>
              <else-if variable="part-number">
                <text macro="label-part-number"/>
                <text value="of"/>
              </else-if>
              <else-if variable="volume">
                <text macro="label-volume"/>
                <text value="of"/>
              </else-if>
            </choose>
            <group delimiter=", ">
              <text macro="title-primary"/>
              <names variable="collection-editor">
                <label form="verb-short" suffix=" "/>
                <name/>
              </names>
            </group>
          </group>
        </else-if>
        <else-if match="any" variable="part-number volume">
          <choose>
            <if variable="part-number volume">
              <text macro="label-volume"/>
              <text macro="label-part-number"/>
            </if>
            <else-if variable="part-number">
              <text macro="label-part-number"/>
            </else-if>
            <else-if variable="volume">
              <text macro="label-volume"/>
            </else-if>
          </choose>
        </else-if>
        <else>
          <text macro="label-number-of-volumes"/>
        </else>
      </choose>
    </group>
  </macro>
  <macro name="identifier-volume-monographic-bib">
    <choose>
      <if match="any" type="article-journal article-magazine article-newspaper broadcast event interview patent performance periodical post post-weblog review review-book speech webpage"/>
      <else-if match="any" type="interview paper-conference">
        <choose>
          <if match="any" variable="collection-editor compiler editor editorial-director">
            <text macro="identifier-volume-bib"/>
          </if>
        </choose>
      </else-if>
      <else>
        <text macro="identifier-volume-bib"/>
      </else>
    </choose>
  </macro>
  <macro name="identifier-volume-monographic-note">
    <choose>
      <if match="any" type="article-journal article-magazine article-newspaper broadcast event interview patent performance periodical post post-weblog review review-book speech webpage"/>
      <else-if match="any" type="interview paper-conference">
        <choose>
          <if match="any" variable="collection-editor compiler editor editorial-director">
            <text macro="identifier-volume-note"/>
          </if>
        </choose>
      </else-if>
      <else>
        <text macro="identifier-volume-note"/>
      </else>
    </choose>
  </macro>
  <!-- 4. Source -->
  <macro name="source-bib">
    <group delimiter=". ">
      <choose>
        <if match="any" type="article-journal article-magazine article-newspaper periodical post-weblog review review-book">
          <!-- Serial items -->
          <text macro="source-serial-bib"/>
        </if>
        <else-if match="any" type="interview paper-conference">
          <!-- Determine whether serial or monographic -->
          <choose>
            <if match="any" variable="collection-editor container-author editor editorial-director">
              <text macro="source-monographic-bib"/>
            </if>
            <else>
              <text macro="source-serial-bib"/>
            </else>
          </choose>
        </else-if>
        <else-if match="none" type="patent post webpage">
          <text macro="source-monographic-bib"/>
        </else-if>
      </choose>
    </group>
  </macro>
  <!-- 4.1. Serial sources -->
  <macro name="source-serial-bib">
    <group delimiter=". ">
      <text macro="source-serial-title-volume-bib"/>
      <choose>
        <if variable="volume">
          <choose>
            <if variable="collection-title">
              <group delimiter=", ">
                <text macro="source-serial-title-bib"/>
                <text macro="source-serial-identifier-bib"/>
              </group>
            </if>
            <else>
              <group delimiter=" ">
                <text macro="source-serial-title-bib"/>
                <text macro="source-serial-identifier-bib"/>
              </group>
            </else>
          </choose>
        </if>
        <else>
          <group delimiter=", ">
            <text macro="source-serial-title-bib"/>
            <text macro="source-serial-identifier-bib"/>
          </group>
        </else>
      </choose>
    </group>
  </macro>
  <!-- Serial source title -->
  <macro name="source-serial-name">
    <group delimiter=" ">
      <text font-style="italic" text-case="title" variable="container-title"/>
      <choose>
        <!-- TODO: remove conditional when Zotero stops double-mapping `event-place` and `publisher-place` -->
        <if match="none" variable="event-date event-title reviewed-genre">
          <text prefix="(" suffix=")" variable="publisher-place"/>
        </if>
      </choose>
    </group>
  </macro>
  <macro name="source-serial-title-bib">
    <group delimiter=", ">
      <choose>
        <if match="any" type="periodical" variable="volume-title">
          <!-- `genre` is used for a special issue or similar within a standard journal run -->
          <choose>
            <if variable="genre">
              <text text-case="capitalize-first" variable="genre"/>
            </if>
            <else-if is-numeric="supplement-number" match="none" variable="collection-title">
              <!-- `supplement-number` will not have a label if non-numeric -->
              <text term="supplement" text-case="capitalize-first"/>
            </else-if>
          </choose>
        </if>
      </choose>
      <text macro="source-serial-name"/>
      <!-- `collection-title` is for any serial with multiple series (e.g. 'second series') or separately numbered supplements (e.g. Sonderband or subsidia) -->
      <text variable="collection-title"/>
    </group>
  </macro>
  <macro name="source-serial-title-volume-bib">
    <choose>
      <if variable="volume-title">
        <!-- CMOS 14.77–78: Journal special issues and supplements -->
        <group delimiter=", ">
          <group delimiter=" ">
            <text macro="source-monographic-preposition-bib"/>
            <text quotes="true" text-case="title" variable="volume-title"/>
          </group>
          <text macro="source-monographic-identifier-contributors-bib"/>
        </group>
      </if>
    </choose>
  </macro>
  <!-- Serial source identifier -->
  <macro name="source-serial-identifier-bib">
    <choose>
      <if match="any" variable="issue supplement-number volume">
        <group delimiter=": ">
          <text macro="source-serial-identifier-volume-bib"/>
          <text macro="source-serial-locators"/>
        </group>
      </if>
      <else>
        <group delimiter=", ">
          <group delimiter=". ">
            <text macro="source-serial-identifier-volume-bib"/>
            <!-- periodical edition always capitalized (CMOS 14.89) -->
            <text macro="label-edition-capitalized"/>
          </group>
          <text macro="source-serial-locators"/>
        </group>
      </else>
    </choose>
    <!-- TODO: If CSL adds `date-part` detection, add conditions to address CMOS 14.74:
         - delimiting with ":" if there is a `volume` and no month or `issue` or `supplement number`
         - delimiting with ", " or there is an `issue` or `supplement number` and no month -->
  </macro>
  <macro name="source-serial-identifier-volume-bib">
    <choose>
      <if match="any" variable="issue supplement-number volume">
        <group delimiter=" ">
          <group delimiter=", ">
            <choose>
              <if variable="collection-title volume">
                <text macro="label-volume"/>
              </if>
              <else-if variable="volume">
                <choose>
                  <if match="none" variable="author chair collection-editor compiler composer curator director editor editor-translator editorial-director executive-producer guest host illustrator organizer producer series-creator translator">
                    <!-- date appears first if the serial title has been substituted for a missing author (CMOS 14.102) -->
                    <text macro="label-volume-capitalized"/>
                  </if>
                  <else>
                    <text variable="volume"/>
                  </else>
                </choose>
              </else-if>
            </choose>
            <text macro="label-issue"/>
            <text macro="label-supplement-number"/>
          </group>
          <text macro="source-date" prefix="(" suffix=")"/>
        </group>
      </if>
      <else>
        <text macro="source-serial-volume-status"/>
      </else>
    </choose>
  </macro>
  <macro name="source-serial-volume-status">
    <group delimiter=", ">
      <choose>
        <if match="none" variable="issue number page supplement-number volume">
          <!-- Print the status variable rather than use generic CSL terms (`in press`, etc.) -->
          <text text-case="lowercase" variable="status"/>
        </if>
      </choose>
      <text macro="source-date"/>
    </group>
  </macro>
  <!-- Serial source locators -->
  <macro name="source-serial-locators">
    <choose>
      <if variable="locator">
        <group delimiter=", ">
          <text macro="label-locator"/>
          <!-- Page numbers cited in notes appear alongside article ID (CMOS 14.71) -->
          <text variable="number"/>
        </group>
      </if>
      <else-if variable="number">
        <text variable="number"/>
      </else-if>
      <else>
        <text variable="page"/>
      </else>
    </choose>
  </macro>
  <!-- 4.2. Monographic sources -->
  <macro name="source-monographic-bib">
    <group delimiter=". ">
      <!-- Monographic sources repeat main reference elements -->
      <choose>
        <if variable="container-title">
          <group delimiter=", ">
            <group delimiter=" ">
              <choose>
                <if match="none" type="broadcast motion_picture">
                  <text macro="source-monographic-preposition-bib"/>
                </if>
              </choose>
              <text macro="source-monographic-title"/>
            </group>
            <text macro="source-monographic-description-bib"/>
            <text macro="source-monographic-identifier-bib"/>
            <text macro="source-monographic-locators-bib"/>
          </group>
        </if>
      </choose>
      <text macro="source-series"/>
      <text macro="source-event-bib"/>
    </group>
  </macro>
  <!-- Monographic source title -->
  <macro name="source-monographic-preposition-bib">
    <choose>
      <if match="none" type="interview personal_communication" variable="title">
        <choose>
          <if variable="genre">
            <text value="to"/>
          </if>
        </choose>
      </if>
      <else-if match="any" type="entry entry-dictionary entry-encyclopedia">
        <choose>
          <if match="any" variable="author chair collection-editor compiler composer curator director editor editor-translator editorial-director executive-producer guest host illustrator organizer producer series-creator translator">
            <!-- Give preposition only if title has not been substituted -->
            <text term="in" text-case="capitalize-first"/>
          </if>
        </choose>
      </else-if>
      <else-if variable="chapter-number page">
        <text term="in" text-case="capitalize-first"/>
      </else-if>
      <else-if variable="chapter-number">
        <group delimiter=" ">
          <text macro="label-chapter-number-capitalized"/>
          <choose>
            <if type="song">
              <text term="on"/>
            </if>
            <else>
              <text term="in"/>
            </else>
          </choose>
        </group>
      </else-if>
      <else>
        <text term="in" text-case="capitalize-first"/>
      </else>
    </choose>
  </macro>
  <macro name="source-monographic-title">
    <choose>
      <if variable="part-title">
        <text font-style="italic" text-case="title" variable="part-title"/>
      </if>
      <else-if variable="volume-title">
        <text font-style="italic" text-case="title" variable="volume-title"/>
      </else-if>
      <else>
        <text font-style="italic" text-case="title" variable="container-title"/>
      </else>
    </choose>
  </macro>
  <!-- Monographic source description -->
  <macro name="source-monographic-description-bib">
    <choose>
      <if match="any" type="event paper-conference performance speech">
        <!-- Conference presentations should describe the session unless published in a proceedings -->
        <choose>
          <if match="none" variable="collection-editor compiler editor editorial-director issue page volume">
            <text macro="description-format-bib"/>
          </if>
        </choose>
      </if>
      <else-if type="software">
        <!-- For entries in mobile app reference works, place description after `container-title` -->
        <text macro="description-format-bib"/>
      </else-if>
      <else-if match="any" type="document report standard">
        <!-- For chapters in report, standards, and generic documents, place description after `container-title` -->
        <text macro="description-format-bib"/>
      </else-if>
    </choose>
  </macro>
  <!-- Monographic source identifier -->
  <macro name="source-monographic-identifier-bib">
    <choose>
      <if variable="container-title">
        <group delimiter=", ">
          <choose>
            <if match="none" type="broadcast graphic map motion_picture song">
              <!-- For audiovisual media, number information comes after `title`, not `container-title`; `song` places album catalogue `number` with `publisher` (CMOS 14.163-164) -->
              <text macro="identifier-number-bib"/>
            </if>
          </choose>
          <text macro="label-version"/>
          <text macro="label-edition"/>
          <choose>
            <if variable="collection-editor">
              <choose>
                <if match="none" variable="collection-title part-title volume-title">
                  <names variable="collection-editor">
                    <label form="verb" suffix=" "/>
                    <name/>
                  </names>
                </if>
                <else>
                  <text macro="source-monographic-identifier-contributors-bib"/>
                </else>
              </choose>
            </if>
            <else>
              <text macro="source-monographic-identifier-contributors-bib"/>
            </else>
          </choose>
          <text macro="source-monographic-identifier-volume"/>
          <choose>
            <if variable="collection-editor">
              <choose>
                <if match="none" variable="collection-title part-title volume-title">
                  <text macro="source-monographic-identifier-contributors-bib"/>
                </if>
              </choose>
            </if>
          </choose>
        </group>
      </if>
    </choose>
  </macro>
  <macro name="source-monographic-identifier-contributors-bib">
    <group delimiter=", ">
      <names variable="container-author">
        <label form="verb" suffix=" "/>
        <name/>
      </names>
      <names variable="editor-translator">
        <label form="verb" suffix=" "/>
        <name/>
      </names>
      <names variable="editor translator">
        <label form="verb" suffix=" "/>
        <name/>
      </names>
      <names variable="guest">
        <label form="verb" suffix=" "/>
        <name/>
      </names>
      <names variable="host">
        <label form="verb" suffix=" "/>
        <name/>
      </names>
      <names variable="chair organizer">
        <label form="verb" suffix=" "/>
        <name/>
      </names>
      <names variable="illustrator narrator compiler curator">
        <label form="verb" suffix=" "/>
        <name/>
      </names>
      <names variable="series-creator executive-producer editorial-director">
        <label form="verb" suffix=" "/>
        <name/>
      </names>
      <choose>
        <if type="broadcast">
          <names variable="script-writer">
            <label form="verb" suffix=" "/>
            <name/>
          </names>
        </if>
      </choose>
      <names variable="director">
        <label form="verb" suffix=" "/>
        <name/>
      </names>
      <names variable="performer">
        <label form="verb" suffix=" "/>
        <name/>
      </names>
      <choose>
        <if match="none" type="song">
          <!-- Song contributors attached to album (CMOS 14.163) -->
          <names variable="contributor">
            <label form="verb" suffix=" "/>
            <name/>
          </names>
        </if>
      </choose>
    </group>
  </macro>
  <macro name="source-monographic-identifier-volume">
    <!-- Identical to `identifier-volume` but without capitalization and giving `container-title` rather than `title-primary` -->
    <group delimiter=", ">
      <choose>
        <if variable="part-number part-title volume volume-title">
          <!-- part and title with individual titles -->
          <group delimiter=" ">
            <text macro="label-part-number"/>
            <text value="of"/>
            <text font-style="italic" text-case="title" variable="volume-title"/>
          </group>
          <group delimiter=" ">
            <text macro="label-volume"/>
            <text value="of"/>
            <group delimiter=", ">
              <text font-style="italic" text-case="title" variable="container-title"/>
              <names variable="collection-editor">
                <label form="verb" suffix=" "/>
                <name/>
              </names>
            </group>
          </group>
        </if>
        <else-if match="any" variable="part-title volume-title">
          <group delimiter=" ">
            <choose>
              <if variable="part-number volume">
                <group delimiter=", ">
                  <text macro="label-volume"/>
                  <text macro="label-part-number"/>
                  <text value="of"/>
                </group>
              </if>
              <else-if variable="part-number">
                <text macro="label-part-number"/>
                <text value="of"/>
              </else-if>
              <else-if variable="volume">
                <text macro="label-volume"/>
                <text value="of"/>
              </else-if>
            </choose>
            <group delimiter=", ">
              <text font-style="italic" text-case="title" variable="container-title"/>
              <names variable="collection-editor">
                <label form="verb" suffix=" "/>
                <name/>
              </names>
            </group>
          </group>
        </else-if>
        <else-if match="any" variable="part-number volume">
          <choose>
            <if is-numeric="volume" match="none">
              <text macro="label-volume"/>
            </if>
            <else-if is-numeric="volume" variable="page">
              <choose>
                <if match="any" variable="collection-editor part-number part-title volume-title">
                  <!-- without any of these variables, volume is collapsed with adjacent page number in `source-monographic-locators` -->
                  <text macro="label-volume"/>
                </if>
              </choose>
            </else-if>
            <else>
              <text macro="label-volume"/>
            </else>
          </choose>
          <text macro="label-part-number"/>
        </else-if>
        <else>
          <text macro="label-number-of-volumes"/>
        </else>
      </choose>
    </group>
  </macro>
  <!-- Monographic source locators -->
  <macro name="source-monographic-locators-bib">
    <choose>
      <if is-numeric="volume" variable="page">
        <!-- collapse the volume and page number if adjacent -->
        <group delimiter=":">
          <choose>
            <!-- all variables that might come between the volume and page number -->
            <if match="none" variable="collection-editor part-number part-title volume-title">
              <text variable="volume"/>
            </if>
          </choose>
          <text variable="page"/>
        </group>
      </if>
      <else>
        <text variable="page"/>
      </else>
    </choose>
  </macro>
  <!-- 4.3. Series -->
  <macro name="source-series">
    <group delimiter=", ">
      <choose>
        <if variable="collection-editor collection-title">
          <choose>
            <if match="none" variable="number-of-volumes part-number part-title volume volume-title">
              <text text-case="title" variable="collection-title"/>
              <names variable="collection-editor">
                <label form="verb" suffix=" "/>
                <name/>
              </names>
              <text macro="label-collection-number"/>
              <text macro="label-issue"/>
            </if>
            <else>
              <text macro="source-series-title"/>
            </else>
          </choose>
        </if>
        <else>
          <text macro="source-series-title"/>
        </else>
      </choose>
    </group>
  </macro>
  <macro name="source-series-title">
    <group delimiter=", ">
      <choose>
        <if variable="issue">
          <text text-case="title" variable="collection-title"/>
          <text macro="label-collection-number"/>
          <text macro="label-issue"/>
        </if>
        <else-if is-numeric="collection-number" variable="collection-title">
          <group delimiter=" ">
            <text text-case="title" variable="collection-title"/>
            <text variable="collection-number"/>
          </group>
        </else-if>
        <else-if variable="collection-title">
          <text text-case="title" variable="collection-title"/>
          <text variable="collection-number"/>
        </else-if>
      </choose>
    </group>
  </macro>
  <!-- 4.4. Event -->
  <macro name="source-event-bib">
    <group delimiter=" ">
      <choose>
        <if match="any" variable="event event-title">
          <!-- TODO: To prevent Zotero from printing `event-place`, due to its double-mapping of `publisher-place` and `event-place`. Remove this when that is changed. -->
          <text macro="source-event-status-bib"/>
          <choose>
            <if type="paper-conference">
              <choose>
                <if match="none" variable="collection-editor compiler editor editorial-director issue page volume">
                  <!-- Don't print event info for conference papers published in proceedings -->
                  <text macro="source-event-description-bib"/>
                </if>
              </choose>
            </if>
            <else>
              <!-- For other item types, print event info even if published (e.g. collection catalogs, performance programs). -->
              <text macro="source-event-description-bib"/>
            </else>
          </choose>
        </if>
      </choose>
    </group>
  </macro>
  <macro name="source-event-note">
    <group delimiter=" ">
      <choose>
        <if match="any" variable="event event-title">
          <!-- TODO: To prevent Zotero from printing `event-place`, due to its double-mapping of `publisher-place` and `event-place`. Remove this when that is changed. -->
          <text macro="source-event-status-note"/>
          <choose>
            <if type="paper-conference">
              <choose>
                <if match="none" variable="collection-editor compiler editor editorial-director issue page volume">
                  <!-- Don't print event info for conference papers published in proceedings -->
                  <text macro="source-event-description-note"/>
                </if>
              </choose>
            </if>
            <else>
              <!-- For other item types, print event info even if published (e.g. collection catalogs, performance programs). -->
              <text macro="source-event-description-note"/>
            </else>
          </choose>
        </if>
      </choose>
    </group>
  </macro>
  <macro name="source-event-status-bib">
    <group delimiter=" ">
      <choose>
        <if variable="status">
          <!-- 'aired', 'performed', etc. (CMOS 14.165) -->
          <text text-case="capitalize-first" variable="status"/>
        </if>
        <else-if match="any" type="paper-conference speech">
          <choose>
            <if variable="genre">
              <text text-case="capitalize-first" value="presented"/>
              <choose>
                <if variable="event-title">
                  <text term="at"/>
                </if>
              </choose>
            </if>
            <else>
              <choose>
                <if type="paper-conference">
                  <text form="short" term="paper-conference" text-case="capitalize-first"/>
                  <text value="presented"/>
                </if>
                <else>
                  <text text-case="capitalize-first" value="presented"/>
                </else>
              </choose>
              <choose>
                <if variable="event-title">
                  <text term="at"/>
                </if>
              </choose>
            </else>
          </choose>
        </else-if>
        <else-if type="song">
          <text text-case="capitalize-first" value="recorded"/>
          <choose>
            <if variable="event-title">
              <text term="at"/>
            </if>
          </choose>
        </else-if>
      </choose>
    </group>
  </macro>
  <macro name="source-event-status-note">
    <group delimiter=" ">
      <choose>
        <if variable="status">
          <!-- 'aired', 'performed', etc. (CMOS 14.165) -->
          <text variable="status"/>
        </if>
        <else-if match="any" type="paper-conference speech">
          <choose>
            <if variable="genre">
              <text value="presented"/>
              <choose>
                <if variable="event-title">
                  <text term="at"/>
                </if>
              </choose>
            </if>
            <else>
              <choose>
                <if type="paper-conference">
                  <text form="short" term="paper-conference"/>
                  <text value="presented"/>
                </if>
                <else>
                  <text value="presented"/>
                </else>
              </choose>
              <choose>
                <if variable="event-title">
                  <text term="at"/>
                </if>
              </choose>
            </else>
          </choose>
        </else-if>
        <else-if type="song">
          <text value="recorded"/>
          <choose>
            <if variable="event-title">
              <text term="at"/>
            </if>
          </choose>
        </else-if>
      </choose>
    </group>
  </macro>
  <macro name="source-event-title">
    <choose>
      <!-- TODO: We expect `event-title` to be used, but processors and applications may not be updated yet. This macro ensures that either `event` or `event-title` can be accepted. Remove if processor logic and application adoption can handle this. -->
      <if variable="event-title">
        <text variable="event-title"/>
      </if>
      <else>
        <text variable="event"/>
      </else>
    </choose>
  </macro>
  <macro name="source-event-title-capitalized">
    <choose>
      <!-- TODO: We expect `event-title` to be used, but processors and applications may not be updated yet. This macro ensures that either `event` or `event-title` can be accepted. Remove if processor logic and application adoption can handle this. -->
      <if variable="event-title">
        <text text-case="capitalize-first" variable="event-title"/>
      </if>
      <else>
        <text text-case="capitalize-first" variable="event"/>
      </else>
    </choose>
  </macro>
  <macro name="source-event-description-bib">
    <group delimiter=", ">
      <choose>
        <if type="song">
          <text macro="source-event-title"/>
        </if>
        <else-if type="paper-conference">
          <choose>
            <if variable="genre">
              <text macro="source-event-title-capitalized"/>
            </if>
            <else>
              <text macro="source-event-title"/>
            </else>
          </choose>
        </else-if>
        <else>
          <text macro="source-event-title-capitalized"/>
        </else>
      </choose>
      <date form="text" variable="event-date"/>
      <text variable="event-place"/>
    </group>
  </macro>
  <macro name="source-event-description-note">
    <group delimiter=", ">
      <choose>
        <if type="song">
          <text macro="source-event-title"/>
        </if>
        <else-if type="paper-conference">
          <choose>
            <if variable="genre">
              <text macro="source-event-title"/>
            </if>
            <else>
              <text macro="source-event-title"/>
            </else>
          </choose>
        </else-if>
        <else>
          <text macro="source-event-title"/>
        </else>
      </choose>
      <date form="text" variable="event-date"/>
      <text variable="event-place"/>
    </group>
  </macro>
  <!-- 4.5. Facts of publication -->
  <macro name="source-monographic-publication-bib">
    <choose>
      <!-- Provide only for monographic types -->
      <if match="any" type="article-journal article-magazine article-newspaper periodical post-weblog review review-book"/>
      <!-- `patent` date in identification (CMOS 14.158) -->
      <else-if type="patent"/>
      <else-if match="any" type="interview paper-conference">
        <!-- Determine whether serial or monographic -->
        <choose>
          <if match="any" variable="collection-editor container-author editor editorial-director">
            <text macro="source-publication-and-date-bib"/>
          </if>
        </choose>
      </else-if>
      <else>
        <text macro="source-publication-and-date-bib"/>
      </else>
    </choose>
  </macro>
  <macro name="source-publication-and-date-bib">
    <group delimiter=", ">
      <choose>
        <if match="any" type="post webpage">
          <!-- `container-title` functions like a publisher with social media and website sources (CMOS 14.104-106) -->
          <text text-case="title" variable="container-title"/>
        </if>
      </choose>
      <choose>
        <if type="broadcast">
          <!-- a podcast publisher appears before the date, whereas the network of an aired show appears after (CMOS 14.165); unfortunately CSL stores both in `publisher` -->
          <choose>
            <if variable="URL">
              <!-- TODO: `URL` is the only way to distinguish radio/TV from podcasts, but it is obviously imprecise; modify if CSL provides better detection -->
              <text macro="source-publication-history-bib"/>
            </if>
          </choose>
        </if>
        <else>
          <text macro="source-publication-history-bib"/>
        </else>
      </choose>
      <group delimiter=" ">
        <text macro="source-date-status-bib"/>
        <text macro="source-date"/>
      </group>
      <choose>
        <if type="broadcast">
          <choose>
            <if match="none" variable="URL">
              <group delimiter=" ">
                <text term="on"/>
                <text macro="source-publication-history-bib"/>
              </group>
            </if>
          </choose>
        </if>
      </choose>
    </group>
  </macro>
  <!-- Facts of publication elements -->
  <macro name="source-publication-history-bib">
    <group delimiter=". ">
      <!-- Original title of a translated work (CMOS 13.101) -->
      <choose>
        <if variable="original-title">
          <text macro="source-publication-original-title"/>
        </if>
      </choose>
      <text macro="source-publication-publisher-original"/>
      <group delimiter=", ">
        <text macro="source-publication-description-bib"/>
        <text macro="source-publication-history-edition-bib"/>
        <text macro="source-publication-publisher"/>
      </group>
    </group>
  </macro>
  <macro name="source-publication-history-edition-bib">
    <choose>
      <if variable="issued original-date">
        <choose>
          <if variable="edition">
            <text macro="label-edition-capitalized"/>
          </if>
          <else-if match="any" type="book chapter classic pamphlet report">
            <choose>
              <if match="none" variable="medium">
                <text text-case="capitalize-first" value="reprint"/>
              </if>
            </choose>
          </else-if>
        </choose>
      </if>
    </choose>
  </macro>
  <macro name="source-publication-description-bib">
    <choose>
      <if type="article">
        <choose>
          <if match="none" variable="genre">
            <!-- `preprint` term attached to repository name, but specific working paper descriptors appear in description (CMOS 14.76, 14.116) -->
            <text term="preprint" text-case="capitalize-first"/>
          </if>
        </choose>
      </if>
      <else-if type="thesis">
        <!-- thesis type appears with university name (CMOS 14.113) -->
        <text macro="description-format-bib"/>
      </else-if>
    </choose>
  </macro>
  <macro name="source-publication-original-title">
    <choose>
      <if variable="original-title">
        <group delimiter=" ">
          <text term="original-work-published" text-case="capitalize-first"/>
          <text value="as"/>
          <choose>
            <if match="any" type="article-journal article-magazine article-newspaper periodical post-weblog review review-book">
              <text quotes="true" text-case="title" variable="original-title"/>
            </if>
            <else>
              <text font-style="italic" text-case="title" variable="original-title"/>
            </else>
          </choose>
        </group>
      </if>
    </choose>
  </macro>
  <macro name="source-publication-publisher">
    <group delimiter=" ">
      <choose>
        <if type="thesis" variable="publisher">
          <text variable="publisher"/>
        </if>
        <else-if variable="publisher">
          <group delimiter=": ">
            <text variable="publisher-place"/>
            <text variable="publisher"/>
          </group>
        </else-if>
        <else>
          <choose>
            <!-- TODO: remove conditional when Zotero fixes double-mapping of `event-place` -->
            <if match="none" variable="event-date event-title">
              <text variable="publisher-place"/>
            </if>
          </choose>
        </else>
      </choose>
      <choose>
        <if type="song">
          <!-- Album catalogue number follows label name (CMOS 14.163–164) -->
          <text variable="number"/>
        </if>
      </choose>
    </group>
  </macro>
  <macro name="source-publication-publisher-original">
    <choose>
      <if variable="original-publisher">
        <group delimiter=": ">
          <text variable="original-publisher-place"/>
          <text variable="original-publisher"/>
        </group>
      </if>
      <else>
        <text variable="original-publisher-place"/>
      </else>
    </choose>
  </macro>
  <!-- 4.6. Date -->
  <macro name="source-date">
    <choose>
      <if variable="available-date">
        <!-- TODO: Better variable for container date (CMOS 14.21)? -->
        <date date-parts="year" form="text" variable="available-date"/>
      </if>
      <else>
        <text macro="source-date-issued-full"/>
        <!-- for author-date: -->
        <!-- <text macro="source-date-issued-month-day"/> -->
      </else>
    </choose>
  </macro>
  <macro name="source-date-issued-full">
    <!-- Give full date for more ephemeral types; reflected in `date-sort` -->
    <choose>
      <if type="personal_communication" variable="event-date issued">
        <!-- Provide issue date for letters listed under event-date -->
        <text macro="date-issued-year"/>
      </if>
      <else-if match="any" type="article-journal article-magazine article-newspaper periodical post-weblog review review-book">
        <choose>
          <if variable="issue volume">
            <date date-parts="year" form="text" variable="issued"/>
          </if>
          <else-if variable="supplement-number volume">
            <date date-parts="year" form="text" variable="issued"/>
          </else-if>
          <else-if variable="volume">
            <date date-parts="year-month" form="text" variable="issued"/>
          </else-if>
          <else>
            <text macro="date-issued-full"/>
          </else>
        </choose>
      </else-if>
      <else-if type="paper-conference">
        <choose>
          <if match="none" variable="collection-editor compiler editor editorial-director issue page volume">
            <!-- `paper-conference` in proceedings -->
            <text macro="date-issued-full"/>
          </if>
          <else>
            <text macro="date-issued-year"/>
          </else>
        </choose>
      </else-if>
      <else-if match="any" type="entry entry-dictionary entry-encyclopedia">
        <choose>
          <if match="any" variable="DOI URL">
            <!-- Online reference works use full dates (CMOS 14.131) -->
            <text macro="date-issued-full"/>
          </if>
          <else>
            <text macro="date-issued-year"/>
          </else>
        </choose>
      </else-if>
      <else-if match="any" type="article broadcast collection dataset document event graphic interview manuscript map patent performance personal_communication post software song speech standard webpage">
        <text macro="date-issued-full"/>
      </else-if>
      <else>
        <text macro="date-issued-year"/>
      </else>
    </choose>
  </macro>
  <macro name="source-date-status-bib">
    <choose>
      <if variable="event-title issued status"/>
      <!-- if there is an `event-title`, `status` appears with `event-date` as part of `source-event` -->
      <else-if variable="issued status">
        <!-- `status` specifies date type, e.g. 'effective', 'last modified', 'approved' (CMOS 14.104 for `webpage`; CMOS 14.159 for `standard`) -->
        <text text-case="capitalize-first" variable="status"/>
      </else-if>
      <else-if type="broadcast" variable="issued">
        <choose>
          <if match="none" variable="URL">
            <!-- assume `status` of a radio or TV broadcast is 'aired' if unspecified (CMOS 14.165) -->
            <text text-case="capitalize-first" value="aired"/>
          </if>
        </choose>
      </else-if>
      <else-if type="software" variable="issued">
        <!-- assume `status` of software is 'released' if unspecified (CMOS 14.169) -->
        <text text-case="capitalize-first" value="released"/>
      </else-if>
    </choose>
  </macro>
  <!-- 4.7. Locators (including page references) -->
  <macro name="source-locator">
    <choose>
      <if type="entry entry-dictionary entry-encyclopedia">
        <choose>
          <if match="none" variable="author">
            <!-- If `container-title` has been substituted, treat `title` as if it is a `locator` (CMOS 14.130) -->
            <choose>
              <if match="none" variable="locator">
                <group delimiter=" ">
                  <choose>
                    <if match="none" variable="DOI URL">
                      <!-- Only print reference entries use `sub-verbo` (CMOS 14.131) -->
                      <text form="short" term="sub-verbo"/>
                    </if>
                  </choose>
                  <text form="short" quotes="true" variable="title"/>
                </group>
              </if>
              <else>
                <text macro="label-locator"/>
              </else>
            </choose>
          </if>
          <else>
            <text macro="label-locator"/>
          </else>
        </choose>
      </if>
      <else>
        <text macro="label-locator"/>
      </else>
    </choose>
  </macro>
  <!-- 4.8. Medium -->
  <macro name="source-medium-bib">
    <group delimiter=", ">
      <text text-case="capitalize-first" variable="medium"/>
      <text variable="dimensions"/>
    </group>
  </macro>
  <!-- 4.9. Archival location -->
  <macro name="source-archive-bib">
    <choose>
      <!-- With `archive_collection` or `archive-place`: physical archives. Without: digital archives (database and identifier) -->
      <if type="graphic">
        <text macro="source-archive-name-first"/>
      </if>
      <else-if match="any" variable="archive_collection archive-place">
        <text macro="source-archive-location-first-bib"/>
      </else-if>
      <else>
        <text macro="source-archive-identifier"/>
      </else>
    </choose>
  </macro>
  <!-- Archival elements -->
  <macro name="source-archive-identifier">
    <group delimiter=", ">
      <text variable="archive"/>
      <text variable="archive_location"/>
    </group>
  </macro>
  <macro name="source-archive-location-first-bib">
    <!-- Order of elements begins with the most specific (CMOS 14.119, 14.127) -->
    <!-- In note styles, the bibliography generally provide entries for a `collection` rather than individual items (CMOS 14.120, 14.128) -->
    <group delimiter=". ">
      <group delimiter=", ">
        <text text-case="capitalize-first" variable="archive_location"/>
        <text variable="archive_collection"/>
      </group>
      <group delimiter=", ">
        <text variable="archive"/>
        <text variable="archive-place"/>
      </group>
    </group>
  </macro>
  <macro name="source-archive-name-first">
    <!-- Archive (gallery) name first for art (CMOS 14.133) -->
    <group delimiter=", ">
      <text variable="archive"/>
      <text variable="archive-place"/>
      <text variable="archive_collection"/>
      <text variable="archive_location"/>
    </group>
  </macro>
  <!-- 4.10. URL or persistent identifier -->
  <!-- 5. Notes -->
  <macro name="notes">
    <!-- Notes on source element: original publication, reprint info, retraction info -->
    <text variable="references"/>
  </macro>
  <!-- 6. Legal references -->
  <!-- Bluebook style: shared with APA -->
  <macro name="legal-reference">
    <!-- Type usage:

         `bill`
         : bills, resolutions, federal reports

         `legal_case`
         : all legal and court cases

         `hearing`
         : hearings and testimony

         `legislation`
         : statutes, constitutional items, and charters

         `regulation`
         : codified regulations, uncodified regulations, executive orders

         `treaty`
         : treaties
    -->
    <group delimiter=" ">
      <choose>
        <if type="treaty">
          <group delimiter=", " suffix=".">
            <!-- APA generally defers to Bluebook for legal citations,
                 but diverges without explanation for treaty items.
                 We follow the Bluebook format that was used in APA 6th ed. -->
            <!-- APA manual omits treaty parties/authors, but per Bluebook
                 they should be included at least for bilateral treaties. -->
            <text macro="legal-title"/>
            <text macro="legal-author"/>
            <text macro="legal-date"/>
            <!-- APA manual omits treaty source/report called for by Bluebook
                 in favor of just URL. Both are included here, following
                 the APA style used for all other item types to end the
                 reference with a period, then give the URL afterward. -->
            <text macro="legal-source"/>
          </group>
        </if>
        <else>
          <group delimiter=" " suffix=".">
            <group delimiter=", ">
              <text macro="legal-title"/>
              <text macro="legal-source"/>
            </group>
            <text macro="legal-date"/>
            <text macro="legal-identifier"/>
          </group>
        </else>
      </choose>
      <text variable="references"/>
      <!-- <text macro="source-DOI-URL"/> -->
    </group>
  </macro>
  <!-- 6.1. Legal author -->
  <macro name="legal-author">
    <names variable="author">
      <name delimiter="-" form="short"/>
    </names>
  </macro>
  <!-- 6.2. Legal date -->
  <macro name="legal-date">
    <choose>
      <if type="treaty">
        <text macro="date-issued-full"/>
      </if>
      <else-if type="legal_case">
        <text macro="legal-date-case"/>
      </else-if>
      <else-if match="any" type="bill hearing legislation regulation">
        <group delimiter=" " prefix="(" suffix=")">
          <group delimiter=" ">
            <text macro="date-original-year"/>
            <text form="symbol" term="and"/>
          </group>
          <choose>
            <if variable="issued">
              <!-- APA manual includes "rev." before the revision year,
                   but this isn't part of the Bluebook rules. -->
              <text macro="date-issued-year"/>
            </if>
            <else>
              <!-- Show proposal date for uncodified regulations.
                   Assume date is entered literally ala "proposed May 23, 2016".
                   TODO: Add `proposed` date here if that becomes available -->
              <date form="text" variable="submitted"/>
            </else>
          </choose>
        </group>
      </else-if>
    </choose>
  </macro>
  <macro name="legal-date-case">
    <group delimiter=" " prefix="(" suffix=")">
      <text variable="authority"/>
      <choose>
        <if variable="container-title">
          <!-- Print only year for cases published in reporters-->
          <text macro="date-issued-year"/>
        </if>
        <else>
          <!-- APA manual doesn't include examples of cases not yet
               published in a reporter, but this is Bluebook style. -->
          <text macro="date-issued-full"/>
        </else>
      </choose>
    </group>
  </macro>
  <!-- 6.3.1. Legal title -->
  <macro name="legal-title">
    <choose>
      <if match="any" type="bill legal_case legislation regulation treaty">
        <text text-case="title" variable="title"/>
      </if>
      <else-if type="hearing">
        <!-- APA uses a comma delimiter and omits "hearing before the" for hearings with testimony,
             but follows Bluebook rules (colon delimiter, prefix before the committee name) for
             references to the whole hearing. We simply follow the Bluebook rules for both, but
             use APA style capitalization (not capitalizing "Before" or the title of the hearing). -->
        <group delimiter=": " font-style="italic">
          <text text-case="capitalize-first" variable="title"/>
          <group delimiter=" ">
            <text term="hearing" text-case="capitalize-first"/>
            <group delimiter=" ">
              <group delimiter=" ">
                <!-- APA manual omits the bill number, but it should be included per Bluebook if relevant -->
                <text term="on"/>
                <text variable="number"/>
              </group>
              <group delimiter=" ">
                <!-- Use the `at` term to hold "before the" -->
                <text term="at"/>
                <text variable="section"/>
              </group>
            </group>
          </group>
        </group>
      </else-if>
    </choose>
  </macro>
  <!-- 6.3.2. Legal identifier -->
  <macro name="legal-identifier">
    <choose>
      <if type="hearing">
        <group delimiter=" " prefix="(" suffix=")">
          <!-- Use the 'verb' form of the hearing term to hold 'testimony of' -->
          <text form="verb" term="hearing"/>
          <names variable="author">
            <name initialize="false"/>
          </names>
        </group>
      </if>
      <else-if match="any" type="bill legislation regulation">
        <!-- For uncodified regulations, assume future code section is in `status`. -->
        <text prefix="(" suffix=")" variable="status"/>
      </else-if>
    </choose>
  </macro>
  <macro name="legal-identifier-bill-report">
    <group delimiter=" ">
      <text variable="genre"/>
      <choose>
        <!-- If there is no legislative body, session number, or code/record title, assume
               the item is a congressional report and include 'No.' label. -->
        <if match="none" variable="authority chapter-number container-title">
          <!-- The item is a congressional report rather than a bill or resolution. -->
          <text macro="label-number-capitalized"/>
        </if>
        <else>
          <text variable="number"/>
        </else>
      </choose>
    </group>
  </macro>
  <!-- 6.4. Legal source -->
  <macro name="legal-source">
    <!-- Expect legal item `container-title` to be stored in short form -->
    <choose>
      <if type="bill">
        <text macro="legal-source-bill"/>
      </if>
      <else-if type="hearing">
        <text macro="legal-source-hearing"/>
      </else-if>
      <else-if type="legal_case">
        <text macro="legal-source-case"/>
      </else-if>
      <else-if type="legislation">
        <text macro="legal-source-legislation"/>
      </else-if>
      <else-if type="regulation">
        <text macro="legal-source-regulation"/>
      </else-if>
      <else-if type="treaty">
        <text macro="legal-source-treaty"/>
      </else-if>
    </choose>
  </macro>
  <!-- Legal source types -->
  <macro name="legal-source-bill">
    <group delimiter=", ">
      <text macro="legal-identifier-bill-report"/>
      <group delimiter=" ">
        <text variable="authority"/>
        <!-- 'session' is `chapter-number` -->
        <text variable="chapter-number"/>
      </group>
      <group delimiter=" ">
        <text variable="volume"/>
        <text variable="container-title"/>
        <text variable="page-first"/>
      </group>
    </group>
  </macro>
  <macro name="legal-source-case">
    <group delimiter=" ">
      <choose>
        <if variable="container-title">
          <group delimiter=" ">
            <text variable="volume"/>
            <text variable="container-title"/>
            <text macro="label-section-symbol"/>
            <choose>
              <if match="any" variable="page page-first">
                <text variable="page-first"/>
              </if>
              <else>
                <text value="___"/>
              </else>
            </choose>
          </group>
        </if>
        <else>
          <text macro="label-number-capitalized"/>
        </else>
      </choose>
    </group>
  </macro>
  <macro name="legal-source-hearing">
    <group delimiter=" ">
      <text variable="authority"/>
      <!-- 'session' is `chapter-number` -->
      <text variable="chapter-number"/>
    </group>
  </macro>
  <macro name="legal-source-legislation">
    <choose>
      <if variable="number">
        <!-- There's a public law number. -->
        <group delimiter=", ">
          <group delimiter=" ">
            <choose>
              <if variable="genre">
                <text text-case="capitalize-first" variable="genre"/>
              </if>
              <else>
                <text form="short" term="legislation" text-case="capitalize-first"/>
              </else>
            </choose>
            <text macro="label-number-capitalized"/>
          </group>
          <group delimiter=" ">
            <text variable="volume"/>
            <text variable="container-title"/>
            <text variable="page-first"/>
          </group>
        </group>
      </if>
      <else>
        <group delimiter=" ">
          <text variable="volume"/>
          <text variable="container-title"/>
          <choose>
            <if variable="section">
              <text macro="label-section-symbol"/>
            </if>
            <else>
              <text variable="page-first"/>
            </else>
          </choose>
        </group>
      </else>
    </choose>
  </macro>
  <macro name="legal-source-regulation">
    <group delimiter=", ">
      <group delimiter=" ">
        <text variable="genre"/>
        <text macro="label-number-capitalized"/>
      </group>
      <group delimiter=" ">
        <text variable="volume"/>
        <text variable="container-title"/>
        <choose>
          <if variable="section">
            <text macro="label-section-symbol"/>
          </if>
          <else>
            <text variable="page-first"/>
          </else>
        </choose>
      </group>
    </group>
  </macro>
  <macro name="legal-source-treaty">
    <group delimiter=" ">
      <number variable="volume"/>
      <text variable="container-title"/>
      <choose>
        <if match="any" variable="page page-first">
          <text variable="page-first"/>
        </if>
        <else>
          <text macro="label-number-capitalized"/>
        </else>
      </choose>
    </group>
  </macro>
  <!-- Citation -->
  <macro name="citation-notes-shortened-author-title">
    <choose>
      <if match="any" type="classic legal_case">
        <group delimiter=" ">
          <group delimiter=", ">
            <text macro="author-short"/>
            <text macro="title-and-descriptions-short"/>
          </group>
          <text macro="source-locator"/>
        </group>
      </if>
      <else>
        <group delimiter=", ">
          <text macro="author-short"/>
          <text macro="title-and-descriptions-short"/>
          <text macro="source-locator"/>
        </group>
      </else>
    </choose>
  </macro>
  <citation disambiguate-add-names="true" et-al-min="3" et-al-use-first="1">
    <layout delimiter="; " suffix=".">
      <text macro="citation-notes-shortened-author-title"/>
    </layout>
  </citation>
  <!-- Bibliography -->
  <macro name="bibliography-notes">
    <choose>
      <if match="any" type="bill hearing legal_case legislation regulation treaty">
        <!-- Legal items have different orders and delimiters -->
        <text macro="legal-reference"/>
      </if>
      <else>
        <group delimiter=". ">
          <text macro="author-bib"/>
          <text macro="title-and-source-bib"/>
          <text macro="notes"/>
        </group>
      </else>
    </choose>
  </macro>
  <macro name="bibliography-filtered-notes">
    <choose>
      <if type="classic">
        <choose>
          <if match="any" variable="archive editor translator publisher">
            <text macro="bibliography-notes"/>
          </if>
        </choose>
      </if>
      <else-if match="any" type="entry entry-dictionary entry-encyclopedia">
        <choose>
          <if variable="author">
            <!-- Signed reference entries appear in the bibliography (CMOS 14.132) -->
            <text macro="bibliography-notes"/>
          </if>
          <else-if match="any" variable="DOI URL">
            <!-- Provide a bibliography if necessary identifying information is not in text -->
            <text macro="bibliography-notes"/>
          </else-if>
        </choose>
      </else-if>
      <else-if match="any" type="interview personal_communication">
        <!-- CMOS 14.13, 14.111: Personal communications only appear in the bibliography if the reader can retrieve them -->
        <choose>
          <if match="any" variable="archive archive-place container-title DOI number publisher references URL">
            <text macro="bibliography-notes"/>
          </if>
        </choose>
      </else-if>
      <else-if match="any" type="document manuscript paper-conference">
        <!-- In note styles, the bibliography also omits inaccessible manuscripts (CMOS 14.114), conference papers (CMOS 14.115), and private documents (CMOS 14.118) -->
        <choose>
          <if match="any" variable="archive archive-place container-title DOI number publisher references URL">
            <text macro="bibliography-notes"/>
          </if>
        </choose>
      </else-if>
      <else>
        <text macro="bibliography-notes"/>
      </else>
    </choose>
  </macro>
  <bibliography et-al-min="7" et-al-use-first="3" hanging-indent="true" subsequent-author-substitute="&#8212;&#8212;&#8212;">
    <sort>
      <key macro="author-sort"/>
      <key macro="title-bib"/>
      <key macro="date-sort-group"/>
      <key macro="date-sort"/>
      <key variable="status"/>
    </sort>
    <layout suffix=".">
      <text macro="bibliography-filtered-notes"/>
    </layout>
  </bibliography>
</style>
