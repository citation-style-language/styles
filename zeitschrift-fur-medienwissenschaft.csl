<?xml version="1.0" encoding="utf-8"?>
<style xmlns="http://purl.org/net/xbiblio/csl" version="1.0" class="note" default-locale="de-DE" demote-non-dropping-particle="sort-only">
  <info>
    <title>Zeitschrift für Medienwissenschaft (German)</title>
    <title-short>zfm</title-short>
    <id>http://www.tillheilmann.info/code/zeitschrift-fur-medienwissenschaft</id>
    <link href="http://zfmedienwissenschaft.de/service/submission-guidelines" rel="documentation"/>
    <link href="http://www.tillheilmann.info/code/referenz-geisteswissenschaften-heilmann.csl" rel="template"/>
    <author>
      <name>Till A. Heilmann</name>
      <email>mail@tillheilmann.info</email>
      <uri>http://www.tillheilmann.info</uri>
    </author>
    <category citation-format="note"/>
    <category field="humanities"/>
    <issn>1869-1722</issn>
    <summary>Style for Zeitschrift für Medienwissenschaft (zfm). Citations in notes; bibliography optional. See comments in code for further details.</summary>
    <updated>2018-03-06T10:51:31+01:00</updated>
    <rights license="http://creativecommons.org/licenses/by-sa/3.0/">This work is licensed under a Creative Commons Attribution-ShareAlike 3.0 License</rights>
  </info>
  <!--

/////////////////////////////////////////////////////////////////////
ABOUT ZEITSCHRIFT-FUR-MEDIENWISSENSCHAFT.CSL
/////////////////////////////////////////////////////////////////////

zeitschrift-fur-medienwissenschaft.csl may be used for the German
journal Zeitschrift für Medienwissenschaft (zfm). For the journal's
official style guide see http://www.zfmedienwissenschaft.de.

The style is adapted from referenz-geisteswissenschaften-heilmann.csl.
It has some special features as well as certain limitations imposed by
the CSL specification and the respective applications (like Zotero)
and CSL processors (like citeproc-js).

Please note the following remarks (some concerning only the use of the
style with Zotero 5.x):

STYLE-SPECIFIC REMARKS
**********************

- The style can be used to generate bibliographies (mostly to check
for completeness and consistency), although the Zeitschrift für
Medienwissenschaft does _not_ use bibliographies!

- To get the shorthand "ders." in 'Buchteil' / 'chapter' with
identical 'Autor' / 'author' and 'Buchautor' / 'container-author', the
shorthand itself (instead of the name) must be put into the field
'Buchautor' manually.

- Short titles for recurring 'Buchtitel' / 'container-title' of edited
volumes must be corrected manually in the output (the style will
always produce the full container title in every full reference).

- To get the right 'Buchtitel' / 'container-title' in recurring
references of author’s collected volumes using 'Buchteil' / 'chapter'
(like Freud: Gesammelte Werke or Heidegger: Gesamtausgabe), either
correct the output manually _or_ set 'version' (through Zotero’s
'Extra' field) to any value, e.g. "zfm-Sammelwerk", like this:

{:version: zfm-Sammelwerk}

- Info on catalogues using 'Buch' / 'book' must be set through
Zotero’s 'Extra' field like this:

{:genre: Ausst.-Kat. Akademie der Künste Berlin}

- In Zotero, the country for 'Film' / 'motion_picture' must be set
through Zotero’s 'Extra' field like this:

{:publisher-place: USA}

- Foreign language abbreviations for volume, issue etc. must be
corrected manually in the output (the style will always produce the
German abbreviations "Bd." for 'volume' and "Nr." for 'issue').

- Prefixes for 'Nummer der Reihe' / 'collection-number' such as "Bd.",
"Vol.", "Nr." etc. must be put manually into field 'Nummer der Reihe'
like this:

Bd. 7

- In Zotero, 'Ort' / 'publisher-place' for types
'Zeitschriftenartikel' / 'article-journal' and 'Magazin-Artikel' /
'article-magazine' must be set through Zotero’s 'Extra' field like
this:

{:publisher-place: Drexel Hill, Pennsylvania}

- Dates without day (only month and year) for 'Magazin-Artikel' /
'article-magazine' have to be corrected manually.

- The style tries hard to get the prefixes "dort datiert" for dates
and "online unter" for URls right. They will have to be corrected
manually in some instances, though.

GENERAL REMARKS
***************

- The style supports using variables for which there are no distinct
fields of entry in Zotero (see comments below). These variables can be
set through Zotero’s 'Extra' field like this:

{:event-place: Abbey Road Studios}
{:reviewed-author: Kafka || Franz}
{:original-date: 1899}

- All types can have 'original-date'.

- Dates can be given in Extended Date/Time Format 1.0 (EDTF) like
this:

{:issued: 1503/1506}
{:issued: -27500~}
{:event-date: 1975-04-11/1975-04-13}

CAVEAT: Support for EDTF in Zotero 5.x is flaky and output will
likely be wrong!

- Entries in the bibliography are sorted by type (in descending order)
for

* 'computerProgram' :: 'book',
* 'map',
* 'audioRecording' :: 'song',
* 'radioBroadcast', 'tvBroadcast' :: 'broadcast',
* 'film', 'videoRecording' :: 'motion_picture',
* 'artwork' :: 'graphic' and
* everything else (see macro 'bib-sort-types').

The bibliography has to be split manually at the right places, after
which subheadings can be added.

CAVEAT: In Zotero, entries of type 'computerProgram' :: 'book'
_without_ 'version' will not get properly recognized and be sorted
first with "regular" entries!

- The sort order of main authors, editors etc. and titles in the
bibliography (see macros 'main-contributors-bib', 'main-title-long'
and 'main-contributors-title-bib-sort') can get confused, especially
by entries of type 'email', 'instantMessage', 'letter' ::
'personal_communication' and by entries with 'reviewed-author' but
_without_ 'title' or 'reviewed-title'.

- Whenever _both_ 'event-place' and 'publisher-place' can be given,
'publisher-place' _must_ be set through Zotero’s 'Extra' field like
this:

{:publisher-place: München}

This is because Zotero’s field of entry for "Place" is mapped to
both 'publisher-place' _and_ 'event-place'.

- Detection of language as Not-English (through default-locale="de-DE"
in header of style file) does not work for 'original-title' and
'reviewed-title'. Therefore, output for these variables will be
formatted according to text-case="title".

- Formatting of output for variable 'reviewed-title' has to be checked
(because "type" of 'reviewed-title' can not be given).

TYPE-SPECIFIC REMARKS
*********************

- 'Anhörung' / 'hearing' is distinguished from 'Gesetentwurf' / 'bill'
(both :: 'bill') by _not_ using 'genre'.

- 'Bericht' / 'report' can have 'genre' or 'collection-title' as main
title (in the latter case 'collection-editor' is main contributor).

- 'Blog-Post' / 'blogPost' can have 'publisher' (for publisher of
blog). Main title can also be 'container-title'.

- 'Buch' / 'book' can have 'genre' (for type of publication, e.g.
"Ausstellungskatalog"). Main title can also be 'collection-title' with
'collection-number' (in which case 'collection-editor' is main
contributor).

- 'Brief' / 'letter' can have 'event-place' and 'genre' (for place of
sender and type of communication).

- 'Dissertation' / 'thesis' can also have 'genre' as main title.

- 'E-Mail' can have 'genre' (to indicate that entry is a "Mail"). For
emails with an empty subject line (i.e. 'title') set 'number' to any
value to get the text "[ohne Betreff]" instead of no title.

- 'Fall' / 'case' :: 'legal_case' distinguishes between entries with
and without 'authority' and 'issued': Entries with 'authority' and
'issued' can have 'genre' (for identifying the type of case, e.g.
"Urt.") to which 'issued' is then appended with prefix "v." meaning
"vom" resulting in something like "BVerwG, Urt. v. 09.11.1984"). Cases
never use 'title' but either 'authority' (e.g. "VGH München") or
'container-title' (e.g. "BVerwGE"); 'title-short' is used as keyword
at the end of entry.

- 'Fernsehsendung' / 'tvBroadcast' can have 'genre'. 'container-title'
will be main title if present.

- 'Film' is distinguished from 'Videoaufnahme' (both ::
'motion_picture') by using neither 'collection-title' nor 'version'.
'original-title' will be main title if present.

- 'Gesetz' / 'statute' :: 'legislation' can have 'title',
'title-short' or 'container-title' as main title. When 'title' is
present 'title-short' is put in parentheses after 'title'. Publication
year of code has to be given in field 'Codenummer' / 'volume' (e.g.
"2009 II Nr. 25" for 'container-title' "Bundesgesetzblatt").

- 'Gesetzentwurf' / 'bill' is distinguished from 'Anhörung' /
'hearing' (both :: 'bill') by using 'genre' which is used for
identifying the type of bill (e.g. "BT-Drucksache") at the beginning
of the citation. If 'Sponsor' :: 'author' is present, then the text
"Gesetzentwurf" will be prepended to it (accordingly, 'Sponsor' should
be given with the correct article, e.g. "der Bundesregierung").

- 'Instant-Message' can have 'genre' and 'publisher' (for type and
provider of service, e.g. "Twitter").

- 'Interview' can have 'event-place' and 'dimension' (for place and
length of interview). If there is no 'interviewer' then the text "
(Interview)" will be appended to main authors, i.e. to interviewed
persons.

- 'Karte' / 'map' distinguishes between entries with and without
'page': Maps with 'page' are part of an atlas (= 'collection-title'),
those without are single maps. Maps can have 'volume',
'number-of-volumes', 'medium' and 'source' (for sheet, number of
sheets, additional info and provider of digital maps). 'issued' can be
given as dd.mm.yyyy. Main title for maps with 'page' can also be
'collection-title' (in which case 'collection-editor' is main
contributor).

- 'Konferenz-Paper' / 'conferencePaper' can have 'event-date' and
'event-place'.

- 'Kunstwerk' / 'artwork' can have 'event-date' and 'event-place' (for
date and place of a piece of performance art, for example).

- 'Patent' can have 'original-date' (for priority date; 'Datum der
Einreichung' / 'submitted' is date of filing or Anmeldedatum,
'Erscheinungsdatum' / 'issued' is date of publication or
Erscheinungsdatum).

- 'Podcast' is distinguished from 'Tonaufnahme' / 'audioRecording'
(both :: 'song') by using 'number' (if no output from 'number' is
wanted, set it to some non-numeric value like "X" and it will not be
displayed). Podcasts can have 'issued', 'genre', 'publisher' and
'publisher-place' (for date, type, publisher and place of podcast).
Main title can also be 'collection-title'.

- 'Radiosendung' / 'radioBroadcast' can have 'genre'.
'container-title' will be main title if present.

- 'Tonaufnahme' / 'audioRecording' is distinguished from 'Podcast' /
'podcast' (both :: 'song') by not using 'number'. Audio recordings can
have 'genre', 'event-date' and 'event-place' (for type, date and place
of recording, e.g. "Abbey Road Studios"). 'Composer' is main
contributor if present. Main title can also be 'collection-title'.

- 'Videoaufnahme' is distinguished from 'Film' (both ::
'motion_picture') by either using 'collection-title' or setting
'version' to some value (which will not be displayed). Correct prefix
of 'volume' and 'number-of-volumes' (e.g. "Band") must be added
explicitly. 'original-title' is main title if present. Main title can
also be 'collection-title'.

- 'Vortrag' / 'presentation' can have 'event-place'. Main title can
also be 'event' or 'genre'.

- 'Zeitungsartikel' / 'newspaperArticle' can have 'issue'. Zotero
field of entry for edition is not for 'Auflage' but for 'Ausgabe'
(e.g. "Abendausgabe").

BUGS
****

- Certain macros produce output even when they should not (because all
elements called are empty). One example of this behavior is the macro
that constructs the secondary contributors and title with the 'in'
term at the beginning in the <citation> and <bibliography> section.
If, for example, output for a 'chapter' _without_ 'container-title'
and 'container-author' or 'editor' is constructed, the 'in' term still
shows up. (Note: This is not considered a bug but expected behavior by
citeproc-js, see https://github.com/Juris-M/citeproc-js/issues/56)

  -->

  <locale xml:lang="de">
    <terms>
      <term name="accessed">gesehen am</term>
      <term name="collection-editor" form="short">
        <single>Hg.</single>
        <multiple>Hg.</multiple>
      </term>
      <term name="collection-editor" form="verb-short">hg.&#160;v.</term>
      <term name="director" form="verb">Regie</term>
      <term name="editor" form="short">
        <single>Hg.</single>
        <multiple>Hg.</multiple>
      </term>
      <term name="editor" form="verb-short">
        <single>hg.&#160;v.</single>
        <multiple>hg.&#160;v.</multiple>
      </term>
      <term name="editorial-director" form="verb-short">hg.&#160;v.</term>
      <term name="editortranslator" form="short">
	<single>Hg.&#160;u. Übers.</single>
	<multiple>Hg.&#160;u. Übers.</multiple>
      </term>
      <term name="editortranslator" form="verb-short">hg.&#160;u. übers. v.</term>
      <term name="et-al">u.&#160;a.</term>
      <term name="ibid">ebd.</term>
      <term name="illustrator" form="verb-short">illus.&#160;v.</term>
      <term name="translator" form="short">
        <single>Übers.</single>
        <multiple>Übers.</multiple>
      </term>
      <term name="translator" form="verb-short">
        <single>übers.&#160;v.</single>
        <multiple>übers.&#160;v.</multiple>
      </term>
    </terms>
    <date form="numeric" delimiter=".">
      <date-part name="day" form="numeric"/>
      <date-part name="month" form="numeric" />
      <date-part name="year"/>
    </date>
  </locale>

  <!-- This macro generates the name(s) of the main contributors in
       long form to be used in the (first) citation of the entry. -->
  <macro name="main-contributors-cite-long">
    <choose>
      <if type="bill broadcast legal_case motion_picture song" match="none">
	<choose>
	  <if variable="author">
	    <group delimiter=", ">
	      <group delimiter=" ">
		<names variable="author"/>
		<choose>
		  <if type="personal_communication">
		    <choose>
		      <if variable="genre" match="none">
			<names variable="recipient">
			  <label form="verb" text-case="lowercase" suffix=" "/>
			  <name/>
			</names>
		      </if>
		    </choose>
		  </if>
		</choose>
	      </group>
	      <names variable="interviewer">
	      	<label form="verb" suffix=" "/>
		<name/>
              </names>
	    </group>
	  </if>
	  <else-if type="book">
	    <choose>
	      <if variable="title editor" match="none">
		<names variable="collection-editor">
		  <name/>
		  <label prefix=" (" form="short" suffix=".)"/>
		</names>
	      </if>
	      <else-if variable="editor">
		<names variable="editor">
		  <name/>
	      	  <label prefix=" (" form="short" suffix=".)"/>
	      	</names>
	      </else-if>
	    </choose>
	  </else-if>
	  <else-if type="map">
	    <choose>
	      <if variable="collection-title page" match="none">
		<names variable="collection-editor">
		  <name/>
	  	  <label prefix=" (" form="short" suffix=".)"/>
	  	</names>
	      </if>
	    </choose>
	  </else-if>
	  <else-if type="report">
	    <choose>
	      <if variable="title genre" match="any">
		<group delimiter=" ">
		  <text variable="publisher"/>
		  <text prefix="(" term="editor" form="short" suffix=")"/>
		</group>
	      </if>
	      <else-if variable="collection-editor">
		<names variable="collection-editor">
		  <name/>
		  <label prefix=" (" form="short" suffix=".)"/>
		</names>
	      </else-if>
	    </choose>
	  </else-if>
	</choose>
      </if>
      <else-if type="bill">
	<choose>
	  <if variable="genre" match="none">
	    <!-- We treat [bill] without [genre] as a Zotero "hearing"/"Anhörung" -->
	    <names variable="author"/>
	  </if>
	</choose>
      </else-if>
      <else-if type="legal_case">
	<text variable="authority"/>
      </else-if>
      <else-if type="song">
	<choose>
	  <if variable="composer">
	    <names variable="composer"/>
	  </if>
	  <else-if variable="author">
	    <names variable="author"/>
	  </else-if>
	</choose>
      </else-if>
    </choose>
    <choose>
      <if type="interview">
	<choose>
	  <if variable="interviewer" match="none">
	    <text value=" (Interview)"/>
	  </if>
	</choose>
      </if>
    </choose>
  </macro>

  <!-- This macro generates the name(s) of the main contributors in
       long form to be used in the bibliography, i.e. with surname
       coming first. -->
  <macro name="main-contributors-bib">
    <choose>
      <if type="bill broadcast legal_case motion_picture song" match="none">
	<choose>
	  <if variable="author">
	    <group delimiter=", ">
	      <group delimiter=" ">
		<names variable="author">
		  <!-- We have to set the "name-as-sort-order"
		       attribute for this and the other names in this
		       macro _here_ (and not globally in the
		       <bibliography> element) because the names of
		       [recipient] and [interviewer] should _not_ be
		       in sort-order, and we cannot override a global
		       "name-as-sort-order" setting for these names
		       here! -->
		  <name name-as-sort-order="first"/>
		</names>
		<choose>
		  <if type="personal_communication">
		    <choose>
		      <if variable="genre" match="none">
			<names variable="recipient">
			  <label form="verb" text-case="lowercase" suffix=" "/>
			  <name/>
			</names>
		      </if>
		    </choose>
		  </if>
		</choose>
	      </group>
	      <names variable="interviewer">
	      	<label form="verb" suffix=" "/>
		<name/>
              </names>
	    </group>
	  </if>
	  <else-if type="book">
	    <choose>
	      <if variable="title editor" match="none">
		<names variable="collection-editor">
		  <name name-as-sort-order="first"/>
		  <label prefix=" (" form="short" suffix=".)"/>
		</names>
	      </if>
	      <else-if variable="editor">
		<names variable="editor">
		  <name name-as-sort-order="first"/>
	      	  <label prefix=" (" form="short" suffix=".)"/>
	      	</names>
	      </else-if>
	    </choose>
	  </else-if>
	  <else-if type="map">
	    <choose>
	      <if variable="collection-title page" match="none">
		<names variable="collection-editor">
		  <name name-as-sort-order="first"/>
	  	  <label prefix=" (" form="short" suffix=".)"/>
	  	</names>
	      </if>
	    </choose>
	  </else-if>
	  <else-if type="report">
	    <choose>
	      <if variable="title genre" match="any">
		<group delimiter=" ">
		  <text variable="publisher"/>
		  <text prefix="(" term="editor" form="short" suffix=")"/>
		</group>
	      </if>
	      <else-if variable="collection-editor">
		<names variable="collection-editor">
		  <name name-as-sort-order="first"/>
		  <label prefix=" (" form="short" suffix=".)"/>
		</names>
	      </else-if>
	    </choose>
	  </else-if>
	</choose>
      </if>
      <else-if type="bill">
	<choose>
	  <if variable="genre" match="none">
	    <!-- We treat [bill] without [genre] as a Zotero
	         "hearing"/"Anhörung" -->
	    <names variable="author">
	      <name name-as-sort-order="first"/>
	    </names>
	  </if>
	</choose>
      </else-if>
      <else-if type="legal_case">
	<text variable="authority"/>
      </else-if>
      <else-if type="song">
	<choose>
	  <if variable="composer">
	    <names variable="composer">
	      <name name-as-sort-order="first"/>
	    </names>
	  </if>
	  <else-if variable="author">
	    <names variable="author">
	      <name name-as-sort-order="first"/>
	    </names>
	  </else-if>
	</choose>
      </else-if>
    </choose>
    <choose>
      <if type="interview">
	<choose>
	  <if variable="interviewer" match="none">
	    <text value=" (Interview)"/>
	  </if>
	</choose>
      </if>
    </choose>
  </macro>

  <!-- This macro generates the name(s) of the main contributors in
       short form to be used in subsequent citations of the entry. -->
  <macro name="main-contributors-cite-short">
    <choose>
      <if type="bill broadcast legal_case motion_picture song" match="none">
	<choose>
	  <if variable="author">
	    <group delimiter=", ">
	      <group delimiter=" ">
		<names variable="author">
		  <name form="short"/>
		</names>
		<choose>
		  <if type="personal_communication">
		    <choose>
		      <if variable="genre" match="none">
		    	<names variable="recipient">
		    	  <label form="verb" text-case="lowercase" suffix=" "/>
		    	  <name form="short"/>
		    	</names>
		      </if>
		    </choose>
		  </if>
		</choose>
	      </group>
	      <names variable="interviewer">
	      	<label form="verb" suffix=" "/>
		<name form="short"/>
              </names>
	    </group>
	  </if>
	  <else-if type="book">
	    <choose>
	      <if variable="title editor" match="none">
		<names variable="collection-editor">
		  <name form="short"/>
		  <label prefix=" (" form="short" suffix=".)"/>
		</names>
	      </if>
	      <else-if variable="editor">
		<names variable="editor">
		  <name form="short"/>
	      	  <label prefix=" (" form="short" suffix=".)"/>
	      	</names>
	      </else-if>
	    </choose>
	  </else-if>
	  <else-if type="map">
	    <choose>
	      <if variable="collection-title page" match="none">
		<names variable="collection-editor">
		  <name form="short"/>
	  	  <label prefix=" (" form="short" suffix=".)"/>
	  	</names>
	      </if>
	    </choose>
	  </else-if>
	  <else-if type="report">
	    <choose>
	      <if variable="title genre" match="any">
		<group delimiter=" ">
		  <text variable="publisher"/>
		  <text prefix="(" term="editor" form="short" suffix=")"/>
		</group>
	      </if>
	      <else-if variable="collection-editor">
		<names variable="collection-editor">
		  <name form="short"/>
		  <label prefix=" (" form="short" suffix=".)"/>
		</names>
	      </else-if>
	    </choose>
	  </else-if>
	</choose>
      </if>
      <else-if type="bill">
	<choose>
	  <if variable="genre" match="none">
	    <!-- We treat [bill] without [genre] as a Zotero "hearing"/"Anhörung". -->
	    <names variable="author">
	      <name form="short"/>
	    </names>
	  </if>
	</choose>
      </else-if>
      <else-if type="legal_case">
	<text variable="authority"/>
      </else-if>
      <else-if type="song">
	<choose>
	  <if variable="composer">
	    <names variable="composer">
	      <name form="short"/>
	    </names>
	  </if>
	  <else-if variable="author">
	    <names variable="author">
	      <name form="short"/>
	    </names>
	  </else-if>
	</choose>
      </else-if>
    </choose>
    <choose>
      <if type="personal_communication">
	<choose>
	  <if variable="title title-short" match="none">
	    <text prefix=", " variable="genre"/>
	  </if>
	</choose>
	<choose>
	  <if variable="genre">
	    <names prefix=" " variable="recipient">
	      <label form="verb" text-case="lowercase" suffix=" "/>
	      <name form="short"/>
	    </names>
	  </if>
	</choose>
      </if>
    </choose>
  </macro>

  <!-- This macro generates the name(s) of additional main
       contributors to be displayed _after_ the main title. -->
  <macro name="additional-main-contributors">
    <choose>
      <if type="article-journal article-magazine article-newspaper chapter entry-dictionary entry-encyclopedia interview paper-conference" match="any">
        <names prefix=", " variable="translator">
          <label form="verb-short" text-case="lowercase" suffix=" "/>
          <name/>
        </names>
      </if>
      <else-if type="book manuscript report" match="any">
	<choose>
	  <if variable="author">
            <names prefix=", " variable="editor translator" delimiter=", ">
              <label form="verb-short" text-case="lowercase" suffix=" "/>
              <name/>
            </names>
	  </if>
	  <else>
            <names prefix=", " variable="translator" delimiter=", ">
              <label form="verb-short" text-case="lowercase" suffix=" "/>
              <name/>
            </names>
	  </else>
	</choose>
      </else-if>
      <else-if type="broadcast">
	<choose>
	  <if variable="title">
	    <choose>
	      <if variable="container-title container-title-short" match="none">
		<group prefix=", " delimiter=": ">
		  <text term="director" form="verb"/>
		  <names variable="author">
		    <name/>
		  </names>
		</group>
	      </if>
	    </choose>
	  </if>
	  <else-if variable="container-title container-title-short" match="any">
	    <group prefix=", " delimiter=": ">
	      <text term="director" form="verb"/>
	      <names variable="author">
		<name/>
	      </names>
	    </group>
	  </else-if>
	</choose>
      </else-if>
      <else-if type="motion_picture">
	<group prefix=", " delimiter=": ">
	  <text term="director" form="verb"/>
          <names variable="author">
	    <name/>
          </names>
	</group>
      </else-if>
      <else-if type="personal_communication" variable="genre" match="all">
	<names prefix=" " variable="recipient">
	  <label form="verb" text-case="lowercase" suffix=" "/>
	  <name/>
	</names>
      </else-if>
      <else-if type="song" variable="composer" match="all">
        <names prefix=", " variable="author">
          <name/>
        </names>
      </else-if>
    </choose>
  </macro>

  <!-- This macro generates the name(s) of the secondary contributors,
       i.e. contributors of the secondary title (the "container" or
       "collection"). -->
  <macro name="secondary-contributors">
    <choose>
      <if variable="container-author">
        <names variable="container-author">
	  <name/>
        </names>
      </if>
      <else-if type="chapter" >
        <names variable="editor">
          <name/>
          <label prefix=" (" form="short" suffix=".)"/>
        </names>
      </else-if>
      <else-if type="map" variable="page" match="all">
	<names variable="collection-editor">
	  <name/>
	  <label prefix=" (" form="short" suffix=".)"/>
	</names>
      </else-if>
    </choose>
  </macro>

  <!-- This macro generates the name(s) of additional secondary
       contributors to be displayed _after_ the secondary title. -->
  <macro name="additional-secondary-contributors">
    <choose>
      <if type="article-journal" variable="editor" match="all">
        <names variable="editor">
          <label form="verb-short" text-case="lowercase" suffix=" "/>
          <name/>
        </names>
      </if>
      <else-if type="broadcast">
	<choose>
	  <if variable="container-title container-title-short" match="any">
	    <group delimiter=": ">
	      <text term="director" form="verb"/>
	      <names variable="author">
		<name/>
	      </names>
	    </group>
	  </if>
	</choose>
      </else-if>
      <else-if type="chapter" variable="container-author" match="all">
        <names variable="editor">
          <label form="verb-short" text-case="lowercase" suffix=" "/>
          <name/>
        </names>
      </else-if>
      <else-if type="entry-dictionary entry-encyclopedia paper-conference" match="any">
        <names variable="editor">
          <label form="verb-short" text-case="lowercase" suffix=" "/>
          <name/>
        </names>
      </else-if>
    </choose>
  </macro>

  <!-- This macro generates the name(s) of the tertiary contributors,
       i.e. contributors of the tertiary title (the "collection"). -->
  <macro name="tertiary-contributors">
    <choose>
      <if type="book">
	<choose>
	  <if variable="author editor title" match="any">
	    <names variable="collection-editor">
	      <label form="verb-short" text-case="lowercase" suffix=" "/>
	      <name/>
	    </names>
	  </if>
	</choose>
      </if>
      <else-if type="map" variable="collection-title" match="all">
	<!-- This is necessary because if there is no
	     [collection-title], [collection-editor] was already used
	     in (main-contributor-*).
	-->
	<choose>
	  <if variable="page" match="none">
	    <!-- [map] is treated as a single map, not as one of
		 many contained in an atlas... -->
	    <choose>
	      <if variable="title title-short" match="any">
		<!-- ...so we only use [collection-editor] for the
		     [collection-title] if that was not already
		     used in (main-title-*). -->
		<names variable="collection-editor">
		  <label form="verb-short" text-case="lowercase" suffix=" "/>
		  <name/>
		</names>
	      </if>
	    </choose>
	  </if>
	</choose>
      </else-if>
      <else-if type="report">
	<choose>
	  <if variable="title genre" match="any">
	    <names variable="collection-editor">
	      <label form="verb-short" text-case="lowercase" suffix=" "/>
	      <name/>
	    </names>
	  </if>
	</choose>
      </else-if>
      <else>
	<names variable="collection-editor">
	  <label form="verb-short" text-case="lowercase" suffix=" "/>
	  <name/>
	</names>
      </else>
    </choose>
  </macro>

  <!-- This macro generates the main title in long form to be used in
       the (first) citation of the entry and in the bibliography.-->
  <macro name="main-title-long">
    <choose>
      <if type="article-journal article-magazine article-newspaper" match="any">
	<choose>
	  <if variable="title">
            <text variable="title" text-case="title"/>
	  </if>
	  <else-if variable="title-short">
            <text variable="title-short" text-case="title"/>
	  </else-if>
	  <else-if variable="reviewed-author reviewed-title" match="none">
  	    <text value="o.&#160;T."/>
	  </else-if>
	</choose>
      </if>
      <else-if type="bill" variable="genre" match="all">
	<!-- We treat [bill] with [genre] as a Zotero "bill"/"Gesetzentwurf" -->
	<group delimiter=": ">
	  <group delimiter=", ">
	    <group delimiter=" ">
	      <text variable="genre"/>
	      <text macro="number"/>
	    </group>
	    <group delimiter=" ">
	      <text value="Gesetzentwurf"/>
	      <names variable="author">
		<name/>
	      </names>
	    </group>
	  </group>
	  <choose>
	    <if variable="title">
	      <text variable="title" text-case="title"/>
	    </if>
	    <else-if variable="title-short">
	      <text variable="title-short" text-case="title"/>
	    </else-if>
	  </choose>
	</group>
      </else-if>
      <else-if type="bill">
	<!-- We treat [bill] without [genre] as a Zotero "hearing"/"Anhörung" -->
	<text variable="title" text-case="title"/>
      </else-if>
      <else-if type="book">
	<choose>
	  <if variable="title">
            <text variable="title" font-style="italic" text-case="title"/>
	  </if>
	  <else-if variable="title-short">
            <text variable="title-short" font-style="italic" text-case="title"/>
	  </else-if>
	  <else-if variable="author editor" match="none">
	    <choose>
	      <if variable="collection-title" is-numeric="collection-number" match="all">
		<group delimiter="&#160;">
		  <text variable="collection-title" font-style="italic" text-case="title"/>
		  <text variable="collection-number" font-style="italic"/>
		</group>
	      </if>
	      <else-if variable="collection-title">
		<group delimiter=", " >
		  <text variable="collection-title" font-style="italic" text-case="title"/>
		  <text variable="collection-number" font-style="italic"/>
		</group>
	      </else-if>
	      <else>
  		<text value="o.&#160;T."/>
	      </else>
	    </choose>
	  </else-if>
	  <else>
  	    <text value="o.&#160;T."/>
	  </else>
	</choose>
      </else-if>
      <else-if type="broadcast" variable="container-title" match="all">
  	<text variable="container-title" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="broadcast" variable="container-title-short" match="all">
  	<text variable="container-title-short" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="broadcast" variable="title" match="all">
  	<text variable="title" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="broadcast" variable="title-short" match="all">
        <text variable="title-short" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="broadcast" >
  	<text value="o.&#160;T."/>
      </else-if>
      <else-if type="chapter entry-dictionary entry-encyclopedia paper-conference" match="any">
	<choose>
	  <if variable="title">
            <text variable="title" text-case="title"/>
	  </if>
	  <else-if variable="title-short">
            <text variable="title-short" text-case="title"/>
	  </else-if>
	  <else>
  	    <text value="o.&#160;T."/>
	  </else>
	</choose>
      </else-if>
      <else-if type="graphic" variable="title" match="all">
        <text variable="title" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="graphic" variable="title-short" match="all">
        <text variable="title-short" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="graphic">
  	<text value="o.&#160;T."/>
      </else-if>
      <else-if type="interview" variable="title" match="all">
	<text variable="title" text-case="title"/>
      </else-if>
      <else-if type="interview" variable="title-short" match="all">
        <text variable="title-short" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="legal_case" variable="authority" match="all">
	<group delimiter=" v. ">
	  <text variable="genre"/>
	  <text macro="main-date"/>
	</group>
      </else-if>
      <else-if type="legal_case" variable="container-title" match="all">
	<text variable="container-title" text-case="title"/>
      </else-if>
      <else-if type="legal_case" variable="container-title-short" match="all">
	<text variable="container-title-short" text-case="title"/>
      </else-if>
      <else-if type="legislation" variable="title" match="all">
	<text variable="title" text-case="title"/>
      </else-if>
      <else-if type="legislation" variable="title-short" match="all">
	<text variable="title" text-case="title" form="short"/>
      </else-if>
      <else-if type="legislation" variable="container-title" match="all">
	<text variable="container-title" text-case="title"/>
      </else-if>
      <else-if type="legislation" variable="container-title-short" match="all">
	<text variable="container-title-short" text-case="title"/>
      </else-if>
      <else-if type="manuscript" variable="title" match="all">
        <text variable="title" text-case="title"/>
      </else-if>
      <else-if type="manuscript" variable="title-short" match="all">
        <text variable="title-short" text-case="title"/>
      </else-if>
      <else-if type="manuscript">
  	<text value="o.&#160;T."/>
      </else-if>
      <else-if type="map" variable="page title" match="all">
      	<text variable="title" text-case="title"/>
      </else-if>
      <else-if type="map" variable="page title-short" match="all">
	<text variable="title-short" text-case="title"/>
      </else-if>
      <else-if type="map" variable="page collection-title" match="all">
      	<text variable="collection-title" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="map" variable="title" match="all">
      	<text variable="title" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="map" variable="title-short" match="all">
        <text variable="title-short" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="map" variable="collection-title" match="all">
      	<text variable="collection-title" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="map" >
      	<text value="o.&#160;T."/>
      </else-if>
      <else-if type="motion_picture">
	<choose>
	  <if variable="collection-title version" match="none">
	    <!-- We treat [motion_picture] without [collection-title] and [version] as a Zotero "film"/"Film" -->
  	    <choose>
  	      <if variable="original-title">
		<!-- If there is an [original-title] to the [motion_picture], [title] is used in (main-title-addendum)! -->
		<text variable="original-title" font-style="italic" text-case="title"/>
  	      </if>
  	      <else-if variable="title">
  		<text variable="title" font-style="italic" text-case="title"/>
  	      </else-if>
	      <else-if variable="title-short">
		<text variable="title-short" font-style="italic" text-case="title"/>
	      </else-if>
	      <else>
  		<text value="o.&#160;T."/>
	      </else>
  	    </choose>
	  </if>
	  <!-- We treat [motion_picture] with [collection-title] or [version] (see above) as a Zotero "videoRecording"/"Videoaufnahme" -->
	  <else-if variable="original-title">
	    <text variable="original-title" text-case="title"/>
  	  </else-if>
  	  <else-if variable="title">
  	    <text variable="title" text-case="title"/>
  	  </else-if>
	  <else-if variable="title-short">
	    <text variable="title-short" text-case="title"/>
	  </else-if>
	  <else-if variable="collection-title">
  	    <text variable="collection-title" font-style="italic" text-case="title"/>
	  </else-if>
	  <else>
  	    <text value="o.&#160;T."/>
	  </else>
	</choose>
      </else-if>
      <else-if type="patent" variable="title" match="all">
	<text variable="title" text-case="title"/>
      </else-if>
      <else-if type="patent" variable="title-short" match="all">
        <text variable="title-short" text-case="title"/>
      </else-if>
      <else-if type="patent" variable="number" match="all">
	<group delimiter=" ">
	  <text variable="authority"/>
	  <text macro="number"/>
	</group>
      </else-if>
      <else-if type="personal_communication" variable="title" match="all">
	<text variable="title" text-case="title"/>
      </else-if>
      <else-if type="personal_communication" variable="title-short" match="all">
        <text variable="title-short" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="personal_communication" variable="number" match="all">
	    <text value="[ohne Betreff]"/>
      </else-if>
      <else-if type="post" variable="title" match="all">
	<!-- No title case here, because that would look odd. -->
	<text variable="title"/>
      </else-if>
      <else-if type="post" variable="title-short" match="all">
	<!-- No title case here, because that would look odd. -->
        <text variable="title-short"/>
      </else-if>
      <else-if type="post">
  	<text value="o.&#160;T."/>
      </else-if>
      <else-if type="post-weblog" variable="title" match="all">
	<text variable="title" text-case="title"/>
      </else-if>
      <else-if type="post-weblog" variable="title-short" match="all">
        <text variable="title-short" text-case="title"/>
      </else-if>
      <else-if type="post-weblog" variable="container-title" match="all">
	<text variable="container-title" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="post-weblog" variable="container-title-short" match="all">
	<text variable="container-title-short" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="post-weblog">
  	<text value="o.&#160;T."/>
      </else-if>
      <else-if type="report" variable="title" match="all">
      	<text variable="title" text-case="title"/>
      </else-if>
      <else-if type="report" variable="title-short" match="all">
        <text variable="title-short" text-case="title"/>
      </else-if>
      <else-if type="report" variable="genre" match="all">
      	<text variable="genre" text-case="title"/>
      </else-if>
      <else-if type="report" variable="collection-title" match="all">
      	<text variable="collection-title" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="report">
      	<text value="o.&#160;T."/>
      </else-if>
      <else-if type="song" variable="number title" match="all">
	<!-- We treat [song] with [number] as a Zotero "podcast"/"Podcast". -->
	<text variable="title" text-case="title"/>
      </else-if>
      <else-if type="song" variable="number title-short" match="all">
	<!-- We treat [song] with [number] as a Zotero "podcast"/"Podcast". -->
        <text variable="title-short" text-case="title"/>
      </else-if>
      <else-if type="song" variable="number collection-title" match="all">
	<!-- We treat [song] with [number] as a Zotero "podcast"/"Podcast". -->
	<text variable="collection-title" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="song" variable="number" match="all">
	<!-- We treat [song] with [number] as a Zotero "podcast"/"Podcast". -->
	<text value="o.&#160;T."/>
      </else-if>
      <else-if type="song">
	<!-- We treat [song] without [number] (see above) as a Zotero "audioRecording"/"Tonaufnahme". -->
	<choose>
	  <if variable="title">
	    <text variable="title" font-style="italic" text-case="title"/>
	  </if>
	  <else-if variable="title-short">
            <text variable="title-short" font-style="italic" text-case="title"/>
	  </else-if>
	  <else-if variable="author composer" match="none">
	    <choose>
	      <if variable="collection-title">
		<text variable="collection-title" font-style="italic" text-case="title"/>
	      </if>
	      <else>
  		<text value="o.&#160;T."/>
	      </else>
	    </choose>
	  </else-if>
	  <else>
	    <text value="o.&#160;T."/>
	  </else>
	</choose>
      </else-if>
      <else-if type="speech" variable="title" match="all">
	<text variable="title" text-case="title"/>
      </else-if>
      <else-if type="speech" variable="title-short" match="all">
        <text variable="title-short" text-case="title"/>
      </else-if>
      <else-if type="speech" variable="event" match="all">
	<text variable="event"/>
      </else-if>
      <else-if type="speech" variable="genre" match="all">
	<text variable="genre"/>
      </else-if>
      <else-if type="speech">
	<text value="o.&#160;T."/>
      </else-if>
      <else-if type="thesis" variable="title" match="all">
        <text variable="title" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="thesis" variable="title-short" match="all">
        <text variable="title-short" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="thesis" variable="genre" match="all">
	<text variable="genre"/>
      </else-if>
      <else-if type="thesis" >
  	<text value="o.&#160;T."/>
      </else-if>
      <else-if type="interview legal_case legislation patent personal_communication" match="none">
	<!-- Fallback for unsupported or unknown types -->
	<choose>
	  <if variable="title">
	    <text variable="title" text-case="title"/>
	  </if>
	  <else-if variable="title-short">
            <text variable="title-short" text-case="title"/>
	  </else-if>
	  <else>
  	    <text value="o.&#160;T."/>
	  </else>
	</choose>
      </else-if>
    </choose>
    <choose>
      <if variable="title title-short" match="none">
	<choose>
	  <if variable="reviewed-author reviewed-title" match="all">
	    <text value="Rezension zu"/>
	    <names prefix=" " variable="reviewed-author"/>
    	    <text prefix=": " variable="reviewed-title" font-style="italic" text-case="title"/>
	  </if>
	  <else-if variable="reviewed-author reviewed-title" match="any">
	    <text value="Rezension zu"/>
	    <names prefix=" " variable="reviewed-author"/>
    	    <text prefix=" " variable="reviewed-title" font-style="italic" text-case="title"/>
	  </else-if>
	</choose>
      </if>
    </choose>
  </macro>

  <!-- This macro generates the main title in short form to be used in
       subsequent citations of the entry. For some types, this macro
       includes information which, in the case of the first, i.e. full
       citation, comes from the macro (main-title-addendum). -->
  <macro name="main-title-short">
    <choose>
      <if type="article-journal article-magazine article-newspaper" match="any">
	<choose>
	  <!-- Here and below, it is necessary to check for [title-short] separately! -->
	  <if variable="title-short">
            <text variable="title-short" text-case="title"/>
	  </if>
	  <else-if variable="title">
            <text variable="title" text-case="title" form="short"/>
	  </else-if>
	  <else-if variable="reviewed-author reviewed-title" match="none">
  	    <text value="o.&#160;T."/>
	  </else-if>
	</choose>
      </if>
      <else-if type="bill" variable="genre" match="all">
	<!-- We treat [bill] with [genre] as a Zotero "bill"/"Gesetzentwurf" -->
	<group delimiter=" ">
	  <group delimiter=" ">
	    <text variable="genre"/>
	    <text macro="number"/>
	  </group>
	  <text prefix="(" variable="title-short" text-case="title" suffix=")"/>
	</group>
      </else-if>
      <!-- We treat [bill] without [genre] as a Zotero "hearing"/"Anhörung" -->
      <else-if type="bill">
	<text variable="title-short" text-case="title"/>
      </else-if>
      <else-if type="book">
	<choose>
	  <if variable="title-short">
            <text variable="title-short" font-style="italic" text-case="title"/>
	  </if>
	  <else-if variable="title">
            <text variable="title" font-style="italic" text-case="title" form="short"/>
	  </else-if>
	  <else-if variable="author editor" match="none">
	    <choose>
	      <if variable="collection-title" is-numeric="collection-number" match="all">
		<group delimiter="&#160;">
		  <text variable="collection-title" font-style="italic" text-case="title"/>
		  <text variable="collection-number" font-style="italic"/>
		</group>
	      </if>
	      <else-if variable="collection-title">
		<group delimiter=", " >
		  <text variable="collection-title" font-style="italic" text-case="title"/>
		  <text variable="collection-number" font-style="italic"/>
		</group>
	      </else-if>
	      <else>
  		<text value="o.&#160;T."/>
	      </else>
	    </choose>
	  </else-if>
	  <else>
  	    <text value="o.&#160;T."/>
	  </else>
	</choose>
	<text prefix=" " variable="version"/>
	<choose>
	  <if variable="title-short" match="none">
	    <text prefix=", " macro="volume-and-issue"/>
	  </if>
	</choose>
      </else-if>
      <else-if type="broadcast" variable="container-title-short" match="all">
  	<text variable="container-title-short" font-style="italic" text-case="title"/>
	<text prefix=", " macro="number"/>
      </else-if>
      <else-if type="broadcast" variable="container-title" match="all">
  	<text variable="container-title" font-style="italic" text-case="title" form="short"/>
	<text prefix=", " macro="number"/>
      </else-if>
      <else-if type="broadcast" variable="title-short" match="all">
  	<text variable="title-short" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="broadcast" variable="title" match="all">
  	<text variable="title" font-style="italic" text-case="title" form="short"/>
      </else-if>
      <else-if type="broadcast" >
  	<text value="o.&#160;T."/>
      </else-if>
      <else-if type="chapter" variable="version" match="all">
	<choose>
	  <if variable="container-title-short">
	    <text variable="container-title-short" font-style="italic" text-case="title" form="short"/>
	  </if>
	  <else-if variable="container-title">
	    <text variable="container-title" font-style="italic" text-case="title" form="short"/>
	  </else-if>
	</choose>
      </else-if>
      <else-if type="chapter">
	<choose>
	  <if variable="title-short">
            <text variable="title-short" text-case="title"/>
	  </if>
	  <else-if variable="title">
            <text variable="title" text-case="title" form="short"/>
	  </else-if>
	  <else>
  	    <text value="o.&#160;T."/>
	  </else>
	</choose>
      </else-if>
      <else-if type="entry-dictionary entry-encyclopedia paper-conference" match="any">
	<choose>
	  <if variable="title-short">
            <text variable="title-short" text-case="title"/>
	  </if>
	  <else-if variable="title">
            <text variable="title" text-case="title" form="short"/>
	  </else-if>
	  <else>
  	    <text value="o.&#160;T."/>
	  </else>
	</choose>
      </else-if>
      <else-if type="graphic" variable="title-short" match="all">
        <text variable="title-short" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="graphic" variable="title" match="all">
        <text variable="title" font-style="italic" text-case="title" form="short"/>
      </else-if>
      <else-if type="graphic">
  	<text value="o.&#160;T."/>
      </else-if>
      <else-if type="interview" variable="title-short" match="all">
        <text variable="title-short" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="interview" variable="title" match="all">
	<text variable="title" text-case="title" form="short"/>
      </else-if>
      <else-if type="legal_case" variable="authority" match="all">
	<group delimiter="&#160;&#8211; ">
	  <group delimiter=" v. ">
	    <text variable="genre"/>
	    <text macro="main-date"/>
	  </group>
	  <text variable="title-short" text-case="title"/>
	</group>
      </else-if>
      <else-if type="legal_case">
	<group delimiter="&#160;&#8211; ">
	  <group delimiter=" ">
	    <choose>
	      <if variable="container-title-short">
		<text variable="container-title-short" text-case="title" form="short"/>
	      </if>
	      <else-if variable="container-title">
		<text variable="container-title" text-case="title" form="short"/>
	      </else-if>
	    </choose>
	    <group delimiter=", ">
	      <text macro="volume-and-issue"/>
	      <text macro="page-range"/>
	    </group>
	  </group>
	  <text variable="title-short" text-case="title"/>
	</group>
      </else-if>
      <else-if type="legislation" variable="title-short" match="all">
	<group delimiter=" ">
	  <text variable="title-short" text-case="title"/>
      	  <text macro="number"/>
	</group>
      </else-if>
      <else-if type="legislation" variable="title" match="all">
	<group delimiter=" ">
	  <text variable="title" text-case="title" form="short"/>
      	  <text macro="number"/>
	</group>
      </else-if>
      <else-if type="legislation" variable="container-title-short" match="all">
	<group delimiter=" ">
	  <text variable="container-title-short" text-case="title"/>
      	  <text macro="volume-and-issue"/>
	</group>
      </else-if>
      <else-if type="legislation" variable="container-title" match="all">
	<group delimiter=" ">
	  <text variable="container-title" text-case="title"/>
      	  <text macro="volume-and-issue"/>
	</group>
      </else-if>
      <else-if type="manuscript" variable="title-short" match="all">
        <text variable="title-short" text-case="title"/>
      </else-if>
      <else-if type="manuscript" variable="title" match="all">
        <text variable="title" text-case="title" form="short"/>
      </else-if>
      <else-if type="manuscript">
  	<text value="o.&#160;T."/>
      </else-if>
      <else-if type="map" variable="page title-short" match="all">
	<text variable="title-short" text-case="title"/>
      </else-if>
      <else-if type="map" variable="page title" match="all">
      	<text variable="title" text-case="title" form="short"/>
      </else-if>
      <else-if type="map" variable="page collection-title" match="all">
      	<text variable="collection-title" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="map">
	<choose>
	  <if variable="title-short">
            <text variable="title-short" font-style="italic" text-case="title"/>
	  </if>
	  <else-if variable="title">
      	    <text variable="title" font-style="italic" text-case="title" form="short"/>
	  </else-if>
	  <else-if variable="collection-title">
      	    <text variable="collection-title" font-style="italic" text-case="title"/>
	  </else-if>
	  <else>
      	    <text value="o.&#160;T."/>
	  </else>
	</choose>
	<choose>
	  <if variable="volume">
	    <group prefix=", " delimiter=" ">
	      <text term="folio"/>
	      <text variable="volume"/>
	    </group>
	  </if>
	</choose>
      </else-if>
      <else-if type="motion_picture">
	<choose>
	  <if variable="collection-title version" match="none">
	    <!-- We treat [motion_picture] without [collection-title] and [version] as a Zotero "film"/"Film" -->
  	    <choose>
  	      <if variable="original-title">
		<!-- If there is an [original-title] to the [motion_picture], [title] is used in (main-title-addendum)! -->
		<text variable="original-title" font-style="italic" text-case="title"/>
  	      </if>
	      <else-if variable="title-short">
		<text variable="title-short" font-style="italic" text-case="title"/>
	      </else-if>
  	      <else-if variable="title">
  		<text variable="title" font-style="italic" text-case="title" form="short"/>
  	      </else-if>
	      <else>
  		<text value="o.&#160;T."/>
	      </else>
  	    </choose>
	  </if>
	  <!-- We treat [motion_picture] with [collection-title] or [version] (see above) as a Zotero "videoRecording"/"Videoaufnahme" -->
	  <else-if variable="original-title">
	    <text variable="original-title" text-case="title"/>
  	  </else-if>
	  <else-if variable="title-short">
	    <text variable="title-short" text-case="title"/>
	  </else-if>
  	  <else-if variable="title">
  	    <text variable="title" text-case="title" form="short"/>
  	  </else-if>
	  <else-if variable="collection-title">
  	    <text variable="collection-title" font-style="italic" text-case="title"/>
	  </else-if>
	  <else>
  	    <text value="o.&#160;T."/>
	  </else>
	</choose>
	<text prefix=", " macro="volume-and-issue"/>
      </else-if>
      <else-if type="patent" variable="title" match="all">
	<text variable="title" text-case="title" form="short"/>
      </else-if>
      <else-if type="patent" variable="title-short" match="all">
        <text variable="title-short" text-case="title"/>
      </else-if>
      <else-if type="patent" variable="number" match="all">
	<group delimiter=" ">
	  <text variable="authority"/>
	  <text macro="number"/>
	</group>
      </else-if>
      <else-if type="personal_communication" variable="title-short" match="all">
        <text variable="title-short" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="personal_communication" variable="title" match="all">
	<text variable="title" text-case="title" form="short"/>
      </else-if>
      <else-if type="personal_communication" variable="number" match="all">
	    <text value="[ohne Betreff]"/>
      </else-if>
      <else-if type="post" variable="title-short" match="all">
	<!-- No title case here, because that would look odd. -->
        <text variable="title-short"/>
      </else-if>
      <else-if type="post" variable="title" match="all">
	<!-- No title case here, because that would look odd. -->
	<text variable="title" form="short"/>
      </else-if>
      <else-if type="post">
  	<text value="o.&#160;T."/>
      </else-if>
      <else-if type="post-weblog" variable="title-short" match="all">
        <text variable="title-short" text-case="title"/>
      </else-if>
      <else-if type="post-weblog" variable="title" match="all">
	<text variable="title" text-case="title" form="short"/>
      </else-if>
      <else-if type="post-weblog" variable="container-title-short" match="all">
	<text variable="container-title-short" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="post-weblog" variable="container-title" match="all">
	<text variable="container-title" font-style="italic" text-case="title" form="short"/>
      </else-if>
      <else-if type="post-weblog">
  	<text value="o.&#160;T."/>
      </else-if>
      <else-if type="report" variable="title-short" match="all">
        <text variable="title-short" text-case="title"/>
      </else-if>
      <else-if type="report" variable="title" match="all">
      	<text variable="title" text-case="title" form="short"/>
      </else-if>
      <else-if type="report" variable="genre" match="all">
      	<text variable="genre" text-case="title"/>
      </else-if>
      <else-if type="report" variable="collection-title" match="all">
      	<text variable="collection-title" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="report">
      	<text value="o.&#160;T."/>
      </else-if>
      <else-if type="song" variable="number title-short" match="all">
	<!-- We treat [song] with [number] as a Zotero "podcast"/"Podcast". -->
        <text variable="title-short" text-case="title"/>
      </else-if>
      <else-if type="song" variable="number title" match="all">
	<!-- We treat [song] with [number] as a Zotero "podcast"/"Podcast". -->
	<text variable="title" text-case="title" form="short"/>
      </else-if>
      <else-if type="song" variable="number collection-title" match="all">
	<!-- We treat [song] with [number] as a Zotero "podcast"/"Podcast". -->
	<text variable="collection-title" font-style="italic" text-case="title"/>
	<choose>
	  <if is-numeric="number">
	    <text prefix="&#160;" macro="number"/>
	  </if>
	</choose>
      </else-if>
      <else-if type="song" variable="number">
	<!-- We treat [song] with [number] as a Zotero "podcast"/"Podcast". -->
	<text value="o.&#160;T."/>
      </else-if>
      <else-if type="song">
	<!-- We treat [song] without [number] (see above) as a Zotero "audioRecording"/"Tonaufnahme". -->
	<choose>
	  <if variable="title-short">
            <text variable="title-short" font-style="italic" text-case="title"/>
	  </if>
	  <else-if variable="title">
	    <text variable="title" font-style="italic" text-case="title" form="short"/>
	  </else-if>
	  <else-if variable="author composer" match="none">
	    <choose>
	      <if variable="collection-title">
		<text variable="collection-title" font-style="italic" text-case="title"/>
	      </if>
	      <else>
  		<text value="o.&#160;T."/>
	      </else>
	    </choose>
	  </else-if>
	  <else>
	    <text value="o.&#160;T."/>
	  </else>
	</choose>
      </else-if>
      <else-if type="speech" variable="title-short" match="all">
        <text variable="title-short" text-case="title"/>
      </else-if>
      <else-if type="speech" variable="title" match="all">
	<text variable="title" text-case="title" form="short"/>
      </else-if>
      <else-if type="speech" variable="event" match="all">
	<text variable="event"/>
      </else-if>
      <else-if type="speech" variable="genre" match="all">
	<text variable="genre"/>
      </else-if>
      <else-if type="speech">
	<text value="o.&#160;T."/>
      </else-if>
      <else-if type="thesis" variable="title-short" match="all">
        <text variable="title-short" font-style="italic" text-case="title"/>
      </else-if>
      <else-if type="thesis" variable="title" match="all">
        <text variable="title" font-style="italic" text-case="title" form="short"/>
      </else-if>
      <else-if type="thesis" variable="genre" match="all">
	<text variable="genre"/>
      </else-if>
      <else-if type="thesis" >
  	<text value="o.&#160;T."/>
      </else-if>
      <else-if type="interview legal_case legislation patent personal_communication" match="none">
	<!-- Fallback for unsupported or unknown types -->
	<choose>
	  <if variable="title">
	    <text variable="title" text-case="title"/>
	  </if>
	  <else-if variable="title-short">
            <text variable="title-short" text-case="title"/>
	  </else-if>
	  <else>
  	    <text value="o.&#160;T."/>
	  </else>
	</choose>
      </else-if>
    </choose>
    <choose>
      <if variable="title title-short" match="none">
	  <choose>
	    <if variable="reviewed-title">
	      <text value="Rezension zu "/>
    	      <text variable="reviewed-title" font-style="italic" text-case="title"/>
	    </if>
	    <else-if variable="reviewed-author">
	      <text value="Rezension zu "/>
	      <names  variable="reviewed-author">
		<name form="short"/>
	      </names>
	    </else-if>
	  </choose>
      </if>
    </choose>
  </macro>

  <!-- This macro generates an addendum to the main title. -->
  <macro name="main-title-addendum">
    <choose>
      <if type="motion_picture" variable="original-title title" match="all">
	<!-- If there is an [original-title] to the [motion_picture], [title] is only an addendum!
	-->
	<text prefix=" (" variable="title" suffix=")" text-case="title"/>
      </if>
      <else-if type="motion_picture" variable="original-title title-short" match="all">
	<text prefix=" (" variable="title-short" suffix=")" text-case="title"/>
      </else-if>
      <else-if type="motion_picture" match="none">
	<group prefix=" [" delimiter=", " suffix="]">
	  <text variable="original-title" text-case="title"/>
	  <choose>
	    <if type="article-journal article-magazine article-newspaper chapter" match="any">
	      <!-- In [chapter] and [article-*], [original-date] comes directly after (main-title-long-*)! -->
	      <text macro="original-date"/>
	    </if>
	  </choose>
	</group>
      </else-if>
    </choose>
    <choose>
      <if variable="title title-short" match="any">
	<choose>
	  <if variable="reviewed-author reviewed-title" match="all">
	    <text value=", Rezension zu"/>
	    <names prefix=" " variable="reviewed-author"/>
    	    <text prefix=": " variable="reviewed-title" font-style="italic" text-case="title"/>
	  </if>
	  <else-if variable="reviewed-author reviewed-title" match="any">
	    <text value=", Rezension zu"/>
	    <names prefix=" " variable="reviewed-author"/>
    	    <text prefix=" " variable="reviewed-title" font-style="italic" text-case="title"/>
	  </else-if>
	</choose>
      </if>
    </choose>
    <choose>
      <if type="bill" variable="genre" match="all">
	<!-- We treat [bill] with [genre] as a Zotero "bill"/"Gesetzentwurf". -->
	<choose>
	  <if variable="title">
	    <text prefix=" (" variable="title-short" text-case="title" suffix=")"/>
	  </if>
	</choose>
	<group prefix=", " delimiter=", ">
	  <text variable="authority"/>
	  <text variable="chapter-number"/>
	</group>
      </if>
      <else-if type="bill">
	<!-- We treat [bill] without [genre] (see above) as a Zotero "hearing"/"Anhörung". -->
	<group prefix=", " delimiter=", ">
	  <text macro="number"/>
	  <text variable="section"/>
	  <text variable="authority"/>
	  <choose>
	    <if is-numeric="chapter-number">
	      <text variable="chapter-number" suffix=". Sitzung"/>
	    </if>
	    <else>
	      <text variable="chapter-number"/>
	    </else>
	  </choose>
	</group>
      </else-if>
      <else-if type="book">
	<text prefix=" " variable="version"/>
	<!-- In [book], [volume] comes directly after (main-title-long-*). -->
	<text prefix=", " macro="volume-and-issue"/>
      </else-if>
      <else-if type="broadcast">
	<choose>
	  <if variable="container-title container-title-short" match="any">
	    <text prefix=", " macro="number"/>
	  </if>
	</choose>
      </else-if>
      <else-if type="legal_case" variable="authority" match="all">
	<!-- We treat [legal_case] with [authority] as published on its own. -->
	<text prefix=", " macro="number"/>
      </else-if>
      <else-if type="legal_case">
	<!-- We treat [legal_case] without [authority] (see above) as published in a volume. -->
	<text prefix=" " macro="volume-and-issue"/>
      </else-if>
      <else-if type="legislation">
	<choose>
	  <if variable="title title-short" match="any">
	    <group prefix=" " delimiter=" ">
	      <text macro="number"/>
	      <choose>
		<if variable="title">
		  <text prefix="(" variable="title-short" suffix=")"/>
		</if>
	      </choose>
	      <text prefix="v. " macro="main-date"/>
	    </group>
	  </if>
	  <else-if variable="container-title container-title-short" match="any">
	    <!-- (volume-and-issue) includes [section] for [legislation]! -->
	    <text prefix=" " macro="volume-and-issue"/>
	  </else-if>
	</choose>
      </else-if>
      <else-if type="map">
	<text prefix=" " variable="scale"/>
	<text prefix=", " variable="genre"/>
	<text prefix=", " variable="medium"/>
	<choose>
	  <if variable="page" match="none">
	    <group prefix=", " delimiter=" ">
	      <choose>
		<if variable="volume">
		  <text term="folio" suffix=" "/>
		  <text macro="volume-and-issue"/>
		</if>
		<else>
		  <text macro="volume-and-issue"/>
		  <text prefix=" " term="folio" plural="true"/>
		</else>
	      </choose>
	    </group>
	  </if>
	</choose>
      </else-if>
      <else-if type="motion_picture">
	<text prefix=", " macro="volume-and-issue"/>
      </else-if>
      <else-if type="patent">
	<group prefix=", " delimiter=", ">
	  <choose>
	    <if variable="title title-short" match="any">
	      <group delimiter=" ">
		<text variable="authority"/>
		<text macro="number"/>
	    </group>
	  </if>
	  </choose>
	  <text macro="main-date"/>
	</group>
      </else-if>
      <else-if type="personal_communication post" match="any">
	<text prefix=", " variable="genre"/>
      </else-if>
      <else-if type="report">
	<group prefix=", " delimiter=" ">
	  <choose>
	    <if variable="title title-short" match="any">
	      <text variable="genre"/>
	    </if>
	  </choose>
	  <text macro="number"/>
	</group>
      </else-if>
      <else-if type="song" variable="number" match="all">
	<!-- We treat [song] with [number] as a Zotero "podcast"/"Podcast". -->
	<choose>
	  <if variable="title title-short" match="none">
	    <choose>
	      <if is-numeric="number">
		<text prefix="&#160;" macro="number"/>
	      </if>
	    </choose>
	  </if>
	</choose>
      </else-if>
    </choose>
  </macro>

  <!-- This macro generates the secondary title (the "container" or
       "collection"). -->
  <macro name="secondary-title">
    <choose>
      <if type="article-journal article-magazine article-newspaper chapter entry-dictionary entry-encyclopedia paper-conference post" match="any">
	<choose>
	  <if variable="container-title">
            <text variable="container-title" font-style="italic" text-case="title"/>
	  </if>
	  <else-if variable="container-title-short">
            <text variable="container-title-short" font-style="italic" text-case="title"/>
	  </else-if>
	</choose>
      </if>
      <else-if type="bill" variable="genre container-title" match="all">
	<!-- We treat [bill] with [genre] as a Zotero
	     "bill"/"Gesetzentwurf". -->
	<text variable="container-title" text-case="title"/>
      </else-if>
      <else-if type="bill" variable="genre container-title-short" match="all">
	<!-- We treat [bill] with [genre] as a Zotero
	     "bill"/"Gesetzentwurf". -->
	<text variable="container-title-short" text-case="title"/>
      </else-if>
      <else-if type="broadcast">
	<choose>
	  <if variable="container-title container-title-short" match="any">
	    <text variable="title" text-case="title"/>
	  </if>
	</choose>
      </else-if>
      <else-if type="legal_case" variable="authority container-title" match="all">
	<text variable="container-title" text-case="title" form="short"/>
      </else-if>
      <else-if type="legal_case" variable="authority container-title-short" match="all">
	<text variable="container-title-short" text-case="title"/>
      </else-if>
      <else-if type="legislation post-weblog" match="any">
	<choose>
	  <if variable="title title-short" match="any">
	    <choose>
	      <if variable="container-title">
		<text variable="container-title" font-style="italic" text-case="title"/>
	      </if>
	      <else-if variable="container-title-short">
		<text variable="container-title-short" font-style="italic" text-case="title"/>
	      </else-if>
	    </choose>
	  </if>
	</choose>
      </else-if>
      <else-if type="map" variable="page" match="all">
	<choose>
	  <if variable="title title-short" match="any">
	    <text variable="collection-title" font-style="italic" text-case="title"/>
	  </if>
	</choose>
      </else-if>
      <else-if type="motion_picture">
	<choose>
	  <if variable="title title-short original-title" match="any">
	    <!-- Only Zotero "videoRecording"/"Videoaufnahme" is
	         supposed to have [collection-title]! -->
	    <text variable="collection-title" font-style="italic" text-case="title"/>
	  </if>
	</choose>
      </else-if>
      <else-if type="song" variable="number" match="all">
	<!-- We treat [song] with [number] as a Zotero "podcast"/"Podcast". -->
	<choose>
	  <if variable="title title-short" match="any">
	    <text variable="collection-title" font-style="italic" text-case="title"/>
	  </if>
	</choose>
      </else-if>
    </choose>
  </macro>

  <!-- This macro generates an addendum to the secondary title. -->
  <macro name="secondary-title-addendum">
    <group prefix=" (" delimiter=", " suffix=")">
      <choose>
	<if type="article-journal">
	  <text variable="collection-title" text-case="title"/>
	</if>
      </choose>
    </group>
    <choose>
      <if type="article-journal article-magazine article-newspaper chapter entry-dictionary entry-encyclopedia" match="any">
	<!-- [volume], [issue] come after [container-title] in
	     [chapter] and [entry-*]. -->
	<text prefix=", " macro="volume-and-issue"/>
	<choose>
	  <if type="article-newspaper">
	    <text prefix=", " variable="section"/>
	  </if>
	</choose>
      </if>
      <else-if type="bill" variable="genre" match="all">
	<!-- We treat [bill] with [genre] as a Zotero
	     "bill"/"Gesetzentwurf". -->
	<group prefix=", " delimiter=", ">
	  <text macro="volume-and-issue"/>
	  <text macro="page-range"/>
	</group>
      </else-if>
      <else-if type="legal_case" variable="authority" match="all">
	<text prefix=" " macro="volume-and-issue"/>
      </else-if>
      <else-if type="legislation">
	<choose>
	  <if variable="title title-short" match="any">
	    <text prefix=" " macro="volume-and-issue"/> <!-- includes [section]! -->
	  </if>
	</choose>
      </else-if>
      <else-if type="map" variable="page" match="all">
	<text prefix=", " macro="volume-and-issue"/>
      </else-if>
      <else-if type="patent">
	<group prefix=", Priorität: " delimiter=", ">
	  <text variable="issue"/>
	  <text macro="original-date"/>
	</group>
	<group prefix=", Anmeldung: " delimiter=", ">
	  <text variable="call-number"/>
	  <text macro="submitted-date"/>
	</group>
      </else-if>
      <else-if type="paper-conference">
	<group prefix=", " delimiter=" ">
	  <text variable="event"/>
	  <group prefix="(" delimiter=", " suffix=")">
	    <text variable="event-place"/>
	    <text macro="event-date"/>
	  </group>
	</group>
      </else-if>
      <else-if type="song" variable="number" match="all">
	<choose>
	  <if variable="title title-short" match="any">
	    <choose>
	      <if is-numeric="number">
		<!-- We treat [song] with [number] as a Zotero
		     "podcast"/"Podcast". -->
		<text prefix="&#160;" macro="number"/>
	      </if>
	    </choose>
	  </if>
	</choose>
      </else-if>
      <else-if type="song">
	<!-- In Zotero, it’s an "audioRecording"/"Tonaufnahme" -->
	<!-- [medium]/"Dateityp" for "Podcast" comes later (see below) -->
	<group prefix=", " delimiter=" ">
	  <choose>
	    <if variable="volume number-of-volumes" match="all">
	      <text variable="medium"/>
	      <text macro="volume-and-issue"/>
	    </if>
	    <else-if variable="number-of-volumes">
	      <text macro="volume-and-issue"/>
	      <text variable="medium"/>
	    </else-if>
	    <else>
	      <text macro="volume-and-issue"/>
	      <text variable="medium"/>
	    </else>
	  </choose>
	</group>
      </else-if>

      <else-if type="speech">
	<choose>
	  <if variable="title title-short event" match="any">
	    <text prefix=", " variable="genre"/>
	  </if>
	</choose>
	<choose>
	  <if variable="title title-short genre" match="any">
	    <text prefix=", " variable="event"/>
	  </if>
	</choose>
      </else-if>
      <else-if type="thesis" variable="title">
	<choose>
	  <if variable="title title-short" match="any">
	    <text prefix=", " variable="genre"/>
	  </if>
	</choose>
      </else-if>
    </choose>
  </macro>

  <macro name="tertiary-title">
    <choose>
      <if type="book">
	<choose>
	  <if variable="author editor title title-short" match="any">
	    <choose>
	      <if is-numeric="collection-number">
		<group delimiter="&#160;">
		  <text variable="collection-title" text-case="title"/>
		  <text variable="collection-number"/>
		</group>
	      </if>
	      <else>
		<group delimiter=", " >
		  <text variable="collection-title" text-case="title"/>
		  <text variable="collection-number"/>
		</group>
	      </else>
	    </choose>
	  </if>
	</choose>
      </if>
      <else-if type="chapter entry-dictionary entry-encyclopedia paper-conference" match="any">
	<choose>
	  <if is-numeric="collection-number">
	    <group delimiter="&#160;">
	      <text variable="collection-title" text-case="title"/>
	      <text variable="collection-number"/>
	    </group>
	  </if>
	  <else>
	    <group delimiter=", " >
	      <text variable="collection-title" text-case="title"/>
	      <text variable="collection-number"/>
	    </group>
	  </else>
	</choose>
      </else-if>
      <else-if type="map">
	<choose>
	  <if variable="page" match="none">
	    <text variable="collection-title" text-case="title"/>
	  </if>
	</choose>
      </else-if>
      <else-if type="report">
	<choose>
	  <if variable="title title-short genre" match="any">
      	    <text variable="collection-title" text-case="title"/>
	  </if>
	</choose>
      </else-if>
      <else-if type="song">
	<choose>
	  <if variable="number" match="none">
	    <!-- in Zotero, it’s an "audioRecording"/"Tonaufnahme" -->
	    <choose>
	      <if variable="title title-short author composer" match="any">
		<text variable="collection-title" text-case="title"/>
	      </if>
	    </choose>
	  </if>
	</choose>
      </else-if>
    </choose>
  </macro>

  <macro name="published">
    <choose>
      <if type="book broadcast manuscript motion_picture song" match="any">
	<!-- in "book", [genre] is only for Zotero’s "computerProgram"! -->
	<text prefix=", " variable="genre"/>
      </if>
    </choose>
    <choose>
      <if type="song" variable="number" match="all">
	<text prefix=", " variable="medium"/>
      </if>
      <else-if type="song">
	<group prefix=", " delimiter=", ">
	  <text variable="event-place"/>
	  <text macro="event-date"/>
	</group>
      </else-if>
      <else-if type="map" match="none">
	<text prefix=", " variable="medium"/>
      </else-if>
    </choose>
    <text prefix=", " macro="edition"/>
    <text prefix=", " macro="publisher-and-place"/>
    <choose>
      <if type="article-journal article-magazine" match="any">
	<choose>
	  <if variable="publisher publisher-place" match="any">
	    <text prefix=" " macro="main-date"/>
	  </if>
	  <else>
	    <text prefix=", " macro="main-date"/>
	  </else>
	</choose>
      </if>
      <else-if type="article-newspaper">
	<text prefix=", " macro="main-date"/>
      </else-if>
      <else-if type="book chapter entry-dictionary entry-encyclopedia" match="any">
	<text prefix=" " macro="main-date"/>
      </else-if>
      <else-if type="graphic">
	<text prefix=", " macro="main-date"/>
      </else-if>
      <else-if type="map" variable="publisher-place">
	<text prefix=" " macro="main-date"/>
      </else-if>
      <else-if type="map">
	<text prefix=", " macro="main-date"/>
      </else-if>
      <else-if type="motion_picture">
	<choose>
	  <if variable="collection-title version" match="any">
	    <!-- in Zotero, it’s a "videoRecording"/"Videoaufnahme" -->
	    <text prefix=", " macro="main-date"/>
	  </if>
	  <else-if variable="publisher publisher-place" match="any">
	    <text prefix=" " macro="main-date"/>
	  </else-if>
	  <else>
	    <text prefix=", " macro="main-date"/>
	  </else>
	</choose>
      </else-if>
      <else-if type="song" variable="number" match="all">
	<!-- in Zotero, it’s a "podcast" -->
	<text prefix=", " macro="main-date"/>
      </else-if>
      <else-if type="song">
	<!-- in Zotero, it’s an "audioRecording"/"Tonaufnahme" -->
	<choose>
	  <if variable="publisher publisher-place" match="any">
	    <text prefix=" " macro="main-date"/>
	  </if>
	  <else>
	    <text prefix=", " macro="main-date"/>
	  </else>
	</choose>
      </else-if>
      <else-if type="thesis">
	<choose>
	  <if variable="title publisher publisher-place" match="none">
	    <text prefix=", " macro="main-date"/>
	  </if>
	  <else>
	    <text prefix=" " macro="main-date"/>
	  </else>
	</choose>
      </else-if>
      <else-if type="legal_case legislation patent" match="none">
	<text prefix=", " macro="main-date"/>
      </else-if>
    </choose>
    <choose>
      <!-- [original-date] for [article-*], [chapter] and [patent] is given right after [title]/main-title-long-* (see above) -->
      <!-- [original-date] for [patent] is priority date! (see above) -->
      <if type="article-journal article-magazine article-newspaper chapter patent" match="none">
	<text prefix=" [" macro="original-date" suffix="]"/>
      </if>
    </choose>
    <choose>
      <if type="patent" match="none">
	<!-- [submitted] for [patent] is given elsewhere (actually, no type other than patent should even have this!) -->
	<text prefix=", " macro="submitted-date"/>
      </if>
    </choose>
    <group prefix=" (" delimiter=", " suffix=")">
      <text macro="tertiary-title"/>
      <text macro="tertiary-contributors"/>
    </group>
    <choose>
      <if type="bill" match="none">
    	<text prefix=", " macro="page-range"/>
      </if>
    </choose>
  </macro>

  <macro name="edition">
    <choose>
      <if type="article-newspaper">
	<text variable="edition"/>
      </if>
      <else>
	<choose>
	  <if is-numeric="edition">
	    <group delimiter="&#160;">
              <number variable="edition" form="ordinal"/>
              <text term="edition" form="short"/>
	    </group>
	  </if>
	  <else-if variable="edition">
	    <group delimiter=" ">
              <text variable="edition"/>
              <text term="edition" form="short"/>
	    </group>
	  </else-if>
	</choose>
      </else>
    </choose>
  </macro>

  <macro name="volume-and-issue">
    <choose>
      <if type="article-journal article-magazine" match="any">
	<group delimiter=", ">
	  <group>
	    <text term="volume" plural="false" form="short" suffix="&#160;"/>
	    <text variable="volume"/>
	  </group>
	  <group>
	    <text term="issue" plural="false" form="short" suffix="&#160;"/>
	    <text variable="issue"/>
	  </group>
	</group>
      </if>
      <else-if type="bill">
	<group delimiter=", ">
	  <group delimiter="&#160;">
	    <text term="volume" plural="false" form="short"/>
	    <text variable="volume"/>
	  </group>
	  <text term="part" plural="false" suffix="&#160;"/>
	  <text variable="section"/>
	</group>
      </else-if>
      <else-if type="legal_case">
	<text variable="volume"/>
      </else-if>
      <else-if type="legislation">
	<group delimiter=" ">
	  <text variable="volume"/>
	  <text variable="section"/>
	</group>
      </else-if>
      <else-if type="map" variable="page volume number-of-volumes" match="all">
	<group delimiter=" ">
	  <text term="volume" plural="false" form="short"/>
	  <text variable="volume"/>
	  <text prefix=" (von " variable="number-of-volumes" suffix=")"/>
	</group>
      </else-if>
      <else-if type="map" variable="page volume" match="all">
	<group delimiter=" ">
	  <text term="volume" plural="false" form="short"/>
	  <text variable="volume"/>
	</group>
      </else-if>
      <else-if type="map" variable="page number-of-volumes" match="all">
	<text variable="number-of-volumes" form="short"/>
	<text prefix=" " term="volume" plural="true" form="short"/>
      </else-if>
      <else-if type="map motion_picture song" match="any">
	<!-- "map" is treated as a single map, hence [volume], [number-of-volumes] denote the sheet -->
	<choose>
	  <if variable="number-of-volumes volume" match="all">
	    <group>
	      <text variable="volume"/>
	      <text prefix=" (von " variable="number-of-volumes" suffix=")"/>
	    </group>
	  </if>
	  <else>
	    <text variable="volume"/>
	    <text variable="number-of-volumes"/>
	  </else>
	</choose>
      </else-if>
      <else-if type="patent">
	<text variable="issue"/>
      </else-if>
      <else-if type="book chapter entry-dictionary entry-encyclopedia paper-conference" match="any">
	<choose>
	  <if variable="volume number-of-volumes" match="all">
	    <group delimiter=" ">
	      <text term="volume" plural="false" form="short"/>
	      <text variable="volume"/>
	      <text prefix=" (von " variable="number-of-volumes" suffix=")"/>
	    </group>
	  </if>
	  <else-if variable="volume">
	    <group delimiter=" ">
	      <text term="volume" plural="false" form="short"/>
	      <text variable="volume"/>
	    </group>
	  </else-if>
	  <else-if variable="number-of-volumes">
	    <text variable="number-of-volumes" form="short"/>
	    <text prefix=" " term="volume" plural="true" form="short"/>
	  </else-if>
	</choose>
      </else-if>
    </choose>
  </macro>

  <macro name="number">
    <choose>
      <if type="bill" variable="genre" match="all">
	    <text variable="number"/>
      </if>
      <else-if type="bill" is-numeric="number" match="all">
	<text term="issue" form="short" suffix="&#160;"/>
	<text variable="number"/>
      </else-if>
      <else-if type="bill">
	<text variable="number"/>
      </else-if>
      <else-if type="broadcast">
	<text variable="number"/>
	<!-- is-numeric als considers things like "S01E01" as numeric, so no test for prefix here! -->
      </else-if>
      <else-if type="legal_case patent" match="any">
	<text variable="number"/>
      </else-if>
      <else-if type="legislation" is-numeric="number" match="all">
	<text term="issue" form="short" suffix="&#160;"/>
	<text variable="number"/>
      </else-if>
      <else-if type="legislation">
	<text variable="number"/>
      </else-if>
      <else-if type="report">
	<choose>
	  <if variable="collection-title genre" match="any">
	    <choose>
      	      <if is-numeric="number">
		<text term="issue" form="short" suffix="&#160;"/>
      		<text variable="number"/>
      	      </if>
      	      <else>
      		<text prefix=", " variable="number"/>
      	      </else>
	    </choose>
	  </if>
	  <else>
	    <text prefix=", " variable="number"/>
	  </else>
	</choose>
      </else-if>
      <else-if type="song" is-numeric="number" match="all">
	<text variable="number"/>
      </else-if>
    </choose>
  </macro>

  <macro name="publisher-and-place">
    <choose>
      <if type="bill">
      	<text variable="publisher-place"/>
      </if>
      <else-if type="graphic" variable="event-place">
	<text variable="event-place"/>
      </else-if>
      <else-if type="graphic">
	<text macro="archived"/>
      </else-if>
      <else-if type="interview personal_communication speech" match="any">
	<group delimiter=", ">
	  <text variable="event-place"/>
	  <text variable="publisher"/>
	</group>
      </else-if>
      <else-if type="report" variable="publisher" match="all">
	<!-- this is necessary because [publisher] in "report" could have already been assigned (main-contributor-*) -->
      	<choose>
      	  <if variable="author" match="none">
      	    <text variable="publisher-place"/>
      	  </if>
      	  <else>
      	    <text variable="publisher-place"/>
      	  </else>
      	</choose>
      </else-if>
      <else-if type="song" variable="number" match="all">
      	<!-- in Zotero, it’s a "podcast" -->
	<text variable="event-place"/>
      </else-if>
      <else>
	<choose>
	  <if variable="publisher publisher-place" match="any">
	    <text variable="publisher-place"/>
	  </if>
	  <else-if type="book chapter entry-dictionary entry-encyclopedia paper-conference report thesis" match="any">
	    <text value="o.&#160;O."/>
	  </else-if>
	</choose>
      </else>
    </choose>
  </macro>

  <macro name="main-date">
    <choose>
      <if is-uncertain-date="issued">
	<text term="circa" form="short" suffix=" "/>
      </if>
    </choose>
    <choose>

      <!-- "Born digital" publications get the prefix "dort datiert"...  -->
      <if type="post post-weblog webpage" match="any">
  	<date prefix="dort datiert " variable="issued" form="numeric"/>
      </if>
      <!-- Also, podcasts get it... -->
      <else-if type="song" variable="number" match="any">
  	<date prefix="dort datiert " variable="issued" form="numeric"/>
      </else-if>
      <else-if type="article-magazine" variable="URL" match="all">
	<choose>
	  <if variable="page" match="none">
	    <!-- Also, online articles without 'page' get it... -->
  	    <date prefix="dort datiert " variable="issued" form="numeric"/>
	  </if>
	  <else>
	    <!-- But ones with 'page' do not... -->
  	    <date variable="issued" form="numeric"/>
	  </else>
	</choose>
      </else-if>
      <else-if type="article-newspaper" variable="URL" match="all">
	<choose>
	  <if variable="page" match="none">
	    <!-- Also, online articles without 'page' get it... -->
  	    <date prefix="dort datiert " variable="issued" form="numeric"/>
	  </if>
	  <else>
	    <!-- But ones with 'page' do not... -->
  	    <date variable="issued" form="numeric"/>
	  </else>
	</choose>
      </else-if>
      <else-if type="article-journal" variable="URL" match="all">
	<choose>
	  <if variable="page" match="none">
	    <!-- But ones with 'page' do not... -->
	    <!-- Also, online articles without 'page' get it... -->
  	    <date prefix="dort datiert " variable="issued" form="numeric"/>
	  </if>
	  <else>
	    <!-- But ones with 'page' do not... -->
  	    <date variable="issued">
  	      <date-part name="month" form="short" suffix=" "/>
  	      <date-part name="year"/>
            </date>
	  </else>
	</choose>
      </else-if>
      <!-- Also, computer programs get it... -->
      <else-if type="book" variable="version" match="all">
  	<date prefix="dort datiert " variable="issued" form="numeric"/>
      </else-if>
      <else-if type="broadcast map motion_picture" match="any">
	<choose>
	  <if variable="URL">
	    <!-- Also, online maps, films/videos get it... -->
  	    <date prefix="dort datiert " variable="issued" form="numeric"/>
	  </if>
	  <else>
	    <!-- But print maps, films/videos do not... -->
  	    <date variable="issued" form="numeric"/>
	  </else>
	</choose>
      </else-if>
      <!-- Also, online messages get it... -->
      <else-if type="personal_communication" variable="URL" match="all">
  	<date prefix="dort datiert " variable="issued" form="numeric"/>
      </else-if>
      <!-- But print personal communications do not... -->
      <else-if type="personal_communication">
  	<date variable="issued" form="numeric"/>
      </else-if>
      <!-- Everything else does not get the prefix "dort datiert"... -->
      <else-if type="book chapter" match="any">
  	<choose>
          <if variable="issued">
            <date variable="issued">
              <date-part name="year"/>
  	    </date>
          </if>
          <else>
            <text term="no date" form="short"/>
          </else>
  	</choose>
      </else-if>
      <else-if type="graphic" variable="event-place" match="all">
	<text macro="event-date"/>
      </else-if>
      <else-if type="graphic">
  	<date variable="issued">
  	  <date-part name="year"/>
  	</date>
      </else-if>
      <else-if type="legal_case legislation" match="any">
  	<date variable="issued" form="numeric"/>
      </else-if>
      <else-if variable="issued">
  	<date variable="issued">
  	  <date-part name="day" form="numeric" suffix="."/>
  	  <date-part name="month" form="numeric" suffix="."/>
  	  <date-part name="year"/>
	</date>
      </else-if>
      <else>
        <text term="no date" form="short"/>
      </else>
    </choose>
  </macro>

  <macro name="original-date">
    <choose>
      <if is-uncertain-date="issued">
    	<text term="circa" form="short" suffix=" "/>
      </if>
    </choose>
    <choose>
      <if type="article-journal article-magazine" match="any">
    	<date variable="original-date">
          <date-part name="month" form="short" suffix=" "/>
          <date-part name="year"/>
        </date>
      </if>
      <else-if type="article-newspaper">
  	<date variable="original-date">
  	  <date-part name="day" form="numeric" suffix="."/>
  	  <date-part name="month" form="numeric" suffix="."/>
  	  <date-part name="year"/>
	</date>
      </else-if>
      <else-if type="book chapter motion_picture" match="any">
    	<date variable="original-date">
          <date-part name="year"/>
    	</date>
      </else-if>
      <else>
  	<date variable="original-date">
  	  <date-part name="day" form="numeric" suffix="."/>
  	  <date-part name="month" form="numeric" suffix="."/>
  	  <date-part name="year"/>
	</date>
      </else>
    </choose>
  </macro>

  <macro name="submitted-date">
    <date variable="submitted">
      <date-part name="day" form="numeric" suffix="."/>
      <date-part name="month" form="numeric" suffix="."/>
      <date-part name="year"/>
    </date>
  </macro>

  <macro name="event-date">
    <date variable="event-date">
      <date-part name="day" form="numeric" suffix="."/>
      <date-part name="month" form="numeric" suffix="."/>
      <date-part name="year"/>
    </date>
  </macro>

  <macro name="accessed-date">
    <date variable="accessed">
      <date-part name="day" form="numeric" suffix="."/>
      <date-part name="month" form="numeric" suffix="."/>
      <date-part name="year"/>
    </date>
  </macro>

  <macro name="extra-info">
    <text prefix=", " variable="dimensions"/>
    <text prefix=", " variable="references"/>
    <choose>
      <if type="legal_case">
	<text prefix="&#160;&#8211; " variable="title-short"/>
      </if>
    </choose>
    <group prefix=" (" delimiter=", " suffix=")">
      <choose>
      	<if type="graphic" variable="event-place" match="all">
	  <!-- bei [event-place] UND [archive-place] wird [archive-place] in extra-info dargestellt, d.h. hinter [genre], was z.B. bei [genre]="Performance" dazu führt, dass Archiv/Archivort zusammen mit Genre in der Klammer dargestellt werden, was irreführend ist! -->
	  <text macro="archived"/>
	</if>
      </choose>
      <choose>
	<if type="patent" match="none">
	  <text macro="source"/>
	</if>
      </choose>
      <text variable="status"/>
    </group>
    <group prefix=", ">
      <choose>
	<if variable="URL">
	  <choose>
	    <!-- "Born digital" publications do not get the prefix "online unter"...  -->
	    <if type="post post-weblog webpage" match="any">
	      <group delimiter=", ">
		<text variable="URL"/>
		<group delimiter=" ">
		  <text term="accessed"/>
		  <text macro="accessed-date"/>
		</group>
	      </group>
	    </if>
	    <!-- Also, podcasts don’t get it... -->
	    <else-if type="song" variable="number" match="any">
	      <group delimiter=", ">
		<text variable="URL"/>
		<group delimiter=" ">
		  <text term="accessed"/>
		  <text macro="accessed-date"/>
		</group>
	      </group>
	    </else-if>
	    <else-if type="article-magazine article-newspaper article-journal" match="any">
	      <choose>
		<if variable="page">
		  <!-- Also, online articles with 'page' don’t get it... -->
		  <group delimiter=", ">
		    <text variable="URL"/>
		    <group delimiter=" ">
		      <text term="accessed"/>
		      <text macro="accessed-date"/>
		    </group>
		  </group>
		</if>
		<else>
		  <!-- But, online articles without 'page' do... -->
		  <group delimiter=", ">
		    <text prefix="online unter " variable="URL"/>
		    <group delimiter=" ">
		      <text term="accessed"/>
		      <text macro="accessed-date"/>
		    </group>
		  </group>
		</else>
	      </choose>
	    </else-if>
	    <!-- Also, computer programs don’t get it... -->
	    <else-if type="book" variable="version" match="all">
	      <group delimiter=", ">
		<text variable="URL"/>
		<group delimiter=" ">
		  <text term="accessed"/>
		  <text macro="accessed-date"/>
		</group>
	      </group>
	    </else-if>
	    <!-- Also, online maps, films/videos don’t get it... -->
	    <else-if type="broadcast map motion_picture" match="any">
	      <group delimiter=", ">
		<text variable="URL"/>
		<group delimiter=" ">
		  <text term="accessed"/>
		  <text macro="accessed-date"/>
		</group>
	      </group>
	    </else-if>
	    <!-- Everything else that has an URL gets the prefix "online unter"... -->
	    <else>
	      <group delimiter=", ">
		<text prefix="online unter " variable="URL"/>
		<group delimiter=" ">
		  <text term="accessed"/>
		  <text macro="accessed-date"/>
		</group>
	      </group>
	    </else>
	  </choose>
	  <!-- <choose> -->
	  <!--   <!-\- Webpages and other online ressources that do not have prefix "online unter"... -\-> -->
	  <!--   <if type="book" variable="version" match="all"> -->
	  <!--     <group delimiter=", "> -->
	  <!-- 	<text variable="URL"/> -->
	  <!-- 	<group delimiter=" "> -->
	  <!-- 	  <text term="accessed"/> -->
	  <!-- 	  <text macro="accessed-date"/> -->
	  <!-- 	</group> -->
	  <!--     </group> -->
	  <!--   </if> -->
	  <!--   <else-if type="motion_picture"> -->
	  <!--     <group delimiter=", "> -->
	  <!-- 	<text variable="URL"/> -->
	  <!-- 	<group delimiter=" "> -->
	  <!-- 	  <text term="accessed"/> -->
	  <!-- 	  <text macro="accessed-date"/> -->
	  <!-- 	</group> -->
	  <!--     </group> -->
	  <!--   </else-if> -->
	  <!--   <else-if type="personal_communication"> -->
	  <!--     <group delimiter=", "> -->
	  <!-- 	<text variable="URL"/> -->
	  <!-- 	<group delimiter=" "> -->
	  <!-- 	  <text term="accessed"/> -->
	  <!-- 	  <text macro="accessed-date"/> -->
	  <!-- 	</group> -->
	  <!--     </group> -->
	  <!--   </else-if> -->
	  <!--   <else-if type="post post-weblog webpage" match="any"> -->
	  <!--     <group delimiter=", "> -->
	  <!-- 	<text variable="URL"/> -->
	  <!-- 	<group delimiter=" "> -->
	  <!-- 	  <text term="accessed"/> -->
	  <!-- 	  <text macro="accessed-date"/> -->
	  <!-- 	</group> -->
	  <!--     </group> -->
	  <!--   </else-if> -->
	  <!--   <else-if type="song" variable="number" match="any"> -->
	  <!--     <group delimiter=", "> -->
	  <!-- 	<text variable="URL"/> -->
	  <!-- 	<group delimiter=" "> -->
	  <!-- 	  <text term="accessed"/> -->
	  <!-- 	  <text macro="accessed-date"/> -->
	  <!-- 	</group> -->
	  <!--     </group> -->
	  <!--   </else-if> -->
	  <!--   <!-\- Print ressources that have prefix "online unter"... -\-> -->
	  <!--   <else> -->
	  <!--     <group delimiter=", "> -->
	  <!-- 	<text variable="URL"/> -->
	  <!-- 	<group delimiter=" "> -->
	  <!-- 	  <text term="accessed"/> -->
	  <!-- 	  <text macro="accessed-date"/> -->
	  <!-- 	</group> -->
	  <!--     </group> -->
	  <!--   </else> -->
	  <!-- </choose> -->
	</if>
      </choose>
    </group>
  </macro>

  <macro name="archived">
    <choose>
      <if variable="archive">
	<group delimiter=", ">
	  <text variable="archive"/>
	  <text variable="archive-place"/>
	</group>
	<text prefix=", " variable="archive_location"/>
      </if>
    </choose>
  </macro>

  <macro name="source">
    <choose>
      <if type="patent">
	<text variable="call-number"/>
      </if>
      <else>
	<group delimiter=", ">
	  <text variable="source"/>
	  <text prefix="Signatur: " variable="call-number"/>
	</group>
      </else>
    </choose>
  </macro>

  <macro name="number-of-pages">
    <text variable="number-of-pages"/>
    <text prefix=" " term="number-of-pages" form="short"/>
  </macro>

  <macro name="page-range">
    <choose>
      <if type="article-journal article-magazine article-newspaper chapter entry-dictionary entry-encyclopedia paper-conference" match="any">
	<choose>
	  <if variable="page">
	      <text variable="page"/>
	  </if>
	</choose>
      </if>
      <else>
	  <text variable="page"/>
      </else>
    </choose>
  </macro>

    <!-- This generates the citation locator (used in <locator-first>, <locator-following>, <locator-opening>). -->
  <macro name="citation-locator">
    <choose>
      <if type="legal_case">
	<choose>
	  <if variable="container-title container-title-short" match="any">
	    <text prefix="(" variable="locator" suffix=")"/>
	  </if>
	  <else>
	    <group delimiter=".&#160;">
	      <text variable="locator"/>
	    </group>
	  </else>
	</choose>
      </if>
      <else>
	<text variable="locator"/>
      </else>
    </choose>
  </macro>

  <!-- This generates the (closing) citation locator for all citations-following the very first one. -->
  <macro name="locator-following">
    <choose>
      <if type="legal_case">
	<choose>
	  <if variable="container-title container-title-short" match="any">
	    <text prefix=" " macro="citation-locator"/>
	  </if>
	  <else>
	    <text prefix=", " macro="citation-locator"/>
	  </else>
	</choose>
      </if>
      <else-if type="legislation" match="none">
	<text prefix=", " macro="citation-locator"/>
      </else-if>
    </choose>
    <choose>
      <if type="motion_picture" variable="locator" match="all">
	<!-- We could also do this for 'song', but somehow it does not seem necessary. -->
	<text prefix=" (" variable="medium" suffix=")"/>
      </if>
    </choose>
  </macro>

  <!-- This generates the (closing) citation locator for the very first citation. -->
  <macro name="locator-first">
    <choose>
      <if type="article-journal article-magazine article-newspaper chapter entry-dictionary entry-encyclopedia paper-conference" match="any">
	<text prefix=", hier " macro="citation-locator"/>
      </if>
      <else-if type="legal_case">
	<choose>
	  <if variable="container-title container-title-short" match="any">
	    <text prefix=" " macro="citation-locator"/>
	  </if>
	  <else>
	    <text prefix=", " macro="citation-locator"/>
	  </else>
	</choose>
      </else-if>
      <else-if type="legislation" match="none">
	<text prefix=", " macro="citation-locator"/>
      </else-if>
    </choose>
  </macro>

  <!-- This generates any opening citation locator. -->
  <macro name="locator-opening">
    <choose>
      <if type="legislation">
	<text macro="citation-locator" suffix=" "/>
      </if>
    </choose>
  </macro>

  <!-- This macro is only used in the <sort> element of <bibliography>
       to separate types that should be in their own references lists.
       -->
  <macro name="bib-sort-types">
    <choose>
      <if type="book" variable="version" match="all">
	<!-- We treat [book] with [version] as "computerProgram". This
	     also means, unfortunately, that Zotero entries of
	     "computerProgram" _without_ [version] do not get
	     recognized as "computerProgram" here and are therefore
	     sorted together with regular entries. -->
	<text value="7"/>
      </if>
      <else-if type="broadcast">
	<text value="4"/>
      </else-if>
      <else-if type="graphic">
	<text value="2"/>
      </else-if>
      <else-if type="map">
	<text value="6"/>
      </else-if>
      <else-if type="motion_picture">
	<text value="3"/>
      </else-if>
      <else-if type="song" variable="number" match="all">
	<!-- [song]/"podcast" goes with regular entries. -->
	<text value="1"/>
      </else-if>
      <else-if type="song">
	<!-- [song]/"audioRecording" goes separately. -->
	<text value="5"/>
      </else-if>
      <else>
	<text value="1"/>
      </else>
    </choose>
  </macro>

  <!-- This macro is used in the <sort> element of <bibliography>
       only. We need it because using macros (main-contributors-bib)
       and (main-title-long) separately in the <sort>...</sort>
       element would sort by (main-contributors-bib) _first_ and
       (main-title-long) _second_ and, accordingly, result in all
       entries that havw no main-contributors to come _after_ the ones
       that have main-contributors. -->
  <macro name="main-contributors-title-bib-sort">
    <text macro="main-contributors-bib"/>
    <text macro="main-title-long"/>
  </macro>

  <citation delimiter-precedes-last="never" delimiter-precedes-et-al="never" et-al-subsequent-min="2" et-al-subsequent-use-first="1" disambiguate-add-names="true" disambiguate-add-givenname="true">

    <layout delimiter="; " suffix=".">
      <choose>
        <if position="ibid-with-locator">
	  <!-- This generates all immediately subsequent, i.e. "ibid" citations of the entry that _do_ have a locator. ATTENTION: This part has to come _before_ position="ibid" to work correctly! -->
	  <text macro="locator-opening"/>
          <text term="ibid" text-case="capitalize-first"/>
	  <text macro="locator-following"/>
        </if>
        <else-if position="ibid">
	  <!-- This generates all immediately subsequent, i.e. "ibid" citations of the entry that do _not_ have a locator AND all subsequent, i.e. "ibid" citations of the entry that have the exact same locator as the immediately preceding citation. -->
          <text term="ibid" text-case="capitalize-first"/>
        </else-if>
        <else-if position="subsequent">
	  <!-- This part generates all subsequent, i.e. short citations of the entry. -->
	  <text macro="locator-opening"/>
	  <choose>
	    <if type="legal_case" match="none">
	      <group delimiter=": ">
		<text macro="main-contributors-cite-short"/>
		<text macro="main-title-short"/>
	      </group>
	    </if>
	    <else>
	      <group delimiter=", ">
		<text macro="main-contributors-cite-short"/>
		<text macro="main-title-short"/>
	      </group>
	    </else>
	  </choose>
	  <text macro="locator-following"/>
        </else-if>
        <else>
	  <!-- This part generates the very first, i.e. the only full
	       citation of the entry. -->
	  <text macro="locator-opening"/>
	  <choose>
	    <if type="legal_case" match="none">
	      <group delimiter=": ">
		<text macro="main-contributors-cite-long"/>
		<text macro="main-title-long"/>
	      </group>
	    </if>
	    <else>
	      <group delimiter=", ">
		<text macro="main-contributors-cite-long"/>
		<text macro="main-title-long"/>
	      </group>
	    </else>
	  </choose>
	  <text macro="main-title-addendum"/>
	  <text macro="additional-main-contributors"/>
	  <choose>
	    <if type="article-journal article-magazine article-newspaper chapter entry-dictionary entry-encyclopedia paper-conference" match="any">
	      <group prefix=", " delimiter=": ">
		<text term="in"/>
		<text macro="secondary-contributors"/>
		<text macro="secondary-title"/>
	      </group>
	    </if>
	    <else-if type="broadcast" variable="number" match="all">
	      <text prefix=": " macro="secondary-title"/>
	    </else-if>
	    <else-if type="map" variable="page" match="all">
	      <group prefix=", " delimiter=": ">
		<text term="in"/>
		<text macro="secondary-contributors"/>
		<text macro="secondary-title"/>
	      </group>
	    </else-if>
	    <else-if type="post" variable="genre">
	      <text prefix=" in: " macro="secondary-title"/>
	    </else-if>
	    <else-if type="post">
	      <text prefix=", in: " macro="secondary-title"/>
	    </else-if>
	    <else-if type="post-weblog">
	      <text prefix=", Eintrag im Blog " macro="secondary-title"/>
	    </else-if>
	    <else-if type="song" variable="collection-title number" match="all">
	      <text prefix=", " macro="secondary-title"/>
	    </else-if>
	    <else>
	      <group prefix=", " delimiter=", ">
		<text macro="secondary-contributors"/>
		<text macro="secondary-title"/>
	      </group>
	    </else>
	  </choose>
	  <text macro="secondary-title-addendum"/>
	  <text prefix=", " macro="additional-secondary-contributors"/>
	  <text macro="published"/>
	  <text macro="locator-first"/>
	  <text macro="extra-info"/>
	</else>
      </choose>
    </layout>
  </citation>

  <bibliography delimiter-precedes-last="never" delimiter-precedes-et-al="never" et-al-min="4" et-al-use-first="3" and="text" hanging-indent="true" entry-spacing="0" subsequent-author-substitute="---">
    <sort>
      <key macro="bib-sort-types"/>
      <key macro="main-contributors-title-bib-sort"/>
      <key macro="main-title-addendum"/>
      <key macro="additional-main-contributors"/>
    </sort>
    <layout suffix=".">
      <choose>
	<if type="bill legal_case legislation" match="none">
	  <choose>
	    <if type="legal_case" match="none">
	      <group delimiter=": ">
		<text macro="main-contributors-bib"/>
		<text macro="main-title-long"/>
	      </group>
	    </if>
	    <else>
	      <group delimiter=", ">
		<text macro="main-contributors-bib"/>
		<text macro="main-title-long"/>
	      </group>
	    </else>
	  </choose>
	  <text macro="main-title-addendum"/>
	  <text macro="additional-main-contributors"/>
	  <choose>
	    <if type="article-journal article-magazine article-newspaper chapter entry-dictionary entry-encyclopedia paper-conference" match="any">
	      <group prefix=", " delimiter=": ">
		<text term="in"/>
		<text macro="secondary-contributors"/>
		<text macro="secondary-title"/>
	      </group>
	    </if>
	    <else-if type="broadcast" variable="number" match="all">
	      <text prefix=": " macro="secondary-title"/>
	    </else-if>
	    <else-if type="map" variable="page" match="all">
	      <group prefix=", " delimiter=": ">
		<text term="in"/>
		<text macro="secondary-contributors"/>
		<text macro="secondary-title"/>
	      </group>
	    </else-if>
	    <else-if type="post" variable="genre">
	      <text prefix=" in: " macro="secondary-title"/>
	    </else-if>
	    <else-if type="post">
	      <text prefix=", in: " macro="secondary-title"/>
	    </else-if>
	    <else-if type="post-weblog">
	      <text prefix=", Eintrag im Blog " macro="secondary-title"/>
	    </else-if>
	    <else-if type="song" variable="collection-title number" match="all">
	      <text prefix=", " macro="secondary-title"/>
	    </else-if>
	    <else>
	      <group prefix=", " delimiter=", ">
		<text macro="secondary-contributors"/>
		<text macro="secondary-title"/>
	      </group>
	    </else>
	  </choose>
	  <text macro="secondary-title-addendum"/>
	  <text prefix=", " macro="additional-secondary-contributors"/>
	  <group prefix=" (" delimiter=", " suffix=")">
	    <text macro="tertiary-title"/>
	    <text macro="tertiary-contributors"/>
	  </group>
	  <text macro="published"/>
	  <text macro="extra-info"/>
	  <text prefix=". " font-style="italic" variable="abstract"/>
	</if>
      </choose>
    </layout>
  </bibliography>

</style>
